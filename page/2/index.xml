<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>PinkHello</title><link>https://pinkhello.me/</link><description>Recent content on PinkHello</description><generator>Hugo -- gohugo.io</generator><language>zh</language><copyright>PinkHello, All Rights Reserved</copyright><lastBuildDate>Tue, 16 Feb 2021 22:48:35 +0800</lastBuildDate><atom:link href="https://pinkhello.me/index.xml" rel="self" type="application/rss+xml"/><item><title>10 Â§öÂüüÂêç‰∏ãÁöÑSSH</title><link>https://pinkhello.me/posts/10-%E5%A4%9A%E5%9F%9F%E5%90%8D%E4%B8%8B%E7%9A%84ssh/</link><pubDate>Wed, 10 Feb 2021 08:52:57 +0800</pubDate><guid>https://pinkhello.me/posts/10-%E5%A4%9A%E5%9F%9F%E5%90%8D%E4%B8%8B%E7%9A%84ssh/</guid><description>PinkHello https://pinkhello.me/posts/10-%E5%A4%9A%E5%9F%9F%E5%90%8D%E4%B8%8B%E7%9A%84ssh/ -&lt;h1 id="ÂâçË®Ä">ÂâçË®Ä&lt;/h1>
&lt;p>ÊúâÊó∂ÂÄôÊàë‰ª¨ÔºåÊúâÂ§ö‰∏™ git Ë¥¶Âè∑ÔºàGitlab„ÄÅGitHubÔºâÔºåËøôÊó∂ÂÄôÂ¶ÇÊûúÊòØÂêå‰∏Ä‰∏™Ë¥¶Âè∑ÔºàÈÇÆÁÆ±Ê≥®ÂÜåÔºâÔºåÈÇ£‰∏ç‰ºöÊúâÈóÆÈ¢òÔºå‰ΩÜÊòØÂ¶ÇÊûú‰∏çÊòØÁõ∏ÂêåÁöÑË¥¶Âè∑Âë¢ÔºåÊàë‰ª¨Âú®‰ΩøÁî® SSH KEY ÂÅöÂÖçÂØÜÁôªÂΩïÊó∂ÂÄôÔºåÂ§¥Áóõ‰∫Ü„ÄÇ&lt;/p>
&lt;p>Ëøô‰∏™Êó∂ÂÄôÊàë‰ª¨ÈúÄË¶ÅÈíàÂØπ‰∏çÂêåÁöÑË¥¶Âè∑ÔºåÁîüÊàê‰∏çÂêåÁöÑ SSH KeyÔºåÂπ∂‰∏îÈÖçÁΩÆ‰∏çÂêåÁöÑÂüüÂêç‰ΩøÁî®‰∏çÂêåÁöÑKey&lt;/p>
&lt;h1 id="ÁîüÊàê‰∏Ä‰∏™-ssh-key">ÁîüÊàê‰∏Ä‰∏™ SSH KEY&lt;/h1>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">ssh-keygen -t rsa -C &lt;span style="color:#cd5555">&amp;#34;username@email.com&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;blockquote>
&lt;p>‰∏ÄË∑Ø EnterÔºåÂπ∂‰∏îÂú®ÁîüÊàêÊó∂ÂÄôÊåáÂÆöÂêçÂ≠óÔºåÔºà‰∏çÊåáÂÆöÂêçÂ≠ó‰ºö‰ΩøÁî®ÈªòËÆ§ÁöÑÔºâÂæóÂà∞&lt;/p>
&lt;/blockquote>
&lt;/blockquote>
&lt;pre>&lt;code>id_rsa # ÁßÅÈí•
id_rsa.pub # ÂÖ¨Èí•
&lt;/code>&lt;/pre>&lt;h1 id="ÈáçÂ§ç‰∏ä‰∏Ä‰∏™Ê≠•È™§ÁîüÊàêÂ§ö‰∏™-ÁßÅÈí•ÂíåÂÖ¨Èí•">ÈáçÂ§ç‰∏ä‰∏Ä‰∏™Ê≠•È™§ÔºåÁîüÊàêÂ§ö‰∏™ ÁßÅÈí•ÂíåÂÖ¨Èí•&lt;/h1>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">github_id_rsa
github_id_rsa.pub
gitlab_id_rsa
gitlab_id_rsa.pub
&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="ÈÖçÁΩÆÁõ∏Â∫îÁöÑÂüüÂêçÂØπÂ∫îÁöÑ-ssh-key">ÈÖçÁΩÆÁõ∏Â∫îÁöÑÂüüÂêçÂØπÂ∫îÁöÑ SSH-KEY&lt;/h1>
&lt;ul>
&lt;li>Êú¨Âú∞ÁõÆÂΩï &lt;code>~/.ssh/&lt;/code> ‰∏ãÔºåÊü•ÈòÖÊúâÊ≤°Êúâ &lt;code>config&lt;/code> Êñá‰ª∂, ‰∏çÂ≠òÂú®Â∞±Êñ∞Âª∫ &lt;code>config&lt;/code> Êñá‰ª∂&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">Host github
HostName github.com
User UserName
PreferredAuthentications publickey
IdentityFile ~/.ssh/github_id_rsa
Host gitlab
HostName gitlab.com
User UserName
PreferredAuthentications publickey
IdentityFile ~/.ssh/gitlab_id_rsa
&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="Â∞ÜÂØÜÈí•Ê∑ªÂä†ËøõÂÖ•--ssh-agent-‰∏≠">Â∞ÜÂØÜÈí•Ê∑ªÂä†ËøõÂÖ• SSH-AGENT ‰∏≠&lt;/h1>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">ssh-add ~/.ssh/github_id_rsa
ssh-add ~/.ssh/gitlab_id_rsa
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Êü•ÁúãÂØÜÈí•&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">ssh-add -l
&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="Â∞ÜÁîüÊàêÁöÑ-ÂÖ¨Èí•-Âä†ÂÖ•Âà∞ÂØπÂ∫îÁöÑÁΩëÁ´ôÈáåÈù¢-ssh-key-ÈÖçÁΩÆ">Â∞ÜÁîüÊàêÁöÑ ÂÖ¨Èí• Âä†ÂÖ•Âà∞ÂØπÂ∫îÁöÑÁΩëÁ´ôÈáåÈù¢ SSH KEY ÈÖçÁΩÆ&lt;/h1>
&lt;p>‰∏ãÈù¢Â∞±ÂèØ‰ª•‰ΩøÁî® &lt;code>git clone git@github.com/****&lt;/code> &lt;code>git clone git@gitlab.com/****&lt;/code>&lt;/p>
&lt;h1 id="ÂÖ≥‰∫é-mac-‰∏ã-ÊØèÊ¨°ÂºÄÊú∫-ÈúÄË¶ÅÈáçÊñ∞-ssh-add-Ëß£ÂÜ≥ÂäûÊ≥ï">ÂÖ≥‰∫é Mac ‰∏ã ÊØèÊ¨°ÂºÄÊú∫ ÈúÄË¶ÅÈáçÊñ∞ ssh-add Ëß£ÂÜ≥ÂäûÊ≥ï&lt;/h1>
&lt;ul>
&lt;li>Ê∑ªÂä†Ëá™ÂêØÂä®Á®ãÂ∫è&lt;/li>
&lt;li>ËØ¥‰∏Ä‰∏™ÁÆÄÂçïÁöÑÔºåÂ∞Ü ssh-add ~/.ssh/**id_rsa Ê∑ªÂä†Âà∞ .*shrc Êñá‰ª∂ÈáåÈù¢Âéª&lt;/li>
&lt;/ul>
- https://pinkhello.me/posts/10-%E5%A4%9A%E5%9F%9F%E5%90%8D%E4%B8%8B%E7%9A%84ssh/ - PinkHello, All Rights Reserved</description></item><item><title>09 ‰ΩøÁî®githookÁªü‰∏Äcodestyle</title><link>https://pinkhello.me/posts/09-%E4%BD%BF%E7%94%A8githook%E7%BB%9F%E4%B8%80codestyle/</link><pubDate>Wed, 10 Feb 2021 08:46:52 +0800</pubDate><guid>https://pinkhello.me/posts/09-%E4%BD%BF%E7%94%A8githook%E7%BB%9F%E4%B8%80codestyle/</guid><description>PinkHello https://pinkhello.me/posts/09-%E4%BD%BF%E7%94%A8githook%E7%BB%9F%E4%B8%80codestyle/ -&lt;h1 id="gradle-‰ºòÂåñ">gradle ‰ºòÂåñ&lt;/h1>
&lt;ul>
&lt;li>build ÊåáÂÆö -g cache ÁºìÂ≠ò&lt;/li>
&lt;/ul>
&lt;h1 id="checkstyle-ÂÆûË∑µ">checkstyle ÂÆûË∑µ&lt;/h1>
&lt;ul>
&lt;li>Âü∫Á°ÄÈïúÂÉèÂåÖÂê´ &lt;code>checkstyle.xml&lt;/code> ÊàñËÄÖ ÊîæÂà∞ËøúÁ®ãÂÖ∂‰ªñÂèØË¢´ÊãâÂèñÂà∞ÁöÑÂ≠òÂÇ®‰ªãË¥® ÔºåÈò≤Ê≠¢È°πÁõÆÊàêÂëòÊîπÂä®&lt;/li>
&lt;li>&lt;code>gitlab-ci&lt;/code> &lt;code>beforeScript&lt;/code> Ê†áÁ≠æÊâßË°åÂëΩ‰ª§ &lt;code>copy /checkstyle.xml&lt;/code> ËøõÂÖ•È°πÁõÆÔºå(Ë¶ÜÁõñÈ°πÁõÆ‰∏≠Â≠òÂú®ÁöÑ).&lt;/li>
&lt;li>&lt;code>gradle&lt;/code> ÁºñËØëÁöÑËØù Â∞Ü &lt;code>maven-publish.gradle&lt;/code> &lt;code>repos.gradle&lt;/code> &lt;code>checkstyle.gradle&lt;/code>(&lt;code>checkstyle&lt;/code> Êèí‰ª∂ÈÖçÁΩÆ ÁâàÊú¨‰ª•Âèä &lt;code>configFile&lt;/code>) ÊäΩÂá∫ÊîæÂà∞ÂÖ¨ÂÖ±ÁöÑÂú∞ÊñπÔºåÈò≤Ê≠¢È°πÁõÆÂõ¢ÈòüÊàêÂëòÊîπÁöÑ.&lt;/li>
&lt;li>&lt;code>maven&lt;/code> ÁöÑËØùÔºåÂèØ‰ª•Âú®ÂÖ¨ÂÖ±ÁöÑÈ°∂Á∫ßÁªßÊâø &lt;code>pom&lt;/code> ÈáåÈù¢ÊåáÂÆöÂèòÈáè&lt;code>checkstyle.config.location&lt;/code>. &lt;code>mvn checkstyle -Dcheckstyle.config.location=checkstyle.xml&lt;/code>&lt;/li>
&lt;/ul>
&lt;h1 id="git-hook-ÂÆûË∑µ">git hook ÂÆûË∑µ&lt;/h1>
&lt;p>ÊØè‰∏™È°πÁõÆÈáåÈù¢ &lt;code>.git/hooks&lt;/code> ÈáåÈù¢ÊúâÂæàÂ§öÁöÑ &lt;code>hook&lt;/code> Ê®°Êùø&lt;/p>
&lt;p>ÂÆ¢Êà∑Á´ØÈí©Â≠êÂåÖÊã¨:&lt;code>pre-commit&lt;/code>„ÄÅ&lt;code>prepare-commit-msg&lt;/code>„ÄÅ&lt;code>commit-msg&lt;/code>„ÄÅ&lt;code>post-commit&lt;/code>Á≠âÔºå‰∏ªË¶ÅÁî®‰∫éÊéßÂà∂ÂÆ¢Êà∑Á´ØgitÁöÑÊèê‰∫§Â∑•‰ΩúÊµÅ„ÄÇ&lt;/p>
&lt;p>ÊúçÂä°Á´ØÈí©Â≠êÔºö&lt;code>pre-receive&lt;/code>„ÄÅ&lt;code>post-receive&lt;/code>„ÄÅ&lt;code>update&lt;/code>Ôºå‰∏ªË¶ÅÂú®ÊúçÂä°Á´ØÊé•Êî∂Êèê‰∫§ÂØπË±°Êó∂„ÄÅÊé®ÈÄÅÂà∞ÊúçÂä°Âô®‰πãÂâçË∞ÉÁî®„ÄÇ&lt;/p>
&lt;p>‰ªäÂ§©ÂÆûË∑µÁöÑÊòØ ÂÆ¢Êà∑Á´ØÈí©Â≠êÔºå‰ºòÂåñÂáèÂ∞ë‰∏çÁ¨¶ÂêàËßÑËåÉÊàñËÄÖ‰ΩéË¥®Èáè‰ª£Á†ÅËøõÂÖ• &lt;code>gitflow&lt;/code> ÊµÅÁ®ã.&lt;/p>
&lt;p>&lt;code>pre-commit&lt;/code> Âíå &lt;code>commit-msg&lt;/code> ÊòØ‰ªäÂ§©ÁöÑ‰∏ªËßíÔºå&lt;code>pre-commit&lt;/code> ÊâßË°å‰∏é &lt;code>git add&lt;/code> ‰πãÂêéÔºåÂú®ËøõË°å &lt;code>git commit&lt;/code> ‰πãÂâçËøõË°åÁöÑÊìç‰Ωú.
ÂèØ‰ª•Áî®Êù•ËøõË°å &lt;code>code check&lt;/code> &lt;code>code lint&lt;/code> Á≠âÁ≠â, &lt;code>commit-msg&lt;/code> ÊâßË°å‰∏é &lt;code>git commit&lt;/code> Â∏∏Áî®‰∫éË°•ÂÖ® &lt;code>git commit message&lt;/code> &lt;code>check msg&lt;/code> Á≠âÁ≠â
ÂΩìÁÑ∂ËøòÊúâÂÖ∂‰ªñÈ™öÊìç‰ΩúÁöÑÂäüËÉΩÔºåÂèØ‰ª•ÈÄöÁü•ÔºåÁ≠âÁ≠âÔºåÂÅöÂ§öÁßçËá™Âä®Âåñ&lt;/p>
&lt;p>ÁõÆÂΩïÁªìÊûÑ&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yml" data-lang="yml">project&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb">&lt;/span>- .git/..Á≠âÁ≠â&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb">&lt;/span>- git_hooks&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb"> &lt;/span>-- pre-commit &lt;span style="color:#bbb"> &lt;/span>&lt;span style="color:#228b22"># pre-commit action&lt;/span>&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb"> &lt;/span>-- commit-msg &lt;span style="color:#bbb"> &lt;/span>&lt;span style="color:#228b22"># commit-msg action&lt;/span>&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb"> &lt;/span>-- init.sh &lt;span style="color:#bbb"> &lt;/span>&lt;span style="color:#228b22"># ÂàùÂßãÂåñËÑöÊú¨&lt;/span>&lt;span style="color:#bbb">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>pre-commit&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">&lt;span style="color:#1e889b">#!/bin/bash
&lt;/span>&lt;span style="color:#1e889b">&lt;/span>&lt;span style="color:#00688b">workPath&lt;/span>=&lt;span style="color:#8b008b;font-weight:bold">$(&lt;/span>&lt;span style="color:#658b00">pwd&lt;/span>&lt;span style="color:#8b008b;font-weight:bold">)&lt;/span>
&lt;span style="color:#00688b">CHECK_DIR&lt;/span>=&lt;span style="color:#cd5555">${&lt;/span>&lt;span style="color:#00688b">workPath&lt;/span>&lt;span style="color:#cd5555">}&lt;/span>/checks
&lt;span style="color:#8b008b;font-weight:bold">if&lt;/span> [ ! -d &lt;span style="color:#00688b">$CHECK_DIR&lt;/span> ]
&lt;span style="color:#8b008b;font-weight:bold">then&lt;/span>
mkdir &lt;span style="color:#00688b">$CHECK_DIR&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">fi&lt;/span>
&lt;span style="color:#00688b">DOWNLOAD_PATH&lt;/span>=&lt;span style="color:#cd5555">&amp;#34;http://{download.path}/checkstyle&amp;#34;&lt;/span>
&lt;span style="color:#00688b">CONFIG_CHECK_JAR&lt;/span>=&lt;span style="color:#00688b">$CHECK_DIR&lt;/span>/checkstyle.jar;
&lt;span style="color:#00688b">CONFIG_CHECK_FILE&lt;/span>=&lt;span style="color:#00688b">$CHECK_DIR&lt;/span>/checkstyle.xml;
&lt;span style="color:#00688b">CONFIG_ERROR_FILE&lt;/span>=&lt;span style="color:#00688b">$CHECK_DIR&lt;/span>/checkstyle_errors.xml;
&lt;span style="color:#00688b">CONFIG_ERROR_REPORT_FILE&lt;/span>=&lt;span style="color:#00688b">$CHECK_DIR&lt;/span>/checkstyle_report.xml;
&lt;span style="color:#8b008b;font-weight:bold">if&lt;/span> [ ! -f &lt;span style="color:#00688b">$CONFIG_CHECK_JAR&lt;/span> ]
&lt;span style="color:#8b008b;font-weight:bold">then&lt;/span>
curl -o &lt;span style="color:#00688b">$CONFIG_CHECK_JAR&lt;/span> &lt;span style="color:#00688b">$DOWNLOAD_PATH&lt;/span>/checkstyle-8.8-all.jar || true;
&lt;span style="color:#8b008b;font-weight:bold">fi&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">if&lt;/span> [ ! -f &lt;span style="color:#00688b">$CONFIG_CHECK_FILE&lt;/span> ]
&lt;span style="color:#8b008b;font-weight:bold">then&lt;/span>
curl -o &lt;span style="color:#00688b">$CONFIG_CHECK_FILE&lt;/span> &lt;span style="color:#00688b">$DOWNLOAD_PATH&lt;/span>/checkstyle.xml || true;
&lt;span style="color:#8b008b;font-weight:bold">fi&lt;/span>
&lt;span style="color:#00688b">javafiles&lt;/span>=&lt;span style="color:#cd5555">`&lt;/span>git diff --cached --name-only | grep &lt;span style="color:#cd5555">&amp;#39;\.java&amp;#39;&lt;/span>&lt;span style="color:#cd5555">`&lt;/span>;
&lt;span style="color:#658b00">echo&lt;/span> &lt;span style="color:#00688b">$javafiles&lt;/span>;
&lt;span style="color:#8b008b;font-weight:bold">if&lt;/span> [ -f &lt;span style="color:#00688b">$CONFIG_ERROR_FILE&lt;/span> ]
&lt;span style="color:#8b008b;font-weight:bold">then&lt;/span>
rm &lt;span style="color:#00688b">$CONFIG_ERROR_FILE&lt;/span>;
&lt;span style="color:#8b008b;font-weight:bold">fi&lt;/span>
&lt;span style="color:#00688b">CHECK_CMD&lt;/span>=&lt;span style="color:#cd5555">&amp;#34;java -cp &lt;/span>&lt;span style="color:#00688b">$CONFIG_CHECK_JAR&lt;/span>&lt;span style="color:#cd5555"> com.puppycrawl.tools.checkstyle.Main -c &lt;/span>&lt;span style="color:#00688b">$CONFIG_CHECK_FILE&lt;/span>&lt;span style="color:#cd5555"> &lt;/span>&lt;span style="color:#00688b">$javafiles&lt;/span>&lt;span style="color:#cd5555"> -f xml -o &lt;/span>&lt;span style="color:#00688b">$CONFIG_ERROR_FILE&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>;
&lt;span style="color:#658b00">echo&lt;/span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#00688b">$CHECK_CMD&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>;
&lt;span style="color:#00688b">$CHECK_CMD&lt;/span>;
&lt;span style="color:#8b008b;font-weight:bold">if&lt;/span> [ -f &lt;span style="color:#00688b">$CONFIG_ERROR_FILE&lt;/span> ]
&lt;span style="color:#8b008b;font-weight:bold">then&lt;/span>
&lt;span style="color:#00688b">errorResponse&lt;/span>=&lt;span style="color:#cd5555">`&lt;/span>cat &lt;span style="color:#00688b">$CONFIG_ERROR_FILE&lt;/span> | grep &lt;span style="color:#cd5555">\&amp;lt;&lt;/span>error|head -n 1&lt;span style="color:#cd5555">`&lt;/span>;
&lt;span style="color:#8b008b;font-weight:bold">if&lt;/span> [[ &lt;span style="color:#00688b">$errorResponse&lt;/span> == *&lt;span style="color:#cd5555">&amp;#34;error&amp;#34;&lt;/span>* ]]
&lt;span style="color:#8b008b;font-weight:bold">then&lt;/span>
awk &lt;span style="color:#cd5555">&amp;#39;{print;} NR == 1 { print &amp;#34;&amp;lt;?xml-stylesheet xmlns=\&amp;#34;http://www.w3.org/1999/xhtml\&amp;#34; href=\&amp;#34;checkstyle-simple.xsl\&amp;#34; type=\&amp;#34;text/xsl\&amp;#34;?&amp;gt;&amp;#34;}&amp;#39;&lt;/span> &lt;span style="color:#00688b">$CONFIG_ERROR_FILE&lt;/span> &amp;gt; &lt;span style="color:#00688b">$CONFIG_ERROR_REPORT_FILE&lt;/span>;
&lt;span style="color:#658b00">echo&lt;/span> -e &lt;span style="color:#cd5555">&amp;#34;Check your code. Open by Safari or Chrome ( --allow-file-access-from-files ): &lt;/span>&lt;span style="color:#00688b">$CONFIG_ERROR_REPORT_FILE&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>;
open &lt;span style="color:#00688b">$CONFIG_ERROR_REPORT_FILE&lt;/span>
&lt;span style="color:#658b00">exit&lt;/span> &lt;span style="color:#b452cd">1&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">fi&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">fi&lt;/span>
&lt;span style="color:#658b00">echo&lt;/span> &lt;span style="color:#cd5555">&amp;#34;check pass! pre_commit successfully!&amp;#34;&lt;/span>;
&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>commit-msg&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">&lt;span style="color:#1e889b">#!/bin/sh
&lt;/span>&lt;span style="color:#1e889b">&lt;/span>&lt;span style="color:#228b22"># append CL message ‰ø°ÊÅØÔºàÂä†ÂÖ•‰ΩúËÄÖ ‰æãÂ≠êÔºâ&lt;/span>
&lt;span style="color:#228b22">#name=[PinkHello]&lt;/span>
&lt;span style="color:#228b22">#commit=&amp;#34;$name $(cat $1)&amp;#34;&lt;/span>
&lt;span style="color:#228b22">#echo &amp;#34;$commit&amp;#34; &amp;gt; &amp;#34;$1&amp;#34;&lt;/span>
&lt;span style="color:#658b00">echo&lt;/span> &lt;span style="color:#00688b">$commit&lt;/span>
&lt;span style="color:#00688b">commit&lt;/span>=&lt;span style="color:#cd5555">`&lt;/span>cat &lt;span style="color:#00688b">$1&lt;/span>&lt;span style="color:#cd5555">`&lt;/span>
&lt;span style="color:#658b00">echo&lt;/span> &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#00688b">$commit&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span> &amp;gt; &lt;span style="color:#cd5555">&amp;#34;&lt;/span>&lt;span style="color:#00688b">$1&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">if&lt;/span> [[ &lt;span style="color:#00688b">$commit&lt;/span> =~ ^([A-Z]+)-([0-9]+):.*|(Merge.*)|(Revert.*)|(Other.*) ]]
&lt;span style="color:#8b008b;font-weight:bold">then&lt;/span>
&lt;span style="color:#658b00">echo&lt;/span> &lt;span style="color:#cd5555">&amp;#34;commit successful!&amp;#34;&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">else&lt;/span>
&lt;span style="color:#658b00">echo&lt;/span> &lt;span style="color:#cd5555">&amp;#34;\033 Error: the commit message must start with JIRA ticket number \033&amp;#34;&lt;/span>
&lt;span style="color:#658b00">exit&lt;/span> &lt;span style="color:#b452cd">1&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">fi&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>init.sh&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">&lt;span style="color:#1e889b">#!/bin/sh
&lt;/span>&lt;span style="color:#1e889b">&lt;/span>&lt;span style="color:#228b22"># ÂΩìÂâçÁõÆÂΩï&lt;/span>
&lt;span style="color:#00688b">workPath&lt;/span>=&lt;span style="color:#8b008b;font-weight:bold">$(&lt;/span>&lt;span style="color:#658b00">pwd&lt;/span>&lt;span style="color:#8b008b;font-weight:bold">)&lt;/span>
&lt;span style="color:#658b00">echo&lt;/span> &lt;span style="color:#cd5555">&amp;#34;ÂΩìÂâçÂàùÂßãÂåñÁõÆÂΩï&lt;/span>&lt;span style="color:#00688b">$workPath&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span>
&lt;span style="color:#228b22"># ÈìæÊé•Âà∞ .git hooks ÁõÆÂΩïÈáåÈù¢&lt;/span>
ln -s -f &lt;span style="color:#00688b">$workPath&lt;/span>/pre-commit &lt;span style="color:#00688b">$workPath&lt;/span>/../.git/hooks/pre-commit
ln -s -f &lt;span style="color:#00688b">$workPath&lt;/span>/commit-msg &lt;span style="color:#00688b">$workPath&lt;/span>/../.git/hooks/commit-msg
&lt;span style="color:#658b00">echo&lt;/span> &lt;span style="color:#cd5555">&amp;#34;ln pre-commit commit-msg.....success.&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="google-cr-mr-ËßÑËåÉ">google CR MR ËßÑËåÉ&lt;/h1>
&lt;p>&lt;a href="https://github.com/google/eng-practices">https://github.com/google/eng-practices&lt;/a>&lt;/p>
&lt;p>&lt;code>CL&lt;/code> ËßÑËåÉÔºö&lt;/p>
&lt;ul>
&lt;li>Êèê‰∫§Êñ∞ÁöÑ &lt;code>subject&lt;/code> ÔºåÊâçÊúâÁ•à‰ΩøÂè•Ôºå‰∏Ä‰∏™ÂëΩ‰ª§ÁöÑÂΩ¢ÂºèË®ÄÁÆÄÊÑèËµÖÁöÑË°®ËææËøôÊ¨°Ë¶ÅÊîπÂèòÁöÑ‰ªÄ‰πàÔºåÂ¶ÇÈúÄË¶ÅËØ¶ÁªÜ‰∏ä‰∏ãÊñáÔºåÂÖ≥ËÅî &lt;code>ticket&lt;/code>ÔºåÂú® &lt;code>body&lt;/code> ‰∏≠ËØ¥Êòé&lt;/li>
&lt;li>ÁÆÄÂåñ &lt;code>cl&lt;/code> ÔºåÂ∞ΩÂèØËÉΩÂ∞èÔºå‰∏çË¶ÅÁßØÊîí‰∏ÄÂ†Ü &lt;code>change&lt;/code> Ôºå‰∏ÄÊ¨°ÊÄßÊèê‰∫§ÔºåÁÑ∂ÂêéÂÜç‰∏ÄÊ¨°ÊÄß &lt;code>MR&lt;/code> ÔºåÂä†Â§ß‰∫Ü &lt;code>review&lt;/code> È£éÈô©„ÄÇ&lt;/li>
&lt;/ul>
&lt;p>&lt;code>MR&lt;/code> ËßÑËåÉ&lt;/p>
&lt;ul>
&lt;li>Á¥ßÊÄ• &lt;code>MR&lt;/code> ÈÄÇÂΩìÊîæÊùæ&lt;/li>
&lt;li>&lt;code>MR&lt;/code> ‰∏çËÉΩÂ∏¶ÊúâËÑæÊ∞îÔºåÁõÆÁöÑÊòØÂü∫‰∫éÈóÆÈ¢òËÆ®ËÆ∫ÔºåËß£ÂÜ≥ÈóÆÈ¢ò&lt;/li>
&lt;li>ÈíàÂØπÂÅöÁöÑÂ•ΩÁöÑÁªô‰∫àËÇØÂÆöÂíåüëç&lt;/li>
&lt;li>&lt;code>LGTM means look good to me &lt;/code>= ÊúïÁü•ÈÅì‰∫ÜÔºÅ&lt;/li>
&lt;li>&lt;code>MR&lt;/code> ÂÜ≤Á™ÅÔºåËÅîÁ≥ªÂøÖË¶ÅÂºÄÂèëËÄÖ‰∏ÄËµ∑ÂèÇ‰∏éÂÜ≥ÂÆöÈÅøÂÖçÂá∫Áé∞‰ª£Á†Å‰∏¢Â§±‰∏éÈîôËØØ.&lt;/li>
&lt;/ul>
&lt;p>&lt;code>CR&lt;/code> ËßÑËåÉ&lt;/p>
&lt;ul>
&lt;li>ÈÄüÂ∫¶ÂèØ‰ª•ÁÅ≠ÊùÄ‰∏ÄÂàáÊä±ÊÄ®Ôºå‰∏çËÉΩËÆ© &lt;code>cr&lt;/code> Êó∂Èó¥ËøáÈïø&lt;/li>
&lt;li>&lt;code>CR&lt;/code> ÂèëÁé∞ÈóÆÈ¢ò‰∏ÄÂÆöË¶ÅËÆ©ÂºÄÂèëËÄÖÂéª‰øÆÊîπÔºå‰∏çË¶ÅÊúâ‰ª•ÂêéÂÜç‰øÆÊîπÁöÑÊÉ≥Ê≥ïÔºåËøôÁßçÊñπÂºèÂæÄÂæÄÊòØËÆ©Á≥ªÁªüÂèòÂæóÊõ¥Â∑ÆÁöÑÂéüÂõ†.&lt;/li>
&lt;/ul>
- https://pinkhello.me/posts/09-%E4%BD%BF%E7%94%A8githook%E7%BB%9F%E4%B8%80codestyle/ - PinkHello, All Rights Reserved</description></item><item><title>08 GradleÂ§öÊ®°ÂùóÈ°πÁõÆÊ®°ÊùøÂåñ</title><link>https://pinkhello.me/posts/08-gradle%E5%A4%9A%E6%A8%A1%E5%9D%97%E9%A1%B9%E7%9B%AE%E6%A8%A1%E6%9D%BF%E5%8C%96/</link><pubDate>Wed, 10 Feb 2021 08:43:21 +0800</pubDate><guid>https://pinkhello.me/posts/08-gradle%E5%A4%9A%E6%A8%A1%E5%9D%97%E9%A1%B9%E7%9B%AE%E6%A8%A1%E6%9D%BF%E5%8C%96/</guid><description>PinkHello https://pinkhello.me/posts/08-gradle%E5%A4%9A%E6%A8%A1%E5%9D%97%E9%A1%B9%E7%9B%AE%E6%A8%A1%E6%9D%BF%E5%8C%96/ -&lt;h2 id="ÂâçË®Ä">ÂâçË®Ä&lt;/h2>
&lt;p>Maven ÂÜó‰ΩôÔºå Gradle ÁÆÄÂçïËΩª‰æø
ÂÖ¨Âè∏ÂéüÊúâÁöÑ CI/CD ÊµÅÁ®ãÔºåÂÄüÂä© Maven Êèí‰ª∂ build Docker Image,Êîπ‰∏∫ÂéüÁîü Docker Runner ÂéüÂßãÊûÑÂª∫&lt;/p>
&lt;h2 id="1Â§öÊ®°ÂùóÈ°πÁõÆ">1„ÄÅÂ§öÊ®°ÂùóÈ°πÁõÆ&lt;/h2>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yaml" data-lang="yaml">project&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb"> &lt;/span>- app&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb"> &lt;/span>- src/main/[java|resources] | src/test/[java|resources] &lt;span style="color:#bbb"> &lt;/span>&lt;span style="color:#228b22"># classpath&lt;/span>&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb"> &lt;/span>- Dockerfile &lt;span style="color:#bbb"> &lt;/span>&lt;span style="color:#228b22"># Dockerfile&lt;/span>&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb"> &lt;/span>- build.gradle &lt;span style="color:#bbb"> &lt;/span>&lt;span style="color:#228b22"># APP Ê®°Âùó gradle ÈÖçÁΩÆ&lt;/span>&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb"> &lt;/span>- sdk &lt;span style="color:#bbb"> &lt;/span>&lt;span style="color:#228b22"># SDK Ê®°Âùó ÂèØÊúâÂèØÊó†&lt;/span>&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb"> &lt;/span>- src/main/java&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb"> &lt;/span>- build.gradle &lt;span style="color:#bbb"> &lt;/span>&lt;span style="color:#228b22"># SDK ÁöÑ gradle ÈÖçÁΩÆ&lt;/span>&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb"> &lt;/span>- deploy &lt;span style="color:#bbb"> &lt;/span>&lt;span style="color:#228b22"># delpoy È°πÁõÆ Ê≥®ÊÑè checkstyle Áõ∏ÂÖ≥ÈÖçÁΩÆÂú®ËøôÈáåÈù¢&lt;/span>&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb"> &lt;/span>- checkstyle/**&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb"> &lt;/span>- &lt;span style="color:#1e889b">**.yml&lt;/span>&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb"> &lt;/span>- build.gradle &lt;span style="color:#bbb"> &lt;/span>&lt;span style="color:#228b22"># È°πÁõÆÈ°∂Á∫ß gradleÈÖçÁΩÆ&lt;/span>&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb"> &lt;/span>- gradle&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb"> &lt;/span>- wrapper/** &lt;span style="color:#bbb"> &lt;/span>&lt;span style="color:#228b22"># gradle ÈÖçÁΩÆ‰ø°ÊÅØ&lt;/span>&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb"> &lt;/span>- check.gradle &lt;span style="color:#bbb"> &lt;/span>&lt;span style="color:#228b22"># pmd &amp;amp; checkstyle&lt;/span>&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb"> &lt;/span>- repo.gradle &lt;span style="color:#bbb"> &lt;/span>&lt;span style="color:#228b22"># ‰ªìÂ∫ìÂÆö‰πâ&lt;/span>&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb">&lt;/span>&lt;span style="color:#228b22"># test.gradle ÊîæËøôÂÑøÔºåÂ∞±Ê≤°ÊúâÈ´ò‰∫Æ‰∫Ü =&amp;gt; ÊöÇÊó∂Áª¥Êä§Âú® È°∂Â±ÇÁöÑ build.gradle ‰∏≠ÔºåÂçïÁã¨Áª¥Êä§Ôºå‰∏çË¶ÅÂíåÂÖ∂‰ªñÈÖçÁΩÆÊ∑∑Âú®‰∏ÄËµ∑„ÄÇ&lt;/span>&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb"> &lt;/span>- settings.gradle &lt;span style="color:#bbb"> &lt;/span>&lt;span style="color:#228b22"># ÈÖçÁΩÆ&lt;/span>&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb"> &lt;/span>- versions-prod.gradle &lt;span style="color:#bbb"> &lt;/span>&lt;span style="color:#228b22"># ÁâàÊú¨ÂÆö‰πâ&lt;/span>&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb"> &lt;/span>- versions-dev.gradle &lt;span style="color:#bbb"> &lt;/span>&lt;span style="color:#228b22"># ÁâàÊú¨ÂÆö‰πâ&lt;/span>&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb"> &lt;/span>- .gitignore &lt;span style="color:#bbb"> &lt;/span>&lt;span style="color:#228b22"># gitÂøΩÁï•Êñá‰ª∂&lt;/span>&lt;span style="color:#bbb">
&lt;/span>&lt;span style="color:#bbb"> &lt;/span>- .gitlab-ci.yml &lt;span style="color:#bbb"> &lt;/span>&lt;span style="color:#228b22"># CI/CD&lt;/span>&lt;span style="color:#bbb">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="2project-‰∏ãÂêÑ‰∏™gradleÊñá‰ª∂">2„ÄÅProject ‰∏ãÂêÑ‰∏™gradleÊñá‰ª∂&lt;/h2>
&lt;p>Project/versions.gradle ÂèØ‰ª•Áªü‰∏ÄÁâàÊú¨ÁÆ°ÁêÜ&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-groovy" data-lang="groovy">&lt;span style="color:#228b22">//start step
&lt;/span>&lt;span style="color:#228b22">&lt;/span>&lt;span style="color:#00688b;font-weight:bold">def&lt;/span> versions = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> Expando()
&lt;span style="color:#00688b;font-weight:bold">def&lt;/span> deps = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> Expando()
ext.&lt;span style="color:#658b00">versions&lt;/span> = versions
ext.&lt;span style="color:#658b00">deps&lt;/span> = deps
&lt;span style="color:#228b22">//set versions
&lt;/span>&lt;span style="color:#228b22">&lt;/span>versions.&lt;span style="color:#658b00">springboot&lt;/span> = &lt;span style="color:#cd5555">&amp;#34;2.1.16.RELEASE&amp;#34;&lt;/span>
versions.&lt;span style="color:#658b00">mysql&lt;/span> = &lt;span style="color:#cd5555">&amp;#34;8.0.16&amp;#34;&lt;/span>
versions.&lt;span style="color:#658b00">guava&lt;/span> = &lt;span style="color:#cd5555">&amp;#34;25.1-jre&amp;#34;&lt;/span>
versions.&lt;span style="color:#658b00">httpclient&lt;/span> = &lt;span style="color:#cd5555">&amp;#34;4.5.9&amp;#34;&lt;/span>
versions.&lt;span style="color:#658b00">okhttp3&lt;/span> = &lt;span style="color:#cd5555">&amp;#34;3.8.1&amp;#34;&lt;/span>
versions.&lt;span style="color:#658b00">apm&lt;/span> = &lt;span style="color:#cd5555">&amp;#34;1.7.0&amp;#34;&lt;/span>
versions.&lt;span style="color:#658b00">kotlin&lt;/span> = &lt;span style="color:#cd5555">&amp;#34;1.4.10&amp;#34;&lt;/span>
&lt;span style="color:#228b22">//set dependencies
&lt;/span>&lt;span style="color:#228b22">&lt;/span>
&lt;span style="color:#228b22">// Âü∫Á°ÄÂºÄÊ∫êÂåÖ
&lt;/span>&lt;span style="color:#228b22">&lt;/span>deps.&lt;span style="color:#658b00">mysql&lt;/span> = &lt;span style="color:#cd5555">&amp;#34;mysql:mysql-connector-java:${versions.mysql}&amp;#34;&lt;/span>
deps.&lt;span style="color:#658b00">guava&lt;/span> = &lt;span style="color:#cd5555">&amp;#34;com.google.guava:guava:${versions.guava}&amp;#34;&lt;/span>
deps.&lt;span style="color:#658b00">okhttp3&lt;/span> = &lt;span style="color:#cd5555">&amp;#34;com.squareup.okhttp3:okhttp:${versions.okhttp3}&amp;#34;&lt;/span>
deps.&lt;span style="color:#658b00">apm&lt;/span> = &lt;span style="color:#cd5555">&amp;#34;co.elastic.apm:apm-agent-attach:${versions.apm}&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Project/settings.gradle Ê†πÈÖçÁΩÆÊñá‰ª∂Ôºåbuild Âø´‰∏çÂø´ÂÖ®Èù†ÂÆÉ&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-groovy" data-lang="groovy">&lt;span style="color:#228b22">//ÈÖçÁΩÆÊèí‰ª∂Ëµ∞ÂõΩÂÜÖ‰ª£ÁêÜ
&lt;/span>&lt;span style="color:#228b22">&lt;/span>pluginManagement {
repositories {
maven {
url &lt;span style="color:#cd5555">&amp;#39;https://maven.aliyun.com/repository/gradle-plugin&amp;#39;&lt;/span>
}
gradlePluginPortal()
}
}
rootProject.&lt;span style="color:#658b00">name&lt;/span> = &lt;span style="color:#cd5555">&amp;#39;project-name&amp;#39;&lt;/span>
include &lt;span style="color:#cd5555">&amp;#39;:app&amp;#39;&lt;/span>
include &lt;span style="color:#cd5555">&amp;#39;:sdk&amp;#39;&lt;/span> &lt;span style="color:#228b22">// Ê≤°ÊúâSDKÊ®°ÂùóÁöÑÂåñ‰∏çÈúÄË¶ÅËøô‰∏™
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Project/build.gradle&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-groovy" data-lang="groovy">buildscript {
ext {
kotlinVersion = &lt;span style="color:#cd5555">&amp;#34;1.4.10&amp;#34;&lt;/span>
springBootVersion = &lt;span style="color:#cd5555">&amp;#39;2.1.16.RELEASE&amp;#39;&lt;/span>
springBootGradleVersion = &lt;span style="color:#cd5555">&amp;#39;2.3.3.RELEASE&amp;#39;&lt;/span>
}
}
plugins {
id &lt;span style="color:#cd5555">&amp;#34;java&amp;#34;&lt;/span>
id &lt;span style="color:#cd5555">&amp;#34;pmd&amp;#34;&lt;/span>
id &lt;span style="color:#cd5555">&amp;#34;checkstyle&amp;#34;&lt;/span>
id &lt;span style="color:#cd5555">&amp;#34;maven-publish&amp;#34;&lt;/span>
id &lt;span style="color:#cd5555">&amp;#34;org.jetbrains.kotlin.jvm&amp;#34;&lt;/span> version &lt;span style="color:#cd5555">&amp;#34;$kotlinVersion&amp;#34;&lt;/span>
id &lt;span style="color:#cd5555">&amp;#34;org.jetbrains.kotlin.plugin.spring&amp;#34;&lt;/span> version &lt;span style="color:#cd5555">&amp;#34;$kotlinVersion&amp;#34;&lt;/span>
id &lt;span style="color:#cd5555">&amp;#34;org.springframework.boot&amp;#34;&lt;/span> version &lt;span style="color:#cd5555">&amp;#34;$springBootVersion&amp;#34;&lt;/span>
id &lt;span style="color:#cd5555">&amp;#34;io.spring.dependency-management&amp;#34;&lt;/span> version &lt;span style="color:#cd5555">&amp;#34;1.0.9.RELEASE&amp;#34;&lt;/span>
}
apply from: file(&lt;span style="color:#cd5555">&amp;#34;versions.gradle&amp;#34;&lt;/span>)
&lt;span style="color:#228b22">// ‰∏∫‰∫Ü‰∏ÄÂ¶Ç‰∏çÂêåÁöÑÁâàÊú¨ÁéØÂ¢É‰∏ãÁöÑ‰ª£Á†ÅÈÖçÁΩÆ
&lt;/span>&lt;span style="color:#228b22">&lt;/span>&lt;span style="color:#00688b;font-weight:bold">def&lt;/span> env = System.&lt;span style="color:#658b00">getProperty&lt;/span>(&lt;span style="color:#cd5555">&amp;#39;env&amp;#39;&lt;/span>) ?: &lt;span style="color:#cd5555">&amp;#39;dev&amp;#39;&lt;/span>
apply from: &lt;span style="color:#cd5555">&amp;#34;${rootDir}/versions-${env}.gradle&amp;#34;&lt;/span>
allprojects {
&lt;span style="color:#228b22">// ÈÖçÁΩÆ group
&lt;/span>&lt;span style="color:#228b22">&lt;/span> group &lt;span style="color:#cd5555">&amp;#34;com.XXX.XXX&amp;#34;&lt;/span>
&lt;span style="color:#228b22">//ÈÖçÁΩÆÁâàÊú¨
&lt;/span>&lt;span style="color:#228b22">&lt;/span> version = findProperty &lt;span style="color:#cd5555">&amp;#39;version&amp;#39;&lt;/span> ?: &lt;span style="color:#cd5555">&amp;#39;1.0.0-SNAPSHOT&amp;#39;&lt;/span>
bootJar {
enabled = &lt;span style="color:#8b008b;font-weight:bold">false&lt;/span>
}
apply plugin: &lt;span style="color:#cd5555">&amp;#34;java&amp;#34;&lt;/span>
apply plugin: &lt;span style="color:#cd5555">&amp;#34;idea&amp;#34;&lt;/span>
apply plugin: &lt;span style="color:#cd5555">&amp;#34;maven-publish&amp;#34;&lt;/span>
apply plugin: &lt;span style="color:#cd5555">&amp;#34;org.jetbrains.kotlin.jvm&amp;#34;&lt;/span>
apply plugin: &lt;span style="color:#cd5555">&amp;#34;kotlin-spring&amp;#34;&lt;/span>
apply plugin: &lt;span style="color:#cd5555">&amp;#34;org.springframework.boot&amp;#34;&lt;/span>
apply plugin: &lt;span style="color:#cd5555">&amp;#34;io.spring.dependency-management&amp;#34;&lt;/span>
apply plugin: &lt;span style="color:#cd5555">&amp;#39;jacoco&amp;#39;&lt;/span>
&lt;span style="color:#228b22">//ÂÅáÂ¶Ç ‰Ω†ÁöÑ mapper.xml ÊàñËÄÖ grovvy ÂÜôÂú® src/main/java ÔºåÊâìÂåÖÈúÄË¶ÅÂ§ÑÁêÜÂà∞ ÈúÄË¶ÅÂä†ÂÖ•ÁöÑresourcesÔºåÈúÄË¶ÅÊâãÂä®Â§ÑÁêÜ
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#228b22">// ÂΩìÁÑ∂Â¶ÇÊûú ‰Ω†ÁöÑ mapper.xml Áõ¥Êé•Âú® src/main/resources ÈáåÈù¢ ‰∏çÈúÄË¶ÅÂ§ÑÁêÜÔºåÂèØ‰ª•Áõ¥Êé•Âà†Èô§
&lt;/span>&lt;span style="color:#228b22">&lt;/span> processResources {
from(&lt;span style="color:#cd5555">&amp;#39;src/main/java&amp;#39;&lt;/span>) {
include &lt;span style="color:#cd5555">&amp;#39;**/*.xml&amp;#39;&lt;/span>
include &lt;span style="color:#cd5555">&amp;#39;**/*.groovy&amp;#39;&lt;/span>
}
}
}
&lt;span style="color:#228b22">// apply from: file(&amp;#34;gradle/repo.gradle&amp;#34;)
&lt;/span>&lt;span style="color:#228b22">// apply from: file(&amp;#34;gradle/check.gradle&amp;#34;)
&lt;/span>&lt;span style="color:#228b22">// apply from: file(&amp;#34;gradle/maven-publish.gradle&amp;#34;)
&lt;/span>&lt;span style="color:#228b22">&lt;/span>apply from: &lt;span style="color:#cd5555">&amp;#39;https://${DownloadPath}/gradle/check-style.gradle&amp;#39;&lt;/span>
apply from: &lt;span style="color:#cd5555">&amp;#39;https://${DownloadPath}/gradle/maven-repo.gradle&amp;#39;&lt;/span>
apply from: &lt;span style="color:#cd5555">&amp;#39;https://${DownloadPath}/gradle/maven-publish.gradle&amp;#39;&lt;/span>
subprojects {
configurations {
provided
}
sourceSets.&lt;span style="color:#658b00">main&lt;/span>.&lt;span style="color:#658b00">compileClasspath&lt;/span> += configurations.&lt;span style="color:#658b00">provided&lt;/span>
sourceSets.&lt;span style="color:#658b00">test&lt;/span>.&lt;span style="color:#658b00">compileClasspath&lt;/span> += configurations.&lt;span style="color:#658b00">provided&lt;/span>
sourceSets.&lt;span style="color:#658b00">test&lt;/span>.&lt;span style="color:#658b00">runtimeClasspath&lt;/span> += configurations.&lt;span style="color:#658b00">provided&lt;/span>
tasks.&lt;span style="color:#658b00">withType&lt;/span>(JavaCompile) {
options.&lt;span style="color:#658b00">encoding&lt;/span> = &lt;span style="color:#cd5555">&amp;#39;UTF-8&amp;#39;&lt;/span>
}
task &lt;span style="color:#008b45">sourceJar&lt;/span>(type: Jar) {
from sourceSets.&lt;span style="color:#658b00">main&lt;/span>.&lt;span style="color:#658b00">allJava&lt;/span>
classifier &lt;span style="color:#cd5555">&amp;#34;sources&amp;#34;&lt;/span>
}
task &lt;span style="color:#008b45">javadocJar&lt;/span>(type: Jar, dependsOn: javadoc) {
from javadoc.&lt;span style="color:#658b00">destinationDir&lt;/span>
}
dependencies {
implementation &lt;span style="color:#cd5555">&amp;#34;com.google.guava:guava:$versions.guava&amp;#34;&lt;/span>
compileOnly &lt;span style="color:#cd5555">&amp;#39;org.projectlombok:lombok:1.18.4&amp;#39;&lt;/span>
annotationProcessor &lt;span style="color:#cd5555">&amp;#39;org.projectlombok:lombok:1.18.4&amp;#39;&lt;/span>
testCompileOnly &lt;span style="color:#cd5555">&amp;#39;org.projectlombok:lombok:1.18.4&amp;#39;&lt;/span>
testAnnotationProcessor &lt;span style="color:#cd5555">&amp;#39;org.projectlombok:lombok:1.18.4&amp;#39;&lt;/span>
testImplementation &lt;span style="color:#cd5555">&amp;#34;org.springframework.boot:spring-boot-starter-test:$springBootVersion&amp;#34;&lt;/span>
testImplementation &lt;span style="color:#cd5555">&amp;#34;org.mockito:mockito-core:2.23.4&amp;#34;&lt;/span>
testImplementation &lt;span style="color:#cd5555">&amp;#39;junit:junit:4.13&amp;#39;&lt;/span>
&lt;span style="color:#228b22">// h2
&lt;/span>&lt;span style="color:#228b22">&lt;/span> testImplementation &lt;span style="color:#cd5555">&amp;#34;com.h2database:h2:1.4.200&amp;#34;&lt;/span>
&lt;span style="color:#228b22">// redis memery
&lt;/span>&lt;span style="color:#228b22">&lt;/span> testImplementation &lt;span style="color:#cd5555">&amp;#34;com.github.kstyrc:embedded-redis:0.6&amp;#34;&lt;/span>
}
&lt;span style="color:#228b22">// jacoco report
&lt;/span>&lt;span style="color:#228b22">&lt;/span> jacocoTestReport {
reports {
xml.&lt;span style="color:#658b00">enabled&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">false&lt;/span>
html.&lt;span style="color:#658b00">enabled&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">true&lt;/span>
}
}
check.&lt;span style="color:#658b00">dependsOn&lt;/span> jacocoTestReport
}
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-groovy" data-lang="groovy">
allprojects {
apply plugin: &lt;span style="color:#cd5555">&amp;#39;maven-publish&amp;#39;&lt;/span>
publishing {
task &lt;span style="color:#008b45">sourceJar&lt;/span>(type: Jar) {
from sourceSets.&lt;span style="color:#658b00">main&lt;/span>.&lt;span style="color:#658b00">allJava&lt;/span>
classifier &lt;span style="color:#cd5555">&amp;#34;sources&amp;#34;&lt;/span>
}
publications {
mavenSnapshots(MavenPublication) {
groupId project.&lt;span style="color:#658b00">group&lt;/span>
artifactId project.&lt;span style="color:#658b00">name&lt;/span>
version project.&lt;span style="color:#658b00">version&lt;/span>
from components.&lt;span style="color:#658b00">java&lt;/span>
artifact sourceJar
ext.&lt;span style="color:#658b00">repo&lt;/span> = &lt;span style="color:#cd5555">&amp;#39;Dev&amp;#39;&lt;/span>
}
mavenRelease(MavenPublication) {
groupId project.&lt;span style="color:#658b00">group&lt;/span>
artifactId project.&lt;span style="color:#658b00">name&lt;/span>
version project.&lt;span style="color:#658b00">version&lt;/span>
from components.&lt;span style="color:#658b00">java&lt;/span>
artifact sourceJar
ext.&lt;span style="color:#658b00">repo&lt;/span> = &lt;span style="color:#cd5555">&amp;#39;Prod&amp;#39;&lt;/span>
}
}
repositories {
maven {
name &lt;span style="color:#cd5555">&amp;#39;Dev&amp;#39;&lt;/span>
url &lt;span style="color:#cd5555">&amp;#34;${NEXUS_URL}/repository/maven-snapshots/&amp;#34;&lt;/span>
authentication {
header(HttpHeaderAuthentication)
}
credentials(HttpHeaderCredentials) {
name &lt;span style="color:#cd5555">&amp;#34;Authorization&amp;#34;&lt;/span>
value &lt;span style="color:#cd5555">&amp;#34;Basic ${NEXUS_CAS_HEADER}&amp;#34;&lt;/span>
}
}
maven {
name &lt;span style="color:#cd5555">&amp;#39;Prod&amp;#39;&lt;/span>
url &lt;span style="color:#cd5555">&amp;#34;${NEXUS_URL}/repository/maven-releases/&amp;#34;&lt;/span>
}
}
}
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Project/gradle/repo.gradle ÊåáÂÆöÁßÅÊúâ‰ªìÂ∫ìÂú∞ÂùÄ‰ª•ÂèäÈ™åËØÅÊñπÂºè&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-groovy" data-lang="groovy">buildscript {
repositories {
mavenLocal()
maven {
url &lt;span style="color:#cd5555">&amp;#34;${NEXUS_URL}/repository/maven-releases/&amp;#34;&lt;/span>
authentication {
header(HttpHeaderAuthentication)
}
credentials(HttpHeaderCredentials) {
name &lt;span style="color:#cd5555">&amp;#34;Authorization&amp;#34;&lt;/span>
value &lt;span style="color:#cd5555">&amp;#34;Basic ${NEXUS_CAS_HEADER}&amp;#34;&lt;/span>
}
}
maven {
url &lt;span style="color:#cd5555">&amp;#34;${NEXUS_URL}/repository/maven-snapshots/&amp;#34;&lt;/span>
authentication {
header(HttpHeaderAuthentication)
}
credentials(HttpHeaderCredentials) {
name &lt;span style="color:#cd5555">&amp;#34;Authorization&amp;#34;&lt;/span>
value &lt;span style="color:#cd5555">&amp;#34;Basic ${NEXUS_CAS_HEADER}&amp;#34;&lt;/span>
}
}
maven {
url &lt;span style="color:#cd5555">&amp;#34;${NEXUS_URL}/repository/maven-public/&amp;#34;&lt;/span>
authentication {
header(HttpHeaderAuthentication)
}
credentials(HttpHeaderCredentials) {
name &lt;span style="color:#cd5555">&amp;#34;Authorization&amp;#34;&lt;/span>
value &lt;span style="color:#cd5555">&amp;#34;Basic ${NEXUS_CAS_HEADER}&amp;#34;&lt;/span>
}
}
maven { url &lt;span style="color:#cd5555">&amp;#34;https://maven.aliyun.com/nexus/content/groups/public/&amp;#34;&lt;/span> }
maven { url &lt;span style="color:#cd5555">&amp;#34;https://repo.spring.io/milestone&amp;#34;&lt;/span> }
maven { url &lt;span style="color:#cd5555">&amp;#34;https://oss.sonatype.org/content/repositories/snapshots/&amp;#34;&lt;/span> }
}
}
allprojects {
repositories {
mavenLocal()
maven {
url &lt;span style="color:#cd5555">&amp;#34;${NEXUS_URL}/repository/maven-releases/&amp;#34;&lt;/span>
authentication {
header(HttpHeaderAuthentication)
}
credentials(HttpHeaderCredentials) {
name &lt;span style="color:#cd5555">&amp;#34;Authorization&amp;#34;&lt;/span>
value &lt;span style="color:#cd5555">&amp;#34;Basic ${NEXUS_CAS_HEADER}&amp;#34;&lt;/span>
}
}
maven {
url &lt;span style="color:#cd5555">&amp;#34;${NEXUS_URL}/repository/maven-snapshots/&amp;#34;&lt;/span>
authentication {
header(HttpHeaderAuthentication)
}
credentials(HttpHeaderCredentials) {
name &lt;span style="color:#cd5555">&amp;#34;Authorization&amp;#34;&lt;/span>
value &lt;span style="color:#cd5555">&amp;#34;Basic ${NEXUS_CAS_HEADER}&amp;#34;&lt;/span>
}
}
maven {
url &lt;span style="color:#cd5555">&amp;#34;${NEXUS_URL}/repository/maven-public/&amp;#34;&lt;/span>
authentication {
header(HttpHeaderAuthentication)
}
credentials(HttpHeaderCredentials) {
name &lt;span style="color:#cd5555">&amp;#34;Authorization&amp;#34;&lt;/span>
value &lt;span style="color:#cd5555">&amp;#34;Basic ${NEXUS_CAS_HEADER}&amp;#34;&lt;/span>
}
}
maven { url &lt;span style="color:#cd5555">&amp;#34;https://maven.aliyun.com/nexus/content/groups/public/&amp;#34;&lt;/span> }
maven { url &lt;span style="color:#cd5555">&amp;#34;https://repo.spring.io/milestone&amp;#34;&lt;/span> }
maven { url &lt;span style="color:#cd5555">&amp;#34;https://oss.sonatype.org/content/repositories/snapshots/&amp;#34;&lt;/span> }
}
}
subprojects {
repositories {
mavenLocal()
maven {
url &lt;span style="color:#cd5555">&amp;#34;${NEXUS_URL}/repository/maven-releases/&amp;#34;&lt;/span>
authentication {
header(HttpHeaderAuthentication)
}
credentials(HttpHeaderCredentials) {
name &lt;span style="color:#cd5555">&amp;#34;Authorization&amp;#34;&lt;/span>
value &lt;span style="color:#cd5555">&amp;#34;Basic ${NEXUS_CAS_HEADER}&amp;#34;&lt;/span>
}
}
maven {
url &lt;span style="color:#cd5555">&amp;#34;${NEXUS_URL}/repository/maven-snapshots/&amp;#34;&lt;/span>
authentication {
header(HttpHeaderAuthentication)
}
credentials(HttpHeaderCredentials) {
name &lt;span style="color:#cd5555">&amp;#34;Authorization&amp;#34;&lt;/span>
value &lt;span style="color:#cd5555">&amp;#34;Basic ${NEXUS_CAS_HEADER}&amp;#34;&lt;/span>
}
}
maven {
url &lt;span style="color:#cd5555">&amp;#34;${NEXUS_URL}/repository/maven-public/&amp;#34;&lt;/span>
authentication {
header(HttpHeaderAuthentication)
}
credentials(HttpHeaderCredentials) {
name &lt;span style="color:#cd5555">&amp;#34;Authorization&amp;#34;&lt;/span>
value &lt;span style="color:#cd5555">&amp;#34;Basic ${NEXUS_CAS_HEADER}&amp;#34;&lt;/span>
}
}
maven { url &lt;span style="color:#cd5555">&amp;#34;https://maven.aliyun.com/nexus/content/groups/public/&amp;#34;&lt;/span> }
maven { url &lt;span style="color:#cd5555">&amp;#34;https://repo.spring.io/milestone&amp;#34;&lt;/span> }
maven { url &lt;span style="color:#cd5555">&amp;#34;https://oss.sonatype.org/content/repositories/snapshots/&amp;#34;&lt;/span> }
}
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Project/gradle/check.gradle&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-groovy" data-lang="groovy">subprojects {
apply plugin: &lt;span style="color:#cd5555">&amp;#39;checkstyle&amp;#39;&lt;/span>
checkstyle {
configFile = rootProject.&lt;span style="color:#658b00">file&lt;/span>(&lt;span style="color:#cd5555">&amp;#39;deploy/checkstyle/checkstyle.xml&amp;#39;&lt;/span>)
showViolations = &lt;span style="color:#8b008b;font-weight:bold">true&lt;/span>
&lt;span style="color:#228b22">// ignoreFailures = true
&lt;/span>&lt;span style="color:#228b22">&lt;/span>
}
&lt;span style="color:#228b22">//ÂèØ‰ª•ÊåáÂÆöÊéíÊü•
&lt;/span>&lt;span style="color:#228b22">&lt;/span> checkstyleMain {
exclude &lt;span style="color:#cd5555">&amp;#34;**/*.groovy&amp;#34;&lt;/span>
}
apply plugin: &lt;span style="color:#cd5555">&amp;#39;pmd&amp;#39;&lt;/span>
dependencies {
pmd &lt;span style="color:#cd5555">&amp;#34;com.alibaba.p3c:p3c-pmd:2.0.0&amp;#34;&lt;/span>
}
pmd {
consoleOutput = &lt;span style="color:#8b008b;font-weight:bold">true&lt;/span>
ruleSets = [
&lt;span style="color:#cd5555">&amp;#34;java-ali-comment&amp;#34;&lt;/span>,
&lt;span style="color:#cd5555">&amp;#34;java-ali-concurrent&amp;#34;&lt;/span>,
&lt;span style="color:#cd5555">&amp;#34;java-ali-constant&amp;#34;&lt;/span>,
&lt;span style="color:#cd5555">&amp;#34;java-ali-exception&amp;#34;&lt;/span>,
&lt;span style="color:#cd5555">&amp;#34;java-ali-flowcontrol&amp;#34;&lt;/span>,
&lt;span style="color:#cd5555">&amp;#34;java-ali-naming&amp;#34;&lt;/span>,
&lt;span style="color:#cd5555">&amp;#34;java-ali-oop&amp;#34;&lt;/span>,
&lt;span style="color:#cd5555">&amp;#34;java-ali-orm&amp;#34;&lt;/span>,
&lt;span style="color:#cd5555">&amp;#34;java-ali-other&amp;#34;&lt;/span>,
&lt;span style="color:#cd5555">&amp;#34;java-ali-set&amp;#34;&lt;/span>
]
incrementalAnalysis = &lt;span style="color:#8b008b;font-weight:bold">false&lt;/span>
}
pmdMain {
exclude &lt;span style="color:#cd5555">&amp;#34;**/exclude_package/**&amp;#34;&lt;/span>
}
}
test.&lt;span style="color:#658b00">mustRunAfter&lt;/span> checkstyleMain, checkstyleTest
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Project/sdk/build.gradle&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-groovy" data-lang="groovy">apply from: file(&lt;span style="color:#cd5555">&amp;#34;$rootDir/versions.gradle&amp;#34;&lt;/span>)
jar {
enabled = &lt;span style="color:#8b008b;font-weight:bold">true&lt;/span>
}
bootJar {
enabled = &lt;span style="color:#8b008b;font-weight:bold">false&lt;/span>
}
dependencies {
implementation &lt;span style="color:#cd5555">&amp;#39;org.springframework.cloud:spring-cloud-starter-openfeign:2.1.0.RELEASE&amp;#39;&lt;/span>
......
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Project/app/build.gradle&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-groovy" data-lang="groovy">apply from: file(&lt;span style="color:#cd5555">&amp;#34;$rootDir/versions.gradle&amp;#34;&lt;/span>)
bootJar {
enabled = &lt;span style="color:#8b008b;font-weight:bold">true&lt;/span>
}
jar {
enabled = &lt;span style="color:#8b008b;font-weight:bold">false&lt;/span>
}
dependencies {
implementation deps.&lt;span style="color:#658b00">springboot&lt;/span>.&lt;span style="color:#658b00">starter&lt;/span>
implementation deps.&lt;span style="color:#658b00">springboot&lt;/span>.&lt;span style="color:#658b00">starter_web&lt;/span>
implementation deps.&lt;span style="color:#658b00">mysql&lt;/span>
implementation deps.&lt;span style="color:#658b00">myabtis&lt;/span>.&lt;span style="color:#658b00">myabtis&lt;/span>
implementation deps.&lt;span style="color:#658b00">myabtis&lt;/span>.&lt;span style="color:#658b00">starter&lt;/span>
implementation &lt;span style="color:#cd5555">&amp;#39;org.springframework.boot:spring-boot-starter-amqp:2.1.2.RELEASE&amp;#39;&lt;/span>
implementation &lt;span style="color:#cd5555">&amp;#34;org.springframework.cloud:spring-cloud-starter-openfeign:2.1.0.RELEASE&amp;#34;&lt;/span>
implementation &lt;span style="color:#cd5555">&amp;#39;com.zaxxer:HikariCP:3.4.1&amp;#39;&lt;/span>
implementation &lt;span style="color:#cd5555">&amp;#39;com.baomidou:mybatis-plus:2.2.0&amp;#39;&lt;/span>
implementation &lt;span style="color:#cd5555">&amp;#39;com.github.pagehelper:pagehelper:5.1.2&amp;#39;&lt;/span>
implementation &lt;span style="color:#cd5555">&amp;#39;org.mongodb:mongo-java-driver:3.8.0&amp;#39;&lt;/span>
...... &lt;span style="color:#228b22">//Ââ©‰ΩôÊò†Â∞Ñ‰æùËµñ
&lt;/span>&lt;span style="color:#228b22">&lt;/span>}
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="3-dockerfile-Ê≥®ÊÑè-add-Êñá‰ª∂Ë∑ØÂæÑ">3„ÄÅ Dockerfile Ê≥®ÊÑè ADD Êñá‰ª∂Ë∑ØÂæÑ&lt;/h2>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-dockerfile" data-lang="dockerfile">&lt;span style="color:#8b008b;font-weight:bold">FROM&lt;/span>&lt;span style="color:#cd5555"> {HARBOR_HOST}/BaseImage&lt;/span>&lt;span style="color:#a61717;background-color:#e3d2d2">
&lt;/span>&lt;span style="color:#a61717;background-color:#e3d2d2">&lt;/span>&lt;span style="color:#8b008b;font-weight:bold">ADD&lt;/span> ./build/libs/app.jar /app.jar&lt;span style="color:#a61717;background-color:#e3d2d2">
&lt;/span>&lt;span style="color:#a61717;background-color:#e3d2d2">&lt;/span>.... ÂÖ∂‰ªñÈÖçÁΩÆ&lt;span style="color:#a61717;background-color:#e3d2d2">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="4project-‰∏ãÊ∑ªÂä†-gradleproperties-Ê≥®ÊÑèÂú®-gitignore-ÈáåÈù¢Ê∑ªÂä†‰∏äÂÆÉ‰∏çË¶Å‰º†ÈÄíÂà∞ÂÖ¨ÂºÄÊúçÂä°Âô®ÊòØ‰Ω†ÁöÑÂØÜÁ†ÅÁ≠âÊïèÊÑü‰ø°ÊÅØ">4„ÄÅProject/ ‰∏ãÊ∑ªÂä† gradle.properties, Ê≥®ÊÑèÂú® .gitignore ÈáåÈù¢Ê∑ªÂä†‰∏äÂÆÉÔºå‰∏çË¶Å‰º†ÈÄíÂà∞ÂÖ¨ÂºÄÊúçÂä°Âô®ÔºåÊòØ‰Ω†ÁöÑÂØÜÁ†ÅÁ≠âÊïèÊÑü‰ø°ÊÅØ&lt;/h2>
&lt;pre>&lt;code class="language-properties" data-lang="properties"># Nexus ‰ªìÂ∫ìÂú∞ÂùÄ
NEXUS_URL=https://nexus-url
# ÊåáÂÆö‰∏∫‰Ω†Ëá™Â∑±ÁöÑmavenÁöÑÁî®Êà∑ÈÖçÁΩÆ settings.xml ÈáåÈù¢ÁöÑ‰Ω†ÁöÑÈÖçÁΩÆ
NEXUS_CAS_HEADER=XXXXXXX
# gradle daemon
org.gradle.daemon=true
# Á¶ÅÁî®Gradle 6.x ÁâàÊú¨ SHA-256ÂíåSHA-512Ê†°È™åÂíåÁöÑÂèëÂ∏É
# https://juejin.im/post/6844904101126553614
systemProp.org.gradle.internal.publish.checksums.insecure=true
&lt;/code>&lt;/pre>&lt;h2 id="5gitlab-ci-Ê®°ÊùøÂåñ‰∏ãÊ¨°ÂàÜ‰∫´">5„ÄÅgitlab-ci Ê®°ÊùøÂåñÔºå‰∏ãÊ¨°ÂàÜ‰∫´~~~~&lt;/h2>
- https://pinkhello.me/posts/08-gradle%E5%A4%9A%E6%A8%A1%E5%9D%97%E9%A1%B9%E7%9B%AE%E6%A8%A1%E6%9D%BF%E5%8C%96/ - PinkHello, All Rights Reserved</description></item><item><title>07 Fabric‰ΩøÁî®</title><link>https://pinkhello.me/posts/07-fabric%E4%BD%BF%E7%94%A8/</link><pubDate>Wed, 10 Feb 2021 08:40:46 +0800</pubDate><guid>https://pinkhello.me/posts/07-fabric%E4%BD%BF%E7%94%A8/</guid><description>PinkHello https://pinkhello.me/posts/07-fabric%E4%BD%BF%E7%94%A8/ -&lt;h2 id="docker-Âä†ÂÖ•systemctlÁéØÂ¢ÉÂπ∂ÂêØÂä®docker">docker Âä†ÂÖ•systemctlÁéØÂ¢ÉÂπ∂ÂêØÂä®docker&lt;/h2>
&lt;p>Âø´ÈÄüÂÆâË£Ödocker&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">curl -sSL https://get.daocloud.io/docker | sh
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">systemctl &lt;span style="color:#658b00">enable&lt;/span> docker
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">systemctl start docker
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="docker-compose-ÂÆâË£Ö">docker-compose ÂÆâË£Ö&lt;/h2>
&lt;p>Ëµ∞Â§ñÁΩëÊàñËÄÖ &lt;code>github&lt;/code> Â§™ÊÖ¢,ÂèØ‰ª•‰ΩøÁî®ÂÜÖÈÉ®Âä†ÈÄü&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash"> curl -L &lt;span style="color:#cd5555">&amp;#34;https://github.com/docker/compose/releases/download/X.XX.X/docker-compose-&lt;/span>&lt;span style="color:#8b008b;font-weight:bold">$(&lt;/span>uname -s&lt;span style="color:#8b008b;font-weight:bold">)&lt;/span>&lt;span style="color:#cd5555">-&lt;/span>&lt;span style="color:#8b008b;font-weight:bold">$(&lt;/span>uname -m&lt;span style="color:#8b008b;font-weight:bold">)&lt;/span>&lt;span style="color:#cd5555">&amp;#34;&lt;/span> -o /usr/local/bin/docker-compose
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash"> curl -L https://get.daocloud.io/docker/compose/releases/download/1.26.2/docker-compose-&lt;span style="color:#cd5555">`&lt;/span>uname -s&lt;span style="color:#cd5555">`&lt;/span>-&lt;span style="color:#cd5555">`&lt;/span>uname -m&lt;span style="color:#cd5555">`&lt;/span> &amp;gt; /usr/local/bin/docker-compose
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="fabric-Ëá™Âä®ËøêÁª¥">fabric Ëá™Âä®ËøêÁª¥&lt;/h2>
&lt;h3 id="python-ËôöÊãüÁéØÂ¢ÉÂÆâË£Ö">python ËôöÊãüÁéØÂ¢ÉÂÆâË£Ö&lt;/h3>
&lt;p>&lt;a href="https://www.liaoxuefeng.com/wiki/1016959663602400/1019273143120480">ÂèÇËÄÉ&lt;/a>&lt;/p>
&lt;p>ÂàõÂª∫‰∏Ä‰∏™Áã¨Á´ãÁöÑËôöÊãüÁéØÂ¢É&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#658b00">cd&lt;/span> ÁõÆÊ†áÁõÆÂΩï
virtualenv --no-site-packages venv
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÊøÄÊ¥ªËôöÊãüÁéØÂ¢É&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#658b00">source&lt;/span> venv/bin/activate
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="python-pip-ÂÆâË£Ö-fabric">python pip ÂÆâË£Ö Fabric&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">pip install fabric3
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="python-pip-ÂØºÂá∫‰æùËµñ">python pip ÂØºÂá∫‰æùËµñ&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">pip freeze &amp;gt; requirements.txt
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="ÂÖ∂‰ªñpython-pip-ÂØºÂÖ•ÂÆâË£Ö">ÂÖ∂‰ªñpython pip ÂØºÂÖ•ÂÆâË£Ö&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">pip install -r requirements.txt
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="fabric-ÊñáÊ°£-fabfiles-ÊñáÊ°£httpsfabric-chsreadthedocsiozh_cnchsusagefabfileshtml">&lt;a href="https://fabric-chs.readthedocs.io/zh_CN/chs/usage/fabfiles.html">Fabric ÊñáÊ°£ fabfiles ÊñáÊ°£&lt;/a>&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#228b22"># encoding=utf-8&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">from&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">fabric.api&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> *
&lt;span style="color:#8b008b;font-weight:bold">from&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">fabric.context_managers&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> *
env.user = &lt;span style="color:#cd5555">&amp;#39;root&amp;#39;&lt;/span>
env.gateway = &lt;span style="color:#cd5555">&amp;#39;192.168.1.118&amp;#39;&lt;/span>
env.hosts = [&lt;span style="color:#cd5555">&amp;#39;10.10.2.6&amp;#39;&lt;/span>,&lt;span style="color:#cd5555">&amp;#39;10.10.2.7&amp;#39;&lt;/span>]
env.passwords = {
&lt;span style="color:#cd5555">&amp;#39;root@10.10.2.6:22&amp;#39;&lt;/span>:&lt;span style="color:#cd5555">&amp;#39;PASSWORD_2&amp;#39;&lt;/span>,
&lt;span style="color:#cd5555">&amp;#39;root@10.10.2.7:22&amp;#39;&lt;/span>:&lt;span style="color:#cd5555">&amp;#39;PASSWORD_2&amp;#39;&lt;/span>,
&lt;span style="color:#cd5555">&amp;#39;root@192.168.1.118:22&amp;#39;&lt;/span>:&lt;span style="color:#cd5555">&amp;#39;PASSWORD_1&amp;#39;&lt;/span>
}
jump_server = &lt;span style="color:#cd5555">&amp;#39;jump_server&amp;#39;&lt;/span>
astra_server = &lt;span style="color:#cd5555">&amp;#39;astra_server&amp;#39;&lt;/span>
&lt;span style="color:#228b22"># ÊåáÂÆö role ËßíËâ≤ÁªÑ&lt;/span>
env.roledefs= {
jump_server: [&lt;span style="color:#cd5555">&amp;#39;192.168.1.118&amp;#39;&lt;/span>],
astra_server: [&lt;span style="color:#cd5555">&amp;#39;10.10.2.6&amp;#39;&lt;/span>,&lt;span style="color:#cd5555">&amp;#39;10.10.2.7&amp;#39;&lt;/span>]
}
&lt;span style="color:#228b22"># ÊµãËØï&lt;/span>
&lt;span style="color:#707a7c">@task&lt;/span>
&lt;span style="color:#707a7c">@roles&lt;/span>(jump_server)
&lt;span style="color:#8b008b;font-weight:bold">def&lt;/span> &lt;span style="color:#008b45">test&lt;/span>():
run(&lt;span style="color:#cd5555">&amp;#39;ls -la &amp;amp;&amp;amp; pwd&amp;#39;&lt;/span>)
&lt;span style="color:#228b22"># ÁôªÂΩïÁßÅÊúâ‰ªìÂ∫ì&lt;/span>
&lt;span style="color:#707a7c">@task&lt;/span>
&lt;span style="color:#707a7c">@roles&lt;/span>(astra_server)
&lt;span style="color:#8b008b;font-weight:bold">def&lt;/span> &lt;span style="color:#008b45">docker_login&lt;/span>():
run(&lt;span style="color:#cd5555">&amp;#39;docker login -u USERNAME -p PASSWORD docker-registery.xxx.com&amp;#39;&lt;/span>)
&lt;span style="color:#228b22"># ÊµãËØï&lt;/span>
&lt;span style="color:#707a7c">@task&lt;/span>
&lt;span style="color:#707a7c">@roles&lt;/span>(astra_server)
&lt;span style="color:#8b008b;font-weight:bold">def&lt;/span> &lt;span style="color:#008b45">docker_ps&lt;/span>():
run(&lt;span style="color:#cd5555">&amp;#39;docker ps&amp;#39;&lt;/span>)
&lt;span style="color:#228b22"># ‰∏ä‰º†docker-compose&lt;/span>
&lt;span style="color:#707a7c">@task&lt;/span>
&lt;span style="color:#707a7c">@roles&lt;/span>(astra_server)
&lt;span style="color:#8b008b;font-weight:bold">def&lt;/span> &lt;span style="color:#008b45">put_docker_compose&lt;/span>():
&lt;span style="color:#228b22"># ‰∏ä‰º†Â§±Ë¥•ÔºåÁÖßÊ†∑ÂæÄ‰∏ãÊâßË°å with settings(warn_only=True)&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">with&lt;/span> settings(warn_only=True):
result = put(&lt;span style="color:#cd5555">&amp;#39;deploy/prod/docker-compose.yml&amp;#39;&lt;/span>,&lt;span style="color:#cd5555">&amp;#39;~/docker-compose.yml&amp;#39;&lt;/span>)
&lt;span style="color:#8b008b;font-weight:bold">if&lt;/span> result.failed:
abort(&lt;span style="color:#cd5555">&amp;#39;Aborting file put task!&amp;#39;&lt;/span>)
&lt;span style="color:#228b22"># ÈáçÊñ∞docker-composeÈÉ®ÁΩ≤&lt;/span>
&lt;span style="color:#707a7c">@task&lt;/span>
&lt;span style="color:#707a7c">@roles&lt;/span>(astra_server)
&lt;span style="color:#8b008b;font-weight:bold">def&lt;/span> &lt;span style="color:#008b45">restart_docker_compose&lt;/span>():
run(&lt;span style="color:#cd5555">&amp;#39;docker-compose stop &amp;amp;&amp;amp; docker-compose up -d&amp;#39;&lt;/span>)
&lt;span style="color:#707a7c">@task&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">def&lt;/span> &lt;span style="color:#008b45">deploy&lt;/span>():
docker_login()
docker_ps()
put_docker_compose()
restart_docker_compose()
&lt;/code>&lt;/pre>&lt;/div>- https://pinkhello.me/posts/07-fabric%E4%BD%BF%E7%94%A8/ - PinkHello, All Rights Reserved</description></item><item><title>06 È´òÊÄßËÉΩÈòüÂàóDisruptor</title><link>https://pinkhello.me/posts/06-%E9%AB%98%E6%80%A7%E8%83%BD%E9%98%9F%E5%88%97disruptor/</link><pubDate>Wed, 10 Feb 2021 08:35:29 +0800</pubDate><guid>https://pinkhello.me/posts/06-%E9%AB%98%E6%80%A7%E8%83%BD%E9%98%9F%E5%88%97disruptor/</guid><description>PinkHello https://pinkhello.me/posts/06-%E9%AB%98%E6%80%A7%E8%83%BD%E9%98%9F%E5%88%97disruptor/ -&lt;h1 id="ËÉåÊôØ">ËÉåÊôØ&lt;/h1>
&lt;p>&lt;code>Disruptor&lt;/code> ÊòØ Â§ñÊ±á‰∫§ÊòìÂÖ¨Âè∏&lt;code>LMAX&lt;/code>ÂºÄÂèëÁöÑÈ´òÊÄßËÉΩÈòüÂàó„ÄÅÁ†îÂèëÊòØ‰∏∫‰∫ÜËß£ÂÜ≥ÂÜÖÂ≠òÈòüÂàóÂª∂ËøüÈóÆÈ¢ò„ÄÇ
&lt;code>Disruptor&lt;/code> ‰∏ÄËà¨Áî®‰∫éÁ∫øÁ®ãÈó¥ÁöÑÊ∂àÊÅØ‰º†ÈÄí„ÄÇ
&lt;a href="http://lmax-exchange.github.io/disruptor/">Disruptor GitHub Âú∞ÂùÄ&lt;/a>&lt;/p>
&lt;h1 id="disruptor-‰ªãÁªç">&lt;code>Disruptor&lt;/code> ‰ªãÁªç&lt;/h1>
&lt;p>ÁêÜËß£ &lt;code>Disruptor&lt;/code> ÊúÄÂ•ΩÁöÑÊñπÂºèÔºåÈÄâÊã©‰∏Ä‰∏™ÊúÄÊé•ËøëÁÜüÊÇâÁöÑÊ†∑Êú¨ËøõË°åÊØîËæÉ„ÄÇÂú®Ëøô‰∏™ÂâçÊèê‰∏ãÔºåÂèØ‰ª•ÈÄâÊã© &lt;code>Java&lt;/code> ‰∏≠ÁöÑ &lt;code>BlockingQueue&lt;/code>.
ÂíåÈòüÂàóÁõ∏‰ººÔºå&lt;code>Disruptor&lt;/code> ‰πüÊòØÂú®Âêå‰∏Ä‰∏™ËøõÁ®ã‰∏≠‰∏çÂêåÁöÑÁ∫øÁ®ã‰πãÈó¥ËøõË°å‰º†ÈÄíÊï∞ÊçÆÁöÑÔºà‰æãÂ¶ÇÊ∂àÊÅØÊàñËÄÖ‰∫ã‰ª∂ÔºâÔºåÂêåÊó∂ &lt;code>Disruptor&lt;/code> Êèê‰æõ‰∫Ü‰∏Ä‰∫õÂ∞ÜÂÖ≥ÈîÆÂäüËÉΩÂíåÈòüÂàóÂàÜÂºÄÁöÑÁâπÊÄßÔºö&lt;/p>
&lt;ul>
&lt;li>ÂêëÊ∂àË¥πËÄÖÂèëÈÄÅÂ§öÊí≠‰∫ã‰ª∂&lt;/li>
&lt;li>Ê∂àÊÅØËÄÖ‰æùËµñÂÖ≥Á≥ªÂõæ&lt;/li>
&lt;li>È¢ÑÂÖà‰∏∫‰∫ã‰ª∂ÂàÜÈÖçÂÜÖÂ≠ò&lt;/li>
&lt;li>ÂèØÈÄâÁöÑÔºàÊó†ÈîÅÔºâ&lt;/li>
&lt;/ul>
&lt;h1 id="disruptor-Ê†∏ÂøÉÊ¶ÇÂøµ">&lt;code>Disruptor&lt;/code> Ê†∏ÂøÉÊ¶ÇÂøµ&lt;/h1>
&lt;p>Âú®Êàë‰ª¨ÁêÜËß£&lt;code>Disruptor&lt;/code>Â¶Ç‰ΩïÂ∑•‰Ωú‰πãÂâçÔºå‰∫ÜËß£‰∏ãÊ†∏ÂøÉÊ¶ÇÂøµ&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/LMAX-Exchange/disruptor/blob/master/src/main/java/com/lmax/disruptor/RingBuffer.java">Ring Buffer&lt;/a>
ÁéØÂΩ¢Êï∞ÁªÑËÆæËÆ°Ôºå‰∏∫‰∫ÜÈÅøÂÖçÂûÉÂúæÂõûÊî∂ÔºåÈááÁî®ÁöÑÊï∞ÁªÑÁªìÊûÑÔºå‰ªé3.0ÂºÄÂßãÔºåÁéØÂΩ¢ÁºìÂÜ≤Âå∫‰∏ªË¶ÅÂ≠òÂÇ®ÂíåÊõ¥Êñ∞Âú®&lt;code>Disruptor&lt;/code>‰∏≠ÁßªÂä®ÁöÑÊï∞ÊçÆÔºà‰∫ã‰ª∂Ôºâ&lt;/li>
&lt;li>&lt;a href="https://github.com/LMAX-Exchange/disruptor/blob/master/src/main/java/com/lmax/disruptor/Sequence.java">Sequence&lt;/a>
&lt;code>Disruptor&lt;/code> ÊØè‰∏™Ê∂àË¥πËÄÖ(&lt;code>EventProcessor&lt;/code>)Áª¥Êä§‰∏Ä‰∏™ &lt;code>Sequence&lt;/code>ÔºåÂπ∂ÂèëÁöÑÂ§ßÂ§öÊï∞‰ª£Á†ÅÈÉΩ‰æùËµñ &lt;code>Sequence&lt;/code> ÂÄºÁöÑÊîπÂä®ÔºåÊâÄ‰ª• &lt;code>Sequence&lt;/code> ÊîØÊåÅ &lt;code>AtomicLong&lt;/code> ÁöÑÂ§ßÈÉ®ÂàÜ‰πüË°å, ÂîØ‰∏Ä‰∏çÂêåÁöÑÊòØ &lt;code>Sequence&lt;/code> ÂåÖÂê´È¢ùÂ§ñÁöÑÂäüËÉΩÊù•ÈòªÊ≠¢&lt;code>Sequence&lt;/code>ÂíåÂÖ∂‰ªñÂÄº‰πãÈó¥ÁöÑ‰º™ÂÖ±‰∫´(&lt;code>false sharing&lt;/code>)&lt;/li>
&lt;li>&lt;a href="https://github.com/LMAX-Exchange/disruptor/blob/master/src/main/java/com/lmax/disruptor/Sequencer.java">Sequencer&lt;/a>&lt;br>
&lt;code>Disruptor&lt;/code> Ê†∏ÂøÉÈÄªËæë, ‰∏§‰∏™ÂÆûÁé∞: ÂçïÁîü‰∫ßËÄÖÂíåÂ§öÁîü‰∫ßËÄÖ„ÄÇ‰ªñ‰ª¨ÂÆûÁé∞‰∫ÜÁîü‰∫ßËÄÖ‰∏éÊ∂àË¥πËÄÖ‰πãÈó¥ÁöÑÂø´ÈÄü‰º†ÈÄíÁöÑÂπ∂ÂèëÁÆóÊ≥ï„ÄÇ&lt;/li>
&lt;li>&lt;a href="https://github.com/LMAX-Exchange/disruptor/blob/master/src/main/java/com/lmax/disruptor/SequenceBarrier.java">Sequence Barrier&lt;/a>
Áî± &lt;code>Sequencer&lt;/code> ÁîüÊàêÔºåÂåÖÂê´Ê≠§ &lt;code>Sequencer&lt;/code> ÂèëÂ∏ÉÁöÑ &lt;code>Sequence&lt;/code> ÊåáÈíà‰ª•Âèä‰æùËµñÁöÑÂÖ∂‰ªñÊ∂àË¥πËÄÖÁöÑ &lt;code>Sequence&lt;/code>„ÄÇÂåÖÂê´‰∫ÜÊ∂àË¥πËÄÖÊ£ÄÊü•ÊòØÂê¶ÊúâÂèØÁî®ÁöÑ‰∫ã‰ª∂ÁöÑ‰ª£Á†Å„ÄÇ&lt;/li>
&lt;li>&lt;a href="https://github.com/LMAX-Exchange/disruptor/blob/master/src/main/java/com/lmax/disruptor/WaitStrategy.java">Wait Strategy&lt;/a>
Ê∂àË¥πËÄÖÁ≠âÂæÖ‰∫ã‰ª∂ÁöÑÁ≠ñÁï•ÔºåËøô‰∏™‰∫ã‰ª∂Áî±Áîü‰∫ßËÄÖÊîæÂÖ•ÔºåÂÜ≥ÂÆö‰∫ÜÊ∂àË¥πËÄÖÊÄé‰πàÁ≠âÂæÖÁîü‰∫ßËÄÖÂ∞Ü‰∫ã‰ª∂ÊîæÂÖ• &lt;code>Disruptor&lt;/code>&lt;/li>
&lt;li>Event Áîü‰∫ßËÄÖ‰∏éÊ∂àË¥πËÄÖ‰º†ÈÄíÁöÑ‰∫ã‰ª∂ÔºåÂÆåÂÖ®Áî±Áî®Êà∑ÂÆö‰πâ&lt;/li>
&lt;li>&lt;a href="https://github.com/LMAX-Exchange/disruptor/blob/master/src/main/java/com/lmax/disruptor/EventProcessor.java">EventProcessor&lt;/a>
Â§ÑÁêÜ‰∫ã‰ª∂ÁöÑ‰∏ªË¶ÅÂæ™ÁéØÔºà&lt;code>main event loop&lt;/code>ÔºâÔºåÂåÖÂê´‰∫Ü‰∏Ä‰∏™ &lt;code>Sequeuece&lt;/code>. Êúâ‰∏Ä‰∏™ÂÖ∑‰ΩìÁöÑÂÆûÁé∞Á±ª &lt;code>BatchEventProcessor&lt;/code>&lt;/li>
&lt;li>&lt;a href="https://github.com/LMAX-Exchange/disruptor/blob/master/src/main/java/com/lmax/disruptor/EventHandler.java">EventHandler&lt;/a>
Áî®Êà∑ÂÆûÁé∞ÁöÑÊé•Âè£Ôºå‰ª£Ë°®‰∏Ä‰∏™Ê∂àË¥πËÄÖ„ÄÇÂ§ÑÁêÜ‰∫ã‰ª∂„ÄÇ&lt;/li>
&lt;li>Producer Áîü‰∫ßËÄÖ„ÄÅÂÖàËé∑ÂæóÂç†‰ΩçÔºåÁÑ∂ÂêéÊèê‰∫§‰∫ã‰ª∂„ÄÇ&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://pinkhello.me/%E9%AB%98%E6%80%A7%E8%83%BD%E9%98%9F%E5%88%97-Disruptor/Disruptor%E8%AE%BE%E8%AE%A1%E7%BB%84%E4%BB%B6%E5%9B%BE.jpg" alt="DisruptorËÆæËÆ°ÁªÑ‰ª∂Âõæ">&lt;/p>
&lt;ul>
&lt;li>
&lt;p>‰∫ã‰ª∂ÂπøÊí≠(&lt;code>Multicast Events&lt;/code>)&lt;/p>
&lt;p>‰∫ã‰ª∂ÂπøÊí≠ÊòØ &lt;code>Disruptor&lt;/code> ‰∏é &lt;code>Queue&lt;/code> ÊúÄÂ§ßÁöÑÂå∫Âà´ÔºåÂΩì‰Ω†ÊúâÂ§ö‰∏™Ê∂àË¥πËÄÖÁõëÂê¨‰∏Ä‰∏™ &lt;code>Disruptor&lt;/code>, ÊâÄÊúâÁöÑ‰∫ã‰ª∂Â∞Ü‰ºöÂèëÂ∏ÉÂà∞Ëøô‰∏™ÊâÄÊúâÁöÑÊ∂àË¥πËÄÖ„ÄÇ
&lt;code>Disruptor&lt;/code> Ëøô‰∏ÄÁâπÊÄßË¢´Áî®Êù•ÈúÄË¶ÅÂØπÂêå‰∏ÄÊï∞ÊçÆËøõË°åÂ§ö‰∏™Âπ∂Ë°åÊìç‰ΩúÁöÑÊÉÖÂÜµ„ÄÇ
Â¶ÇÂú®LMAXÁ≥ªÁªü‰∏≠Êúâ‰∏â‰∏™Êìç‰ΩúÂèØ‰ª•ÂêåÊó∂ËøõË°åÔºöÊó•ÂøóÔºàÂ∞ÜÊï∞ÊçÆÊåÅ‰πÖÂà∞Êó•ÂøóÊñá‰ª∂‰∏≠ÔºâÔºåÂ§çÂà∂ÔºàÂ∞ÜÊï∞ÊçÆÂèëÈÄÅÂà∞ÂÖ∂‰ªñÁöÑÊú∫Âô®‰∏äÔºå‰ª•Á°Æ‰øùÂ≠òÂú®Êï∞ÊçÆËøúÁ®ãÂâØÊú¨ÔºâÔºå‰∏öÂä°ÈÄªËæëÂ§ÑÁêÜ„ÄÇ
‰πüÂèØ‰ª•‰ΩøÁî®&lt;code>WokrerPool&lt;/code>Êù•Âπ∂Ë°åÂ§ÑÁêÜ‰∏çÂêåÁöÑ‰∫ã‰ª∂„ÄÇ&lt;/p>
&lt;p>Â¶Ç‰∏äÂõæ„ÄÇÂèØ‰ª•ÁúãÂà∞Êúâ3‰∏™‰∫ã‰ª∂Â§ÑÁêÜÁ®ãÂ∫èÊ≠£Âú®‰æ¶Âê¨&lt;code>Disrupto&lt;/code>rÔºà&lt;code>JournalConsumer&lt;/code>Ôºå&lt;code>ReplicationConsumer&lt;/code> Âíå &lt;code>ApplicationConsumer&lt;/code>ÔºâÔºå
Ëøô‰∫õ‰∫ã‰ª∂Â§ÑÁêÜÁ®ãÂ∫è‰∏≠ÁöÑÊØè‰∏™Â∞ÜÊé•Êî∂&lt;code>Disruptor&lt;/code>‰∏≠ÊâÄÊúâÂèØÁî®ÁöÑÊ∂àÊÅØÔºàÊåâÁõ∏ÂêåÈ°∫Â∫èÔºâ„ÄÇËøôÂÖÅËÆ∏Ëøô‰∫õÊ∂àË¥πËÄÖ‰∏≠ÁöÑÊØè‰∏Ä‰∏™Âπ∂Ë°åÂ∑•‰Ωú„ÄÇ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Ê∂àË¥πËÄÖ‰æùËµñÂÖ≥Á≥ªÂõæ(&lt;code>Consumer Dependency Graph&lt;/code>)&lt;/p>
&lt;p>‰∏∫‰∫ÜÊîØÊåÅÂÆûÁé∞‰∏öÂä°Âπ∂Ë°åÂ§ÑÁêÜÊµÅÁ®ãÔºå&lt;code>Disruptor&lt;/code> Êèê‰æõ‰∫ÜÂ§ö‰∏™Ê∂àË¥πËÄÖ‰πãÈó¥ÁöÑÂçè‰ΩúÂäüËÉΩ„ÄÇÂõûÂà∞‰∏äÈù¢ÁöÑ‰æãÂ≠ê‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•Â∞Ü &lt;code>journalling&lt;/code> Âíå &lt;code>replication&lt;/code> Ê∂àË¥πÂÆåÊàê‰ªñ‰ª¨ÁöÑ‰∏öÂä°ÔºåÂêéÂÜçÁªßÁª≠ÊâßË°å‰∏öÂä°ÈÄªËæëÊµÅÁ®ã„ÄÇ
Êàë‰ª¨Áß∞ÂëºËøô‰∏™ÂäüËÉΩ‰∏∫ &lt;code>gating&lt;/code> , &lt;code>gating&lt;/code> ÂèëÁîüÂú®‰∏§ÁßçÂú∫ÊôØ‰∏ã:&lt;/p>
&lt;ul>
&lt;li>Á°Æ‰øù &lt;code>Producer&lt;/code> ‰∏çËÉΩËøêË°åË∂ÖËøá &lt;code>Consumer&lt;/code> ÔºåÂèØ‰ª•ÈÄöÂ§öË∞ÉÁî® &lt;code>RingBuffer.addGatingConsumers()&lt;/code> Êù•Â¢ûÂä†Áõ∏ÂÖ≥ÁöÑÊ∂àË¥πËÄÖÊù•ÂÆåÊàê&lt;/li>
&lt;li>‰πãÂâçÊâÄËØ¥ÁöÑÂú∫ÊôØÔºåÈÄöËøáÂøÖÈ°ªÂÖàÂÆåÊàêÁöÑ&lt;code>Consumer&lt;/code> ÁöÑ &lt;code>Sequence&lt;/code>ÁöÑ&lt;code>SequenceBarrier&lt;/code>Êù•ÂÆûÁé∞„ÄÇ&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>‰∫ã‰ª∂È¢ÑÂàÜÈÖç(&lt;code>Event Preallocation&lt;/code>)&lt;/p>
&lt;p>&lt;code>Disruptor&lt;/code> ÁöÑ‰∏Ä‰∏™ÁõÆÊ†áÂ∞±ÊòØÂú®‰ΩéÂª∂Êó∂ÁéØÂ¢É‰∏ãÔºåÂáèÂ∞ëÊàñÂºÇÂ∏∏ÂÜÖÂ≠òÁöÑÂç†Áî®„ÄÇÔºàÂú®JAVAÁéØÂ¢É‰∏ãÔºåÈúÄË¶ÅËæÉÂ∞ëGCÂÅúÈ°øÁöÑÊ¨°Êï∞ÔºâÔºàC/C++ÁéØÂ¢É‰∏ãÔºåÂ§ßÈáèÁöÑÂÜÖÂ≠òÂàÜÈÖç‰πüÊòØ‰∏Ä‰∏™ÈóÆÈ¢òÔºâ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ÂèØÈÄâÊã©ÁöÑÊó†ÈîÅ(&lt;code>Optionally Lock-free&lt;/code>)&lt;/p>
&lt;p>Êó†ÈîÅÁöÑ &lt;code>Disruptor&lt;/code> ÁöÑ‰ΩéÂª∂ËøüÁöÑÊó†ÈîÅÁöÑÁâπÊÄßÂÆûÁé∞ÁªÜËäÇÊòØÈÉΩÊòØÂü∫‰∫é ÂÜÖÂ≠òÂ±èÈöú Âíå CAS Êìç‰ΩúÂÆûÁé∞ÁöÑÔºåÂè™Êúâ‰∏Ä‰∏™Âú∫ÊôØ &lt;code>BlockingWaitStrategy&lt;/code> ‰∏≠‰ΩøÁî®ÁöÑ &lt;code>Lock&lt;/code>
ÊòØ‰∏∫‰∫Ü‰ΩøÁî® &lt;code>Lock&lt;/code> ÈáåÈù¢ÁöÑ &lt;code>Condition&lt;/code>, Êñπ‰æøÊ∂àË¥πËÄÖÁ∫øÁ®ãË¢´ &lt;code>Park&lt;/code> Êó∂ÂÄôÁ≠âÂæÖÊñ∞ÁöÑ‰∫ã‰ª∂Êù•Ëß¶Âèë„ÄÇËÆ∏Â§ö‰ΩéÂª∂ËøüÁ≥ªÁªü‰ΩøÁî®Ëá™ÊóãÔºà&lt;code>busy-wait&lt;/code>ÔºâÊù•ÈÅøÂÖç‰ΩøÁî® &lt;code>Condition&lt;/code>ÈÄ†ÊàêÁöÑÊäñÂä®
ÁÑ∂ËÄåÔºåÂ§™Â§öÁöÑ &lt;code>busy-wait&lt;/code> ‰ºöÂØºËá¥ÊÄßËÉΩ‰∏ãÈôçÔºåÁâπÂà´Âú®CPUËµÑÊ∫êÂèóÈôêÁöÑÊÉÖÂÜµ‰∏ã„ÄÇ&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h1 id="disruptor-Âá†‰∏™Ê†∏ÂøÉÁöÑËÆæËÆ°">&lt;code>Disruptor&lt;/code> Âá†‰∏™Ê†∏ÂøÉÁöÑËÆæËÆ°&lt;/h1>
&lt;h2 id="sequence-ËÆæËÆ°">&lt;code>Sequence&lt;/code> ËÆæËÆ°&lt;/h2>
&lt;p>&lt;img src="https://pinkhello.me/%E9%AB%98%E6%80%A7%E8%83%BD%E9%98%9F%E5%88%97-Disruptor/Sequence.jpg" alt="Sequence ËÆæËÆ°">&lt;/p>
&lt;p>Sequence ÁúüÊ≠£ËÆ°Êï∞ÊòØ &lt;code>value&lt;/code> ÈááÁî®ÁºìÂÜ≤Ë°åÈò≤Ê≠¢ &lt;code>false sharing&lt;/code>„ÄÇÂú®&lt;code>value&lt;/code>ÁöÑÂâçÂêéÊúâ7‰∏™ &lt;code>long&lt;/code> ÂûãÁöÑÂ°´ÂÖÖÂÄºÔºåÂÅö&lt;code>CPU cache line&lt;/code>Â°´ÂÖÖÈò≤Ê≠¢‰º™ÂÖ±‰∫´„ÄÇ&lt;/p>
&lt;h2 id="ringbuffer-ËÆæËÆ°">&lt;code>RingBuffer&lt;/code> ËÆæËÆ°&lt;/h2>
&lt;p>&lt;img src="https://pinkhello.me/%E9%AB%98%E6%80%A7%E8%83%BD%E9%98%9F%E5%88%97-Disruptor/RingBuffer.jpg" alt="RingBuffer ËÆæËÆ°">&lt;/p>
&lt;p>&lt;code>RingBuffer&lt;/code> ÊòØ‰∏Ä‰∏™ÁéØÔºàÈ¶ñÂ∞æÁõ∏Êé•ÔºâÔºåÂèØ‰ª•Áî®‰Ωú‰∏çÂêåÁöÑ‰∏ä‰∏ãÊñáÔºàÁ∫øÁ®ãÔºâÈó¥‰º†ÈÄíÊï∞ÊçÆÁöÑ &lt;code>Buffer&lt;/code>ÁéØÂΩ¢ËÆæËÆ°ÔºåÊØè‰∏™ÂÖÉÁ¥†ÈÉΩÊúâ‰∏™ÂùêÊ†áÔºåÂèñÂæóÂÖÉÁ¥†ÈÄöËøáÂèñmodÊìç‰Ωú„ÄÇ
ÊòØÊï∞ÁªÑËÆæËÆ°„ÄÅÈùûÈìæË°®„ÄÇ&lt;/p>
&lt;p>‰∏ÄËà¨ÊòØ&lt;code>2^N&lt;/code>Ê¨°ÊñπÔºåËøôÊ†∑ sequence &amp;amp; (array length - 1 ) = array index„ÄÇÂìàÂ∏åMap‰πüÊòØËøôÁßç‰ΩçËøêÁÆóÂÅöÁöÑ„ÄÇ&lt;/p>
&lt;p>&lt;code>RingBuffer&lt;/code> ÁâπÁÇπ&lt;/p>
&lt;ul>
&lt;li>Êï∞ÁªÑÂÆûÁé∞„ÄÅÂø´ÈÄüËÆøÈóÆ&lt;/li>
&lt;li>ÂÖÉÁ¥†ÊòØË¶ÜÁõñÂºèÁöÑÔºå‰∏ç‰∏ªÂä®Ê∏ÖÈô§&lt;/li>
&lt;li>Á•ûÂ•áÁöÑÁºìÂ≠òË°åÔºàÁºìÂ≠òÊòØÁî±ÁºìÂ≠òË°åÁªÑÊàêÁöÑÔºåÈÄöÂ∏∏64‰∏™Â≠óËäÇ„ÄÅ‰∏Ä‰∏™JAVA long Á±ªÂûã 8 Â≠óËäÇÔºâ&lt;/li>
&lt;/ul>
&lt;h2 id="Ê∂àË¥πËÄÖ‰æùËµñËÆæËÆ°">Ê∂àË¥πËÄÖ‰æùËµñËÆæËÆ°&lt;/h2>
&lt;h2 id="ÁºìÂ≠òÂÜÖÂ≠òÂä†ËΩΩËøáÁ®ã">ÁºìÂ≠òÂÜÖÂ≠òÂä†ËΩΩËøáÁ®ã&lt;/h2>
&lt;p>&lt;img src="https://pinkhello.me/%E9%AB%98%E6%80%A7%E8%83%BD%E9%98%9F%E5%88%97-Disruptor/cache-line-1.jpg" alt="ÁºìÂ≠òÂä†ËΩΩËøáÁ®ã">
&lt;img src="https://pinkhello.me/%E9%AB%98%E6%80%A7%E8%83%BD%E9%98%9F%E5%88%97-Disruptor/cache-line-2.jpg" alt="ÁºìÂ≠òÂä†ËΩΩËøáÁ®ã">
&lt;img src="https://pinkhello.me/%E9%AB%98%E6%80%A7%E8%83%BD%E9%98%9F%E5%88%97-Disruptor/cache-line-3.jpg" alt="ÁºìÂ≠òÂä†ËΩΩËøáÁ®ã">&lt;/p>
&lt;p>&lt;a href="https://github.com/LMAX-Exchange/disruptor/blob/master/src/main/java/com/lmax/disruptor/RingBuffer.java">Á•ûÂ•áÁöÑËß£ÂÜ≥ÊñπÂºè&amp;mdash;&amp;ndash; ÁºìÂ≠òË°åÂ°´ÂÖÖ&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#00688b;font-weight:bold">long&lt;/span> p1, p2, p3, p4, p5, p6, p7; &lt;span style="color:#228b22">// cache line padding
&lt;/span>&lt;span style="color:#228b22">&lt;/span>&lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">volatile&lt;/span> &lt;span style="color:#00688b;font-weight:bold">long&lt;/span> cursor = INITIAL_CURSOR_VALUE;
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#00688b;font-weight:bold">long&lt;/span> p8, p9, p10, p11, p12, p13, p14; &lt;span style="color:#228b22">// cache line padding
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="disruptor-‰ΩøÁî®demo">&lt;code>Disruptor&lt;/code> ‰ΩøÁî®Demo&lt;/h1>
&lt;p>&lt;code>TransactionOrder&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">class&lt;/span> &lt;span style="color:#008b45;font-weight:bold">TransactionOrder&lt;/span> {
&lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> String id;
&lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> &lt;span style="color:#00688b;font-weight:bold">double&lt;/span> price;
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>TransactionHandler&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">class&lt;/span> &lt;span style="color:#008b45;font-weight:bold">TransactionHandler&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">implements&lt;/span> EventHandler&amp;lt;TransactionOrder&amp;gt;, WorkHandler&amp;lt;TransactionOrder&amp;gt; {
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">onEvent&lt;/span>(TransactionOrder transactionOrder, &lt;span style="color:#00688b;font-weight:bold">long&lt;/span> sequence, &lt;span style="color:#00688b;font-weight:bold">boolean&lt;/span> endOfBatch) &lt;span style="color:#8b008b;font-weight:bold">throws&lt;/span> Exception {
&lt;span style="color:#8b008b;font-weight:bold">this&lt;/span>.&lt;span style="color:#658b00">onEvent&lt;/span>(transactionOrder);
}
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">onEvent&lt;/span>(TransactionOrder transactionOrder) &lt;span style="color:#8b008b;font-weight:bold">throws&lt;/span> Exception {
&lt;span style="color:#228b22">//ÂÖ∑‰ΩìÁöÑÊ∂àË¥πÈÄªËæë
&lt;/span>&lt;span style="color:#228b22">&lt;/span> transactionOrder.&lt;span style="color:#658b00">setId&lt;/span>(UUID.&lt;span style="color:#658b00">randomUUID&lt;/span>().&lt;span style="color:#658b00">toString&lt;/span>());
}
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>Demo1&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">class&lt;/span> &lt;span style="color:#008b45;font-weight:bold">Demo1&lt;/span> {
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">main&lt;/span>(String[] args) &lt;span style="color:#8b008b;font-weight:bold">throws&lt;/span> ExecutionException, InterruptedException {
&lt;span style="color:#00688b;font-weight:bold">int&lt;/span> BUFFER_SIZE = 1024;
&lt;span style="color:#00688b;font-weight:bold">int&lt;/span> THREAD_NUM = 4;
&lt;span style="color:#228b22">//createSingleProducer ÂàõÂª∫ÂçïÁîü‰∫ßËÄÖÁöÑ RingBuffer
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">final&lt;/span> RingBuffer&amp;lt;TransactionOrder&amp;gt; ringBuffer =
RingBuffer.&lt;span style="color:#658b00">createSingleProducer&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> EventFactory&amp;lt;TransactionOrder&amp;gt;() {
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> TransactionOrder &lt;span style="color:#008b45">newInstance&lt;/span>() {
&lt;span style="color:#8b008b;font-weight:bold">return&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> TransactionOrder();
}
}, BUFFER_SIZE, &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> YieldingWaitStrategy());
&lt;span style="color:#228b22">//ÂàõÂª∫Á∫øÁ®ãÊ±†
&lt;/span>&lt;span style="color:#228b22">&lt;/span> ExecutorService service = Executors.&lt;span style="color:#658b00">newFixedThreadPool&lt;/span>(THREAD_NUM);
&lt;span style="color:#228b22">//ÂàõÂª∫ SequenceBarrier
&lt;/span>&lt;span style="color:#228b22">&lt;/span> SequenceBarrier sequenceBarrier = ringBuffer.&lt;span style="color:#658b00">newBarrier&lt;/span>();
&lt;span style="color:#228b22">//ÂàõÂª∫Ê∂àÊÅØÂ§ÑÁêÜÂô®
&lt;/span>&lt;span style="color:#228b22">&lt;/span> BatchEventProcessor&amp;lt;TransactionOrder&amp;gt; eventProcessor =
&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> BatchEventProcessor&amp;lt;TransactionOrder&amp;gt;(ringBuffer, sequenceBarrier, &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> TransactionHandler());
&lt;span style="color:#228b22">//Ëøô‰∏ÄÈÉ®ÂàÜÊòØËÆ© RingBufferÊ†πÊçÆÊ∂àË¥πËÄÖÁä∂ÊÄÅËøõË°ågating, Âè™Êúâ‰∏Ä‰∏™Ê∂àË¥πËÄÖÁöÑËØùÂèØ‰ª•ÁúÅÁï•
&lt;/span>&lt;span style="color:#228b22">&lt;/span> ringBuffer.&lt;span style="color:#658b00">addGatingSequences&lt;/span>(eventProcessor.&lt;span style="color:#658b00">getSequence&lt;/span>());
&lt;span style="color:#228b22">//ÊääÊ∂àÊÅØÂ§ÑÁêÜÂô®Êèê‰∫§Âà∞Á∫øÁ®ãÊ±†
&lt;/span>&lt;span style="color:#228b22">&lt;/span> service.&lt;span style="color:#658b00">submit&lt;/span>(eventProcessor);
Future&amp;lt;?&amp;gt; future = service.&lt;span style="color:#658b00">submit&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> Callable&amp;lt;Void&amp;gt;() {
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> Void &lt;span style="color:#008b45">call&lt;/span>() &lt;span style="color:#8b008b;font-weight:bold">throws&lt;/span> Exception {
&lt;span style="color:#00688b;font-weight:bold">long&lt;/span> seq;
&lt;span style="color:#8b008b;font-weight:bold">for&lt;/span> (&lt;span style="color:#00688b;font-weight:bold">int&lt;/span> i = 0; i&amp;lt;10000; i++) {
seq = ringBuffer.&lt;span style="color:#658b00">next&lt;/span>(); &lt;span style="color:#228b22">//ringbuffer ÁöÑ‰∏Ä‰∏™ÂèØÁî®Âå∫Âùó
&lt;/span>&lt;span style="color:#228b22">&lt;/span> ringBuffer.&lt;span style="color:#658b00">get&lt;/span>(seq).&lt;span style="color:#658b00">setPrice&lt;/span>(Math.&lt;span style="color:#658b00">random&lt;/span>() *9999); &lt;span style="color:#228b22">// ÁªôËøô‰∏™Âå∫ÂùóÊîæÂÖ•Êï∞ÊçÆ
&lt;/span>&lt;span style="color:#228b22">&lt;/span> ringBuffer.&lt;span style="color:#658b00">publish&lt;/span>(seq); &lt;span style="color:#228b22">//ÂèëÂ∏ÉÊï∞ÊçÆ‰ΩøÂæó consumer ÂèØ‰ª•Ëé∑ÂèñËØ•Êï∞ÊçÆ
&lt;/span>&lt;span style="color:#228b22">&lt;/span> }
&lt;span style="color:#8b008b;font-weight:bold">return&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">null&lt;/span>;
}
});
future.&lt;span style="color:#658b00">get&lt;/span>(); &lt;span style="color:#228b22">//Á≠âÂæÖÁîü‰∫ßËÄÖÁªìÊùü
&lt;/span>&lt;span style="color:#228b22">&lt;/span>
eventProcessor.&lt;span style="color:#658b00">halt&lt;/span>(); &lt;span style="color:#228b22">//ÈÄöÁü•‰∫ã‰ª∂
&lt;/span>&lt;span style="color:#228b22">&lt;/span>
service.&lt;span style="color:#658b00">shutdown&lt;/span>(); &lt;span style="color:#228b22">//ÁªàÊ≠¢Á∫øÁ®ã
&lt;/span>&lt;span style="color:#228b22">&lt;/span>
}
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>Demo2&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">class&lt;/span> &lt;span style="color:#008b45;font-weight:bold">Demo2&lt;/span> {
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">main&lt;/span>(String[] args) {
&lt;span style="color:#00688b;font-weight:bold">int&lt;/span> BUFFER_SIZE = 1024;
&lt;span style="color:#00688b;font-weight:bold">int&lt;/span> THREAD_NUM = 4;
EventFactory&amp;lt;TransactionOrder&amp;gt; eventFactory = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> EventFactory&amp;lt;TransactionOrder&amp;gt;() {
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> TransactionOrder &lt;span style="color:#008b45">newInstance&lt;/span>() {
&lt;span style="color:#8b008b;font-weight:bold">return&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> TransactionOrder();
}
};
RingBuffer&amp;lt;TransactionOrder&amp;gt; ringBuffer = RingBuffer.&lt;span style="color:#658b00">createSingleProducer&lt;/span>(eventFactory, BUFFER_SIZE);
SequenceBarrier sequenceBarrier = ringBuffer.&lt;span style="color:#658b00">newBarrier&lt;/span>();
ExecutorService service = Executors.&lt;span style="color:#658b00">newFixedThreadPool&lt;/span>(THREAD_NUM);
WorkHandler&amp;lt;TransactionOrder&amp;gt; workHandler = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> TransactionHandler();
WorkerPool&amp;lt;TransactionOrder&amp;gt; workerPool =
&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> WorkerPool&amp;lt;TransactionOrder&amp;gt;(ringBuffer, sequenceBarrier, &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> IgnoreExceptionHandler(),
workHandler);
&lt;span style="color:#228b22">//Â∫èÂàóÂçèË∞ÉËÄÖ
&lt;/span>&lt;span style="color:#228b22">&lt;/span> ringBuffer.&lt;span style="color:#658b00">addGatingSequences&lt;/span>(workerPool.&lt;span style="color:#658b00">getWorkerSequences&lt;/span>());
workerPool.&lt;span style="color:#658b00">start&lt;/span>(service);
&lt;span style="color:#8b008b;font-weight:bold">for&lt;/span> (&lt;span style="color:#00688b;font-weight:bold">int&lt;/span> i=0; i&amp;lt;8; i++) {
&lt;span style="color:#00688b;font-weight:bold">long&lt;/span> seq = ringBuffer.&lt;span style="color:#658b00">next&lt;/span>();
ringBuffer.&lt;span style="color:#658b00">get&lt;/span>(seq).&lt;span style="color:#658b00">setPrice&lt;/span>(Math.&lt;span style="color:#658b00">random&lt;/span>() * 9999);
ringBuffer.&lt;span style="color:#658b00">publish&lt;/span>(seq);
}
workerPool.&lt;span style="color:#658b00">halt&lt;/span>();
service.&lt;span style="color:#658b00">shutdown&lt;/span>();
}
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>Demo3&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">class&lt;/span> &lt;span style="color:#008b45;font-weight:bold">Demo3&lt;/span> {
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">main&lt;/span>(String[] args) &lt;span style="color:#8b008b;font-weight:bold">throws&lt;/span> InterruptedException {
&lt;span style="color:#00688b;font-weight:bold">long&lt;/span> start = System.&lt;span style="color:#658b00">currentTimeMillis&lt;/span>();
&lt;span style="color:#00688b;font-weight:bold">int&lt;/span> BUFFER_SIZE = 1024;
&lt;span style="color:#00688b;font-weight:bold">int&lt;/span> THREAD_NUM = 4;
ExecutorService service = Executors.&lt;span style="color:#658b00">newFixedThreadPool&lt;/span>(THREAD_NUM);
Disruptor&amp;lt;TransactionOrder&amp;gt; disruptor = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> Disruptor&amp;lt;TransactionOrder&amp;gt;(&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> EventFactory&amp;lt;TransactionOrder&amp;gt;() {
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> TransactionOrder &lt;span style="color:#008b45">newInstance&lt;/span>() {
&lt;span style="color:#8b008b;font-weight:bold">return&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> TransactionOrder();
}
}, BUFFER_SIZE, service, ProducerType.&lt;span style="color:#658b00">SINGLE&lt;/span>, &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> BusySpinWaitStrategy());
&lt;span style="color:#228b22">/**
&lt;/span>&lt;span style="color:#228b22"> * Ëè±ÂΩ¢Êìç‰Ωú
&lt;/span>&lt;span style="color:#228b22"> */&lt;/span>
&lt;span style="color:#228b22">//‰ΩøÁî® disruptor ÂàõÂª∫Ê∂àË¥πÁªÑ C1 ‰∏é C2
&lt;/span>&lt;span style="color:#228b22">&lt;/span> EventHandlerGroup&amp;lt;TransactionOrder&amp;gt; eventHandlerGroup =
disruptor.&lt;span style="color:#658b00">handleEventsWith&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> TransactionHandler(), &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> TransactionVasConsumer());
&lt;span style="color:#228b22">//C3
&lt;/span>&lt;span style="color:#228b22">&lt;/span> TransactionJmsNotifyHandler jmsNotifyHandler = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> TransactionJmsNotifyHandler();
&lt;span style="color:#228b22">//Â£∞ÊòéÂú® C1 Âíå C2 ÂÆå‰∫ãÂêé ÊâßË°å JMSÊ∂àÊÅØÂèëÈÄÅÊìç‰ΩúÔºàC3Ôºâ
&lt;/span>&lt;span style="color:#228b22">&lt;/span> eventHandlerGroup.&lt;span style="color:#658b00">then&lt;/span>(jmsNotifyHandler);
&lt;span style="color:#228b22">/**
&lt;/span>&lt;span style="color:#228b22"> * È°∫Â∫èÊâßË°å
&lt;/span>&lt;span style="color:#228b22"> */&lt;/span>
&lt;span style="color:#228b22">// disruptor.handleEventsWith(new TransactionHandler())
&lt;/span>&lt;span style="color:#228b22">// .then(new TransactionVasConsumer())
&lt;/span>&lt;span style="color:#228b22">// .then(new TransactionJmsNotifyHandler());
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#228b22">/**
&lt;/span>&lt;span style="color:#228b22"> * ÂÖ≠ËæπÂΩ¢Êìç‰Ωú
&lt;/span>&lt;span style="color:#228b22"> */&lt;/span>
&lt;span style="color:#228b22">// TransactionHandler h1 = new TransactionHandler();
&lt;/span>&lt;span style="color:#228b22">// TransactionHandler h2 = new TransactionHandler();
&lt;/span>&lt;span style="color:#228b22">// TransactionHandler h3 = new TransactionHandler();
&lt;/span>&lt;span style="color:#228b22">// TransactionHandler h4 = new TransactionHandler();
&lt;/span>&lt;span style="color:#228b22">// TransactionHandler h5 = new TransactionHandler();
&lt;/span>&lt;span style="color:#228b22">// TransactionHandler h6 = new TransactionHandler();
&lt;/span>&lt;span style="color:#228b22">// disruptor.handleEventsWith(h1, h2);
&lt;/span>&lt;span style="color:#228b22">// disruptor.after(h1).handleEventsWith(h4);
&lt;/span>&lt;span style="color:#228b22">// disruptor.after(h2).handleEventsWith(h5);
&lt;/span>&lt;span style="color:#228b22">// disruptor.after(h4, h5).handleEventsWith(h3);
&lt;/span>&lt;span style="color:#228b22">&lt;/span>
&lt;span style="color:#228b22">//ÂêØÂä®
&lt;/span>&lt;span style="color:#228b22">&lt;/span> disruptor.&lt;span style="color:#658b00">start&lt;/span>();
CountDownLatch latch = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> CountDownLatch(1);
&lt;span style="color:#228b22">//Áîü‰∫ßËÄÖÂáÜÂ§á
&lt;/span>&lt;span style="color:#228b22">&lt;/span> service.&lt;span style="color:#658b00">submit&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> TransactionPubllisher(disruptor, latch));
latch.&lt;span style="color:#658b00">await&lt;/span>(); &lt;span style="color:#228b22">//Á≠âÂæÖÁîü‰∫ßËÄÖÂÆå‰∫ã
&lt;/span>&lt;span style="color:#228b22">&lt;/span>
disruptor.&lt;span style="color:#658b00">shutdown&lt;/span>();
service.&lt;span style="color:#658b00">shutdown&lt;/span>();
System.&lt;span style="color:#658b00">out&lt;/span>.&lt;span style="color:#658b00">println&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;ÊÄªËÄóÊó∂:&amp;#34;&lt;/span>+ (System.&lt;span style="color:#658b00">currentTimeMillis&lt;/span>() - start));
}
}
&lt;/code>&lt;/pre>&lt;/div>- https://pinkhello.me/posts/06-%E9%AB%98%E6%80%A7%E8%83%BD%E9%98%9F%E5%88%97disruptor/ - PinkHello, All Rights Reserved</description></item><item><title>05 OAuth2.0 ÈÇ£ÁÇπ‰∫ã</title><link>https://pinkhello.me/posts/05-oauth2.0%E9%82%A3%E7%82%B9%E4%BA%8B/</link><pubDate>Wed, 10 Feb 2021 08:32:02 +0800</pubDate><guid>https://pinkhello.me/posts/05-oauth2.0%E9%82%A3%E7%82%B9%E4%BA%8B/</guid><description>PinkHello https://pinkhello.me/posts/05-oauth2.0%E9%82%A3%E7%82%B9%E4%BA%8B/ -&lt;h2 id="oauth20-ÊòØ‰ªÄ‰πà">&lt;code>OAuth2.0&lt;/code> ÊòØ‰ªÄ‰πà?&lt;/h2>
&lt;p>&lt;code>OAuth2.0&lt;/code> Framework RFC 6749 [https://tools.ietf.org/html/rfc6749]&lt;/p>
&lt;p>&lt;code>OAuth&lt;/code> Â∞±ÊòØ‰∏ÄÁßçÊéàÊùÉÊú∫Âà∂ÔºåÂÆÉ‰ªã‰∫éÂÆ¢Êà∑Á´Ø‰∏éËµÑÊ∫êÊâÄÊúâËÄÖÁöÑÊéàÊùÉÂ±ÇÔºå‰∏∫‰∫ÜÂàÜÁ¶ª‰∏çÂêåÁöÑËßíËâ≤„ÄÇ
Âú®ËµÑÊ∫êÊâÄÊúâËÄÖÂêåÊÑèÂπ∂ÂêëÂÆ¢Êà∑Á´ØÈ¢ÅÂèë‰ª§ÁâåÂêéÔºåÂÆ¢Êà∑Á´ØÊê∫Â∏¶‰ª§ÁâåÂèØ‰ª•ËÆøÈóÆÈÉ®ÂàÜÊàñÂÖ®ÈÉ®ËµÑÊ∫ê„ÄÇ&lt;/p>
&lt;p>&lt;!-- raw HTML omitted -->OAuth2.0&lt;!-- raw HTML omitted --> ÊòØ&lt;!-- raw HTML omitted -->OAuth&lt;!-- raw HTML omitted --> ÂçèËÆÆÁöÑ‰∏Ä‰∏™ÁâàÊú¨Ôºå‰∏∫&lt;!-- raw HTML omitted -->2.0&lt;!-- raw HTML omitted -->ÁâàÊú¨„ÄÇÊúâÊÑèÊÄùÁöÑÊòØ &lt;!-- raw HTML omitted -->2.0&lt;!-- raw HTML omitted --> ‰∏é &lt;!-- raw HTML omitted -->1.0&lt;!-- raw HTML omitted --> Âπ∂‰∏çÂÖºÂÆπ„ÄÇ&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;!-- raw HTML omitted -->
&lt;h2 id="oauth20-ÊéàÊùÉÊñπÂºè">&lt;code>OAuth2.0&lt;/code> ÊéàÊùÉÊñπÂºè&lt;/h2>
&lt;p>Ëé∑ÂèñÊéàÊùÉÁöÑËøáÁ®ã&lt;/p>
&lt;ul>
&lt;li>ÊéàÊùÉÁ†Å(&lt;!-- raw HTML omitted -->authorization-code&lt;!-- raw HTML omitted -->)&lt;/li>
&lt;li>ÈöêËóèÂºè(&lt;!-- raw HTML omitted -->implicit&lt;!-- raw HTML omitted -->)&lt;/li>
&lt;li>ÂØÜÁ†Å(&lt;!-- raw HTML omitted -->password&lt;!-- raw HTML omitted -->)&lt;/li>
&lt;li>ÂÆ¢Êà∑Á´ØÂá≠ËØÅ(&lt;!-- raw HTML omitted -->client credentials&lt;!-- raw HTML omitted -->)&lt;/li>
&lt;/ul>
&lt;p>‰∏çÁÆ°Âì™ÁßçÊñπÂºèÔºåÈÉΩÈúÄË¶ÅÂú®Á¨¨‰∏âÊñπÂ∫îÁî®Áî≥ËØ∑‰ª§Áâå‰πãÂâçÔºåÈúÄË¶ÅÂú®Á≥ªÁªü‰∏≠Áî≥ËØ∑Ë∫´‰ªΩÂîØ‰∏ÄÊ†áËØÜ: ÂÆ¢Êà∑Á´ØID &lt;!-- raw HTML omitted -->Client ID&lt;!-- raw HTML omitted --> Âíå ÂÆ¢Êà∑Á´ØÁßòÈí• &lt;!-- raw HTML omitted -->Client Secret&lt;!-- raw HTML omitted -->.
ËøôÊ†∑ËÉΩÁ°Æ‰øùToken‰∏çË¢´ÊÅ∂ÊÑè‰ΩøÁî®„ÄÇ&lt;/p>
&lt;p>ÊéàÊùÉÈáçË¶ÅÁöÑÂèÇÊï∞ÂíåÊåáÊ†á:&lt;/p>
&lt;ul>
&lt;li>&lt;!-- raw HTML omitted -->response_type&lt;!-- raw HTML omitted --> ÂìçÂ∫îÁ±ªÂûã: &lt;!-- raw HTML omitted -->code&lt;!-- raw HTML omitted -->(Ë¶ÅÊ±ÇËøîÂõûÊéàÊùÉÁ†Å),&lt;!-- raw HTML omitted -->token&lt;!-- raw HTML omitted -->(Ë¶ÅÊ±ÇËøîÂõûÊéàÊùÉToken)&lt;/li>
&lt;li>&lt;!-- raw HTML omitted -->client_id&lt;!-- raw HTML omitted --> ÂÆ¢Êà∑Á´ØË∫´‰ªΩÊ†áËØÜ&lt;/li>
&lt;li>&lt;!-- raw HTML omitted -->client_secret&lt;!-- raw HTML omitted --> ÂÆ¢Êà∑Á´ØÁßòÈí•&lt;/li>
&lt;li>&lt;!-- raw HTML omitted -->redirect_uri&lt;!-- raw HTML omitted --> ÈáçÂÆöÂêëÂú∞ÂùÄ&lt;/li>
&lt;li>&lt;!-- raw HTML omitted -->scope&lt;!-- raw HTML omitted --> ÊéàÊùÉËåÉÂõ¥, &lt;!-- raw HTML omitted -->read&lt;!-- raw HTML omitted --> Âè™ËØªÊùÉÈôê, &lt;!-- raw HTML omitted -->all&lt;!-- raw HTML omitted --> ÂÖ®ÈÉ®ÊùÉÈôê&lt;/li>
&lt;li>&lt;!-- raw HTML omitted -->grant_type&lt;!-- raw HTML omitted --> ÊéàÊùÉÊñπÂºè &lt;!-- raw HTML omitted -->authorization_code&lt;!-- raw HTML omitted -->(ÊéàÊùÉÁ†Å)„ÄÅ&lt;!-- raw HTML omitted -->password&lt;!-- raw HTML omitted -->(ÂØÜÁ†Å)„ÄÅ&lt;!-- raw HTML omitted -->client_credentials&lt;!-- raw HTML omitted -->
(Âá≠ËØÅ)„ÄÅ&lt;!-- raw HTML omitted -->refresh_token&lt;!-- raw HTML omitted -->(Êõ¥Êñ∞‰ª§Áâå)&lt;/li>
&lt;li>&lt;!-- raw HTML omitted -->state&lt;!-- raw HTML omitted --> Â∫îÁî®Á®ãÂ∫è‰º†ÈÄíÁöÑ‰∏Ä‰∏™ÈöèÊú∫Êï∞ÔºåÈò≤Ê≠¢ &lt;!-- raw HTML omitted -->CSRF&lt;!-- raw HTML omitted --> ÊîªÂáª&lt;/li>
&lt;/ul>
&lt;h3 id="ÊéàÊùÉÁ†Åhttpswwwoauthcomoauth2-serversaccess-tokensauthorization-code-request-authorization-code-request">&lt;a href="https://www.oauth.com/oauth2-servers/access-tokens/authorization-code-request/" title="authorization-code-request">ÊéàÊùÉÁ†Å&lt;/a>&lt;/h3>
&lt;p>Âú®ËÆøÈóÆÁ¨¨‰∏âÊñπÂ∫îÁî®ÂÖàÁî≥ËØ∑‰∏Ä‰∏™ÊéàÊùÉÁ†ÅÔºåÁÑ∂ÂêéÂÜçÁî®ÊéàÊùÉÁ†ÅËé∑Âèñ‰ª§Áâå.ËøôÁßçÊñπÂºè‰πüÊòØÊúÄÂ∏∏Áî®ÁöÑÊµÅÁ®ãÔºåÂÆâÂÖ®ÊÄß‰πüÊòØÊúÄÈ´òÁöÑÔºåÈÄÇÁî®‰∫éÊúâÂêéÁ´ØÁöÑ&lt;!-- raw HTML omitted -->Web&lt;!-- raw HTML omitted -->Â∫îÁî®„ÄÇÊéàÊùÉÁ†ÅÈÄöËøáÂâçÁ´Ø‰º†ÈÄÅÔºå‰ª§ÁâåÂ≠òÂÇ®Âú®ÂêéÁ´Ø„ÄÇÊâÄÊúâÁöÑÂíåËµÑÊ∫êÊúçÂä°Âô®ÁöÑ‰∫§‰∫íÈÉΩÂú®ÊúçÂä°Á´ØÂÆåÊàêÔºåÈÅøÂÖç‰∫Ü‰ª§ÁâåÁöÑÊ≥ÑÈú≤„ÄÇ
ÊéàÊùÉÁ†ÅÂíå‰ª§ÁâåÁöÑÂú® ÊµèËßàÂô®ÂíåÂÆ¢Êà∑Á´Ø&lt;!-- raw HTML omitted -->WEB&lt;!-- raw HTML omitted -->Â∫îÁî®‰ª•ÂèäËµÑÊ∫êÊúçÂä°Âô®ÁöÑ‰∫§‰∫íÊµÅÁ®ãÂ§ßËá¥Â¶Ç‰∏ã:
&lt;img src="https://pinkhello.me/OAuth2-0%E9%82%A3%E7%82%B9%E4%BA%8B/auth_code.png" alt="authorization-code">&lt;/p>
&lt;ul>
&lt;li>1.2.3.4 Áî®Êà∑ÈÄâÊã© &lt;!-- raw HTML omitted -->Google&lt;!-- raw HTML omitted --> ÁôªÈôÜ &lt;!-- raw HTML omitted -->yelp.com&lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>3.4 &lt;!-- raw HTML omitted -->Yelp.com&lt;!-- raw HTML omitted --> ËØ∑Ê±ÇÁî®Êà∑ÊéàÊùÉ &lt;!-- raw HTML omitted -->Google&lt;!-- raw HTML omitted --> ÊùÉÈôê&lt;/li>
&lt;li>5.6 Áî®Êà∑ÂêåÊÑèÂêéËøîÂõûÊéàÊùÉÁ†Å
&lt;!-- raw HTML omitted -->
&lt;!-- raw HTML omitted -->
&lt;/li>
&lt;li>7.8 &lt;!-- raw HTML omitted -->Yelp.com&lt;!-- raw HTML omitted --> ÈÄöËøáÊéàÊùÉÁ†Å ‰ºöÂêë &lt;!-- raw HTML omitted -->Google&lt;!-- raw HTML omitted -->ÂèëËµ∑ËØ∑Ê±Ç&lt;!-- raw HTML omitted -->Token&lt;!-- raw HTML omitted -->
&lt;!-- raw HTML omitted -->
&lt;!-- raw HTML omitted -->
&lt;/li>
&lt;li>9 È™åËØÅÂøÖË¶ÅÂèÇÊï∞ÔºåËøîÂõû &lt;!-- raw HTML omitted -->Token&lt;!-- raw HTML omitted -->&lt;/li>
&lt;li>10.11 Êìç‰ΩúËØ∑Ê±Ç&lt;/li>
&lt;/ul>
&lt;h3 id="ÈöêËóèÂºèhttpsauth0comblogoauth2-implicit-grant-and-spa-oauth2-implicit-grant-and-spa">&lt;a href="https://auth0.com/blog/oauth2-implicit-grant-and-spa/" title="oauth2-implicit-grant-and-spa">ÈöêËóèÂºè&lt;/a>&lt;/h3>
&lt;p>&lt;img src="https://pinkhello.me/OAuth2-0%E9%82%A3%E7%82%B9%E4%BA%8B/implicit.png" alt="implicit">&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;!-- raw HTML omitted -->
&lt;h3 id="ÂØÜÁ†ÅÂºèhttpswwwoauthcomoauth2-serversaccess-tokenspassword-grant-password-grant">&lt;a href="https://www.oauth.com/oauth2-servers/access-tokens/password-grant/" title="password-grant">ÂØÜÁ†ÅÂºè&lt;/a>&lt;/h3>
&lt;p>È°æÂêçÊÄùËÆÆ,Âú®Ëá™Â∑±ÁöÑÁ≥ªÁªüËæìÂÖ•Á¨¨‰∏âÊñπÁ≥ªÁªüÁöÑË¥¶Âè∑ÂØÜÁ†Å,Ëá™Â∑±ÁöÑÁ≥ªÁªüÊãøË¥¶Âè∑ÂØÜÁ†ÅÂéªÁî≥ËØ∑‰ª§ÁâåÔºåÂìçÂ∫îÈ¢òÈáåÈù¢ËøîÂõûtoken&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;!-- raw HTML omitted -->
&lt;h3 id="Âá≠ËØÅÂºèhttpswwwoauthcomoauth2-serversaccess-tokensclient-credentials-client-credentials">&lt;a href="https://www.oauth.com/oauth2-servers/access-tokens/client-credentials/" title="client-credentials">Âá≠ËØÅÂºè&lt;/a>&lt;/h3>
&lt;p>Âá≠ËØÅÂºèÂíåÂØÜÁ†ÅÂæàÁõ∏‰ººÔºå‰∏ªË¶ÅÁªôÊ≤°ÊúâÂâçÁ´ØËæìÂÖ•ÁöÑÈ°πÁõÆÊàñËÄÖÂëΩ‰ª§Ë°å&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;!-- raw HTML omitted -->
&lt;h2 id="‰ª§ÁâåÁöÑ‰ΩøÁî®ÂíåÊõ¥Êñ∞">‰ª§ÁâåÁöÑ‰ΩøÁî®ÂíåÊõ¥Êñ∞&lt;/h2>
&lt;h3 id="‰ª§ÁâåÁöÑ‰ΩøÁî®">&lt;a href="">‰ª§ÁâåÁöÑ‰ΩøÁî®&lt;/a>&lt;/h3>
&lt;p>‰ª§ÁâåÁöÑÊãøÂà∞‰∫ÜÔºåÂ∞±ÂèØ‰ª•Ë∞ÉÁî®GoogleÁöÑAPIËøõË°åËØ∑Ê±ÇÊï∞ÊçÆ‰∫ÜÔºå
‰∏ÄËà¨ËÆ≤ Token ÊîæÂÖ•ËØ∑Ê±ÇÂ§¥ Authorization.&lt;/p>
&lt;h3 id="‰ª§ÁâåÁöÑÊõ¥Êñ∞httpswwwoauthcomoauth2-serversaccess-tokensrefreshing-access-tokens-refreshing-access-tokens">&lt;a href="https://www.oauth.com/oauth2-servers/access-tokens/refreshing-access-tokens/" title="refreshing-access-tokens">‰ª§ÁâåÁöÑÊõ¥Êñ∞&lt;/a>&lt;/h3>
&lt;p>&lt;!-- raw HTML omitted -->Token&lt;!-- raw HTML omitted --> ÊòØÊúâÊó∂ÊïàÊÄßÁöÑÔºå‰∏ÄÊó¶ËøáÊúüÂ∞±ÈúÄË¶ÅÈáçÊñ∞Ëé∑ÂèñÔºå‰ΩÜÊòØÈáçËµ∞‰∏ÄÈÅçÊéàÊùÉÊµÅÁ®ãÔºå‰∏ç‰ªÖÈ∫ªÁÉ¶ËÄå‰∏îÁî®Êà∑‰ΩìÈ™å‰πü‰∏çÂ•ΩÔºåÈÇ£Â¶Ç‰ΩïËÆ©Áî®Êà∑‰ΩøÁî®ÁöÑ‰ºòÈõÖÂë¢Ôºü&lt;/p>
&lt;p>‰∏ÄËà¨Âú®È¢ÅÂèë‰ª§ÁâåÁöÑÊó∂ÂÄôÔºåÈ¢ÅÂèë‰∏§‰∏™&lt;!-- raw HTML omitted -->Token&lt;!-- raw HTML omitted -->, ‰∏Ä‰∏™ÊéàÊùÉ&lt;!-- raw HTML omitted -->Token&lt;!-- raw HTML omitted -->,‰∏Ä‰∏™&lt;!-- raw HTML omitted -->Refresh Token&lt;!-- raw HTML omitted -->,
Âú®Êõ¥Êñ∞&lt;!-- raw HTML omitted -->refresh_token&lt;!-- raw HTML omitted -->Êó∂ÂÄô,Â∞Ü&lt;!-- raw HTML omitted -->grant_type&lt;!-- raw HTML omitted -->ÊåáÂÆö‰∏∫&lt;!-- raw HTML omitted -->refresh_token&lt;!-- raw HTML omitted -->,
ÂèÇÊï∞&lt;!-- raw HTML omitted -->refresh_token&lt;!-- raw HTML omitted -->ÊòØÁî®‰∫éÊõ¥Êñ∞&lt;!-- raw HTML omitted -->Token&lt;!-- raw HTML omitted -->ÁöÑ&lt;!-- raw HTML omitted -->refresh_token&lt;!-- raw HTML omitted -->&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;!-- raw HTML omitted -->
&lt;h1 id="ÊÄªÁªì">ÊÄªÁªì&lt;/h1>
&lt;h1 id="ÂÆâÂà©">ÂÆâÂà©&lt;/h1>
&lt;ul>
&lt;li>Client
&lt;ul>
&lt;li>Go &lt;a href="https://godoc.org/golang.org/x/oauth2">https://godoc.org/golang.org/x/oauth2&lt;/a>&lt;/li>
&lt;li>Java
&lt;ul>
&lt;li>&lt;a href="https://spring.io/projects/spring-social/">https://spring.io/projects/spring-social/&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://spring.io/projects/spring-security/">https://spring.io/projects/spring-security/&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Server
&lt;ul>
&lt;li>Go
&lt;ul>
&lt;li>&lt;a href="https://github.com/go-oauth2/oauth2">https://github.com/go-oauth2/oauth2&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/zalando/gin-oauth2">https://github.com/zalando/gin-oauth2&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Java &lt;a href="https://github.com/zalando/tokens">https://github.com/zalando/tokens&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>ÂèÇËÄÉ&lt;/p>
&lt;ul>
&lt;li>jsonwebtoken.io &lt;a href="https://www.jsonwebtoken.io/">https://www.jsonwebtoken.io/&lt;/a>&lt;/li>
&lt;li>oauth.net &lt;a href="https://oauth.net/2/">https://oauth.net/2/&lt;/a>&lt;/li>
&lt;li>aliyun.com
&lt;ul>
&lt;li>&lt;a href="https://help.aliyun.com/document_detail/32144.html?spm=5176.87240.400427.53.32fa4614S88B0N">https://help.aliyun.com/document_detail/32144.html?spm=5176.87240.400427.53.32fa4614S88B0N&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://help.aliyun.com/document_detail/32008.html?spm=a2c4g.11186623.6.780.40435837SXpbPT">https://help.aliyun.com/document_detail/32008.html?spm=a2c4g.11186623.6.780.40435837SXpbPT&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://help.aliyun.com/document_detail/32026.html?spm=a2c4g.11186623.6.856.20b1c06dgVW6Ri">https://help.aliyun.com/document_detail/32026.html?spm=a2c4g.11186623.6.856.20b1c06dgVW6Ri&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
- https://pinkhello.me/posts/05-oauth2.0%E9%82%A3%E7%82%B9%E4%BA%8B/ - PinkHello, All Rights Reserved</description></item><item><title>04 Â¶Ç‰ΩïÊûÑÂª∫‰∏Ä‰∏™ÁÆÄÂçïÁöÑRPCË∞ÉÁî®</title><link>https://pinkhello.me/posts/04-%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84rpc%E8%B0%83%E7%94%A8/</link><pubDate>Wed, 10 Feb 2021 08:24:19 +0800</pubDate><guid>https://pinkhello.me/posts/04-%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84rpc%E8%B0%83%E7%94%A8/</guid><description>PinkHello https://pinkhello.me/posts/04-%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84rpc%E8%B0%83%E7%94%A8/ -&lt;p>1„ÄÅ‰ªÄ‰πàÂè´RPC?&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;!-- raw HTML omitted -->
&lt;p>&lt;img src="https://pinkhello.me/%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BARPC%E8%B0%83%E7%94%A8/RPC%E8%B0%83%E7%94%A8%E6%9C%8D%E5%8A%A1%E8%BF%87%E7%A8%8B.jpg" alt="RPCË∞ÉÁî®ÊúçÂä°ËøáÁ®ã">&lt;/p>
&lt;p>RPCÊûÑÊàê&lt;/p>
&lt;ul>
&lt;li>RPC Consumer&lt;/li>
&lt;li>RPC Provider&lt;/li>
&lt;li>ConfigServer&lt;/li>
&lt;/ul>
&lt;ul>
&lt;li>1„ÄÅ&lt;code>Provider&lt;/code> ÂêØÂä® &lt;code>ConfigServer&lt;/code> Ê≥®ÂÜåÊúçÂä°&lt;/li>
&lt;li>2„ÄÅ&lt;code>Consumer&lt;/code> ÂêØÂä® &lt;code>ConfigServer&lt;/code> ËÆ¢ÈòÖÊúçÂä°Ôºå&lt;/li>
&lt;li>3„ÄÅÂèëËµ∑Ë∞ÉÁî® &lt;code>Consumer&lt;/code> &amp;mdash;&amp;gt; &lt;code>Provider&lt;/code>&lt;/li>
&lt;li>4„ÄÅÂìçÂ∫îË∞ÉÁî® &lt;code>Consumer&lt;/code> &amp;lt;&amp;mdash; &lt;code>Provider&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>2„ÄÅ‰ªÄ‰πàÊòØ &lt;code>Netty&lt;/code> ? &lt;a href="https://netty.io/">https://netty.io/&lt;/a>&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;!-- raw HTML omitted -->
&lt;p>&lt;img src="https://pinkhello.me/%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BARPC%E8%B0%83%E7%94%A8/netty%E6%A1%86%E6%9E%B6%E5%9B%BE.png" alt="nettyÊ°ÜÊû∂Âõæ">&lt;/p>
&lt;p>3„ÄÅÁé∞ÊúâÁöÑÂºÄÊ∫êÁöÑÈ°πÁõÆÊòØÂê¶‰ΩøÁî®‰∫Ü &lt;code>Netty&lt;/code> ?&lt;/p>
&lt;ul>
&lt;li>Dubbo&lt;/li>
&lt;li>Grpc&lt;/li>
&lt;li>Spark&lt;/li>
&lt;li>&amp;hellip;.&lt;/li>
&lt;/ul>
&lt;p>4„ÄÅ&lt;code>RPC Provider&lt;/code> ÂêØÂä®&lt;/p>
&lt;ul>
&lt;li>&lt;code>Netty Server&lt;/code> ÊñπÂºèÂêØÂä®&lt;/li>
&lt;li>&lt;code>Rpc&lt;/code> ÊúçÂä°ÁöÑÊ≥®ÂÜå
&lt;img src="https://pinkhello.me/%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BARPC%E8%B0%83%E7%94%A8/RPC%E4%B8%8ENetty%E7%BB%93%E5%90%88Provider%E8%B0%83%E7%94%A8%E8%BF%87%E7%A8%8B.png" alt="RPC‰∏éNettyÁªìÂêàProviderË∞ÉÁî®ËøáÁ®ã">&lt;/li>
&lt;/ul>
&lt;p>5„ÄÅ&lt;code>RPC Consumer&lt;/code> ÂêØÂä®&lt;/p>
&lt;ul>
&lt;li>&lt;code>Netty Client&lt;/code> ÊñπÂºèÂêØÂä®&lt;/li>
&lt;li>&lt;code>RPC&lt;/code> Ê≥õÂåñË∞ÉÁî®„ÄÅÈÄöËøáÂ≠óËäÇÁ†ÅÂü∫‰∫éÂèçÂ∞ÑÊù•ÂÆûÁé∞ËøúÁ®ãË∞ÉÂ∫¶&lt;/li>
&lt;li>&lt;code>Consumer&lt;/code> ÊúçÂä°ËÆ¢ÈòÖ&lt;/li>
&lt;li>ÂêØÂä®Êó∂Âª∫Á´ãÈïøËøûÊé•
&lt;img src="https://pinkhello.me/%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BARPC%E8%B0%83%E7%94%A8/RPC%E4%B8%8ENetty%E7%BB%93%E5%90%88Consumer%E8%B0%83%E7%94%A8%E8%BF%87%E7%A8%8B.png" alt="RPC‰∏éNettyÁªìÂêàConsumerË∞ÉÁî®ËøáÁ®ã">&lt;/li>
&lt;/ul>
&lt;p>6„ÄÅ‰ªéÁ¨¨ÂõõÂèØ‰ª•ÁúãÂá∫ÔºåÂ§ö‰∏™ &lt;code>Provider&lt;/code> ÊòØÁî±‰∏Ä‰∏™ &lt;code>NettyServer&lt;/code> Êèê‰æõÁöÑÔºåÈÄöËøá &lt;code>HandlerMap&lt;/code> Êò†Â∞ÑÊâæÂà∞ÂØπÂ∫îÁöÑ &lt;code>Ioc Bean&lt;/code>ÔºåÂÆåÊàêÊúçÂä°Ë∞ÉÁî®&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">ÊúçÂä°Á´Ø
EventLoopGroup bossGroup = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> NioEventLoopGroup(1);
EventLoopGroup workerGroup = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> NioEventLoopGroup();
&lt;span style="color:#8b008b;font-weight:bold">try&lt;/span> {
ServerBootstrap b = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> ServerBootstrap();
b.&lt;span style="color:#658b00">group&lt;/span>(bossGroup, workerGroup)
.&lt;span style="color:#658b00">channel&lt;/span>(NioServerSocketChannel.&lt;span style="color:#658b00">class&lt;/span>)
.&lt;span style="color:#658b00">option&lt;/span>(ChannelOption.&lt;span style="color:#658b00">SO_BACKLOG&lt;/span>, 100)
.&lt;span style="color:#658b00">handler&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> LoggingHandler(LogLevel.&lt;span style="color:#658b00">INFO&lt;/span>))
.&lt;span style="color:#658b00">childHandler&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> ChannelInitializer&amp;lt;SocketChannel&amp;gt;() {
&lt;span style="color:#707a7c">@Override&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">initChannel&lt;/span>(SocketChannel ch) &lt;span style="color:#8b008b;font-weight:bold">throws&lt;/span> Exception {
ChannelPipeline p = ch.&lt;span style="color:#658b00">pipeline&lt;/span>();
p.&lt;span style="color:#658b00">addLast&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> RpcEncoder(RpcRequest.&lt;span style="color:#658b00">class&lt;/span>));
p.&lt;span style="color:#658b00">addLast&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> RpcDecoder(RpcResponse.&lt;span style="color:#658b00">class&lt;/span>));
p.&lt;span style="color:#658b00">addLast&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> RpcHandler());
}});
&lt;span style="color:#228b22">// Start the server.
&lt;/span>&lt;span style="color:#228b22">&lt;/span> ChannelFuture f = b.&lt;span style="color:#658b00">bind&lt;/span>(PORT).&lt;span style="color:#658b00">sync&lt;/span>();
&lt;span style="color:#228b22">// Wait until the server socket is closed.
&lt;/span>&lt;span style="color:#228b22">&lt;/span> f.&lt;span style="color:#658b00">channel&lt;/span>().&lt;span style="color:#658b00">closeFuture&lt;/span>().&lt;span style="color:#658b00">sync&lt;/span>();
} &lt;span style="color:#8b008b;font-weight:bold">finally&lt;/span> {
&lt;span style="color:#228b22">// Shut down all event loops to terminate all threads.
&lt;/span>&lt;span style="color:#228b22">&lt;/span> bossGroup.&lt;span style="color:#658b00">shutdownGracefully&lt;/span>();
workerGroup.&lt;span style="color:#658b00">shutdownGracefully&lt;/span>();
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://pinkhello.me/%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BARPC%E8%B0%83%E7%94%A8/Netty%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86%E5%AE%A2%E6%88%B7%E7%AB%AFTCP%E9%93%BE%E6%8E%A5%E4%B8%8A%E7%9A%84%E8%AF%B7%E6%B1%82.jpg" alt="NettyÂ¶Ç‰ΩïÂ§ÑÁêÜÂÆ¢Êà∑Á´ØTCPÈìæÊé•‰∏äÁöÑËØ∑Ê±Ç">&lt;/p>
&lt;p>&lt;img src="https://pinkhello.me/%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BARPC%E8%B0%83%E7%94%A8/NettyReactor%E5%B7%A5%E4%BD%9C%E6%A1%86%E6%9E%B6%E5%9B%BE.jpg" alt="NettyReactorÂ∑•‰ΩúÊ°ÜÊû∂Âõæ">&lt;/p>
&lt;ul>
&lt;li>&lt;code>BossGroup&lt;/code> -&amp;gt; Â§ÑÁêÜÂÆ¢Êà∑Á´ØÁöÑËØ∑Ê±Ç&lt;/li>
&lt;li>&lt;code>EventGroup&lt;/code> ‚Äî&amp;gt; Â§ÑÁêÜIO &lt;code>Read/Write&lt;/code> Êìç‰Ωú„ÄÅÊâßË°å‰ªªÂä°Á≥ªÁªüTask„ÄÅÂÆöÊó∂‰ªªÂä°&lt;/li>
&lt;li>&lt;code>ChildChannelHandler&lt;/code> ÊñπÂºèÊòØÂØπ &lt;code>ChannelPipeline&lt;/code> ÁöÑËÆæÁΩÆ„ÄÅ&lt;/li>
&lt;li>&lt;code>ChannelPipeline&lt;/code> ÊòØÁõ∏ÂΩì‰∫é‰ªªÂä°ÈìæÁöÑÊ®°Âºè, ÊòØ‰∏Ä‰∏≤ &lt;code>ChannelHandler&lt;/code> ÁöÑÂÆû‰æã&lt;/li>
&lt;li>&lt;code>ChannelHandlerContext&lt;/code> ÊòØ &lt;code>ChannelPipeline&lt;/code> Âíå &lt;code>ChannelHandler&lt;/code> ÁöÑÂÖ≥Á≥ª&lt;/li>
&lt;li>ÊØè‰∏™ÈìæÊé•ÂØπ‰∫é &lt;code>Sever&lt;/code> Á´ØÈÉΩ‰ºöÂàõÂª∫‰∏Ä‰∏™ &lt;code>Channel&lt;/code> ÔºåÂèØ‰ª•Â∞Ü &lt;code>Channel&lt;/code> ÁêÜËß£‰∏∫ &lt;code>Connection&lt;/code> ÔºàÂÖ∂ÂÆûÁúüÊ≠£ÁöÑÊòØ &lt;code>Connection&lt;/code> Â±û‰∫é &lt;code>Channel&lt;/code> ÁöÑ‰∏ÄÈÉ®ÂàÜÔºâ&lt;/li>
&lt;li>ÊØè‰∏™ &lt;code>Channel&lt;/code> ÈÉΩÊúâ‰∏Ä‰∏™Ëá™Â∑±ÁöÑÂîØ‰∏ÄÁöÑ &lt;code>ChannelPipeline&lt;/code> Êìç‰ΩúÔºåÂØπ‰∫éÂÖ∂‰ªñÁöÑ &lt;code>Channel&lt;/code> ÁöÑ &lt;code>ChannelPipeline&lt;/code> ÊòØÈöîÁ¶ªÁöÑ&lt;/li>
&lt;li>&lt;code>RPC Handler&lt;/code> ÊòØÊàë‰ª¨ÂØπ‰∫éËá™Â∑±ÁöÑÊâæÂØª &lt;code>RPC&lt;/code> ÊúçÂä°Â§ÑÁêÜÁöÑ &lt;code>Handler&lt;/code> ÂÆûÁé∞&lt;/li>
&lt;li>&lt;code>RPC Encoder&lt;/code> ÊòØÊàë‰ª¨ÂØπ‰∫éËá™Â∑±ÁöÑÊâæÂØª &lt;code>RPC&lt;/code> Â∫èÂàóÂåñÁöÑÁºñÁ†ÅÁöÑ &lt;code>Handler&lt;/code> ÂÆûÁé∞&lt;/li>
&lt;li>&lt;code>RPC Decoder&lt;/code> ÊòØÊàë‰ª¨ÂØπ‰∫éËá™Â∑±ÁöÑÊâæÂØª &lt;code>RPC&lt;/code> Â∫èÂàóÂåñÁöÑËß£Á†ÅÁöÑ &lt;code>Handler&lt;/code> ÂÆûÁé∞&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">ÂÆ¢Êà∑Á´Ø
EventLoopGroup group = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> NioEventLoopGroup();
&lt;span style="color:#8b008b;font-weight:bold">try&lt;/span> {
Bootstrap b = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> Bootstrap();
b.&lt;span style="color:#658b00">group&lt;/span>(group)
.&lt;span style="color:#658b00">channel&lt;/span>(NioSocketChannel.&lt;span style="color:#658b00">class&lt;/span>)
.&lt;span style="color:#658b00">option&lt;/span>(ChannelOption.&lt;span style="color:#658b00">TCP_NODELAY&lt;/span>, &lt;span style="color:#8b008b;font-weight:bold">true&lt;/span>)
.&lt;span style="color:#658b00">handler&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> ChannelInitializer&amp;lt;SocketChannel&amp;gt;() {
&lt;span style="color:#707a7c">@Override&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">initChannel&lt;/span>(SocketChannel ch) &lt;span style="color:#8b008b;font-weight:bold">throws&lt;/span> Exception {
ChannelPipeline p = ch.&lt;span style="color:#658b00">pipeline&lt;/span>();
p.&lt;span style="color:#658b00">addLast&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> RpcEncoder(RpcResponse.&lt;span style="color:#658b00">class&lt;/span>));
p.&lt;span style="color:#658b00">addLast&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> RpcDecoder(RpcRequest.&lt;span style="color:#658b00">class&lt;/span>));
p.&lt;span style="color:#658b00">addLast&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> RpcClientHandler());
}});
&lt;span style="color:#228b22">// Start the client.
&lt;/span>&lt;span style="color:#228b22">&lt;/span> ChannelFuture f = b.&lt;span style="color:#658b00">connect&lt;/span>(HOST, PORT).&lt;span style="color:#658b00">sync&lt;/span>();
&lt;span style="color:#228b22">// Wait until the connection is closed.
&lt;/span>&lt;span style="color:#228b22">&lt;/span> f.&lt;span style="color:#658b00">channel&lt;/span>().&lt;span style="color:#658b00">closeFuture&lt;/span>().&lt;span style="color:#658b00">sync&lt;/span>();
} &lt;span style="color:#8b008b;font-weight:bold">finally&lt;/span> {
&lt;span style="color:#228b22">// Shut down the event loop to terminate all threads.
&lt;/span>&lt;span style="color:#228b22">&lt;/span> group.&lt;span style="color:#658b00">shutdownGracefully&lt;/span>();
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>7„ÄÅ&lt;code>RPC&lt;/code> Â∫èÂàóÂåñ&lt;/p>
&lt;ul>
&lt;li>‰∫åËøõÂà∂Êï∞ÊçÆ&lt;/li>
&lt;li>Hessian&lt;/li>
&lt;li>Avro&lt;/li>
&lt;li>ProtoBuffer (Protobuf)&lt;/li>
&lt;li>JSON&lt;/li>
&lt;li>XML&lt;/li>
&lt;/ul>
&lt;p>8„ÄÅÂÖ≥‰∫é &lt;code>RPC&lt;/code> ÁöÑÂÆûÁé∞ÊÄùËÄÉ‰∏éÊäÄÊúØËÆ®ËÆ∫&lt;/p>
&lt;ul>
&lt;li>‰∏öÂä°ÊñπÊ≥ï„ÄÅÂõ†‰∏∫ÊòØÊî∂Âà∞ËØ∑Ê±ÇÊ∂àÊÅØËÄåËß¶ÂèëÁöÑÂêéÁª≠Âä®‰ΩúË∞ÉÁî®Ôºå‰∏çÂÅöÈ¢ùÂ§ñËÆæÁΩÆÔºåËÇØÂÆöÊòØ‰ΩøÁî®ÁöÑ &lt;code>WorkGroup&lt;/code> ÈáåÈù¢ÁöÑÁ∫øÁ®ãÊìç‰ΩúÁöÑ„ÄÇ
ËÄå‰Ωú‰∏∫‰∏öÂä°Â±ÇÔºå‰∏çÂ∫îËØ•‰∏éÂ∫ïÂ±ÇÂÖ≥ËÅîÔºåÂ∫îËØ•ÂàáÂâ≤ÂºÄÊù•ÔºåÂäøÂøÖ‰ºöÂºïÂÖ•ÁúüÁöÑ‰∏öÂä°‰æßÁ∫øÁ®ãÊ±†„ÄÇ
ÈÇ£‰πàÂ¶Ç‰ΩïÂºïÁî®„ÄÅÊÄé‰πàÂºïÁî®Ôºü(ÂÖ≥‰∫é ‰∏öÂä°Á∫øÁ®ãÊ±† ‰∏é &lt;code>WorkGroup&lt;/code> ÁöÑ &lt;code>EvenLoop&lt;/code> ÁöÑÊÄùËÄÉ )&lt;/li>
&lt;li>ÂÖ≥‰∫é &lt;code>RPC&lt;/code> Ë∞ÉÁî®Â§ßÈÉ®ÂàÜÊòØÂêåÊ≠•ÁöÑË∞ÉÁî®ÔºåËÄå &lt;code>Netty&lt;/code> Â∫ïÂ±ÇÊòØÂÆåÂÖ®ÂºÇÊ≠•‰∫ã‰ª∂Êú∫Âà∂ÔºåÂú®RPCÊ°ÜÊû∂Â±ÇÈù¢Â¶Ç‰ΩïÂÆûÁé∞ÂêåÊ≠•ÁöÑË∞ÉÁî®ÊñπÂºèÁöÑÔºü&lt;/li>
&lt;li>Âü∫‰∫é &lt;code>TCP&lt;/code> ÁöÑÈïøÈìæÊé•Ë∞ÉÁî®ÔºåÂú® &lt;code>RPC&lt;/code> ‰∏ä‰Ω†‰ºöÊÉ≥Âà∞ÂÖ∂‰ªñÁöÑÂì™‰∫õ‰∏ú‰∏úÔºü&lt;/li>
&lt;li>Âú®Ê≠§ÁéØÂ¢É‰∏ãÔºåÊàëÊ≤°Êúâ‰ªãÁªç &lt;code>RPC&lt;/code> ÊúçÂä°‰∫é IOCÂÆπÂô®ÁöÑÁªìÂêàÔºåÂèØ‰ª•ÊÄùËÄÉ‰∏Ä‰∏ãÔºåÂ¶Ç‰ΩïÂÅöÂà∞ Ê≥®Ëß£Êú∫Âà∂„ÄÅ&lt;code>JAVA CONFIG&lt;/code> Êú∫Âà∂„ÄÅ&lt;code>XML SCHEMA&lt;/code> Êú∫Âà∂Êù•ÂÅö?
&lt;ul>
&lt;li>GUICE&lt;/li>
&lt;li>SPRING&lt;/li>
&lt;li>SPI&lt;/li>
&lt;li>&amp;hellip;.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
- https://pinkhello.me/posts/04-%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84rpc%E8%B0%83%E7%94%A8/ - PinkHello, All Rights Reserved</description></item><item><title>03 String‰∏∫‰ªÄ‰πàËÆæËÆ°Êàêfinal</title><link>https://pinkhello.me/posts/03-string%E4%B8%BA%E4%BB%80%E4%B9%88%E8%AE%BE%E8%AE%A1%E6%88%90final/</link><pubDate>Wed, 10 Feb 2021 08:19:51 +0800</pubDate><guid>https://pinkhello.me/posts/03-string%E4%B8%BA%E4%BB%80%E4%B9%88%E8%AE%BE%E8%AE%A1%E6%88%90final/</guid><description>PinkHello https://pinkhello.me/posts/03-string%E4%B8%BA%E4%BB%80%E4%B9%88%E8%AE%BE%E8%AE%A1%E6%88%90final/ -&lt;h1 id="stringÊ∫êÁ†ÅÂâñÊûê">&lt;code>String&lt;/code>Ê∫êÁ†ÅÂâñÊûê&lt;/h1>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">final&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">class&lt;/span> &lt;span style="color:#008b45;font-weight:bold">String&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">implements&lt;/span> java.&lt;span style="color:#658b00">io&lt;/span>.&lt;span style="color:#658b00">Serializable&lt;/span>, Comparable&amp;lt;String&amp;gt;, CharSequence {
&lt;span style="color:#228b22">/** The value is used for character storage. */&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">final&lt;/span> &lt;span style="color:#00688b;font-weight:bold">char&lt;/span> value[];
&lt;span style="color:#228b22">/** Cache the hash code for the string */&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> &lt;span style="color:#00688b;font-weight:bold">int&lt;/span> hash; &lt;span style="color:#228b22">// Default to 0
&lt;/span>&lt;span style="color:#228b22">&lt;/span>
&lt;span style="color:#228b22">/** use serialVersionUID from JDK 1.0.2 for interoperability */&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">final&lt;/span> &lt;span style="color:#00688b;font-weight:bold">long&lt;/span> serialVersionUID = -6849794470754667710L;
&lt;span style="color:#228b22">/**
&lt;/span>&lt;span style="color:#228b22"> * Class String is special cased within the Serialization Stream Protocol.
&lt;/span>&lt;span style="color:#228b22"> *
&lt;/span>&lt;span style="color:#228b22"> * A String instance is written into an ObjectOutputStream according to
&lt;/span>&lt;span style="color:#228b22"> * &amp;lt;a href=&amp;#34;{@docRoot}/../platform/serialization/spec/output.html&amp;#34;&amp;gt;
&lt;/span>&lt;span style="color:#228b22"> * Object Serialization Specification, Section 6.2, &amp;#34;Stream Elements&amp;#34;&amp;lt;/a&amp;gt;
&lt;/span>&lt;span style="color:#228b22"> */&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">final&lt;/span> ObjectStreamField[] serialPersistentFields =
&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> ObjectStreamField[0];
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>String&lt;/code> Â¶Ç‰Ωï‰øùËØÅ ‰∏çÂèØÂèòÁöÑÂë¢Ôºü&lt;/p>
&lt;blockquote>
&lt;p>Â≠óÁ¨¶Êï∞ÁªÑ‰ΩøÁî®‰∫Ü &lt;code>final&lt;/code> ‰øÆÈ•∞ÔºåËøô‰πüÂè™ÊòØË°®Á§∫‰∫Ü Â≠óÁ¨¶Êï∞ÁªÑÁöÑÂºïÁî®Âú∞ÂùÄ‰∏çÂèØÂèòÔºåÂπ∂‰∏ç‰ª£Ë°®ÂÜÖÂÆπ‰∏çÂèØÂèò„ÄÇ
ÂÖ∂‰ΩøÁî® &lt;code>private&lt;/code> ‰øÆÈ•∞ÔºåÂ§ñÈÉ®Ê≤°ÊúâÂÖ•Âè£ËææÂà∞ÂèòÂä®Ôºå‰ªéËÄå‰øùËØÅ‰∫Ü String ÁöÑ‰∏çÂèØÂèòÊÄß&lt;/p>
&lt;/blockquote>
&lt;p>‰∏∫‰ªÄ‰πà‰øùËØÅ &lt;code>String&lt;/code> ÊòØ &lt;code>final&lt;/code> ÁöÑÂë¢ÔºüÁâπÁÇπÔºö&lt;/p>
&lt;blockquote>
&lt;ul>
&lt;li>Âõ†‰∏∫Âè™Êúâ‰øùËØÅ &lt;code>String&lt;/code> ÊòØ &lt;code>final&lt;/code> ÁöÑÂë¢ &lt;strong>Âè™ÊúâÂΩìÂ≠óÁ¨¶‰∏≤‰∏çÂèØÂèòÁöÑÔºåÂ≠óÁ¨¶‰∏≤Ê±†ÊâçÂèØËÉΩÂÆûÁé∞&lt;/strong>;Â≠óÁ¨¶‰∏≤Ê±†ÁöÑÂÆûÁé∞ÂèØ‰ª•ËäÇÁúÅÂæàÂ§öÁöÑ &lt;code>Heap&lt;/code>Á©∫Èó¥ÔºåÂõ†‰∏∫‰∏çÂêåÁöÑÂ≠óÁ¨¶‰∏≤ÂèòÈáèÈÉΩÊåáÂêëÊ±†‰∏≠ÁöÑÂêå‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤.&lt;/li>
&lt;li>ÂÅáÂ¶ÇÂ≠óÁ¨¶‰∏≤ÂèØÂèòÔºåÈÇ£‰πà&lt;code>String&lt;/code> &lt;code>interning&lt;/code> ‰∏çËÉΩÂÆûÁé∞ÔºåÈÇ£‰πàÂèòÈáèÊîπÂèò‰∫ÜËøô‰∏™Â≠óÁ¨¶‰∏≤ÁöÑÂÄºÔºåÈÇ£‰πàÂÖ∂‰ªñÊåáÂêëËøô‰∏™ÂÄºÁöÑÂèòÈáèÁöÑÂÄº‰πüÊîπÂèò‰∫Ü„ÄÇ ÔºàÂÆâÂÖ®ÈóÆÈ¢òÊù•‰∫ÜÔºåÁî®Êà∑ÂêçÂØÜÁ†ÅÔºåÁ´ØÂè£„ÄÅIPÁ≠âÔºâ&lt;/li>
&lt;li>Â≠óÁ¨¶‰∏≤‰∏çÂèØÂèòÔºåÂ§öÁ∫øÁ®ãÂÆâÂÖ®ÔºåÂêå‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÂÆû‰æãÂèØ‰ª•Ë¢´ÂØπÊ≠åÁ∫øÁ®ãÂÖ±‰∫´Ôºå‰∏çÈúÄË¶ÅËÄÉËôëÂêåÊ≠•ÈóÆÈ¢ò&lt;/li>
&lt;li>‰∏äÈù¢ÁúãÂá∫ÔºåÂú®Â≠óÁ¨¶‰∏≤‰∏çÂèØÂèòÁöÑÊÉÖÂÜµ‰∏ãÔºåÂàõÂª∫ÁöÑÊó∂ÂÄô &lt;code>hashcode&lt;/code>‰πüË¢´ÁºìÂ≠ò‰∫ÜÔºå‰∏çÈúÄË¶ÅÈáçÊñ∞ËÆ°ÁÆó„ÄÇ‰∏ÄÈÉ®ÂàÜÊÄßËÉΩÈóÆÈ¢òÂèØ‰ª•ÂæàÂ•ΩÁöÑÈÄâÊã©Â≠óÁ¨¶‰∏≤&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;h1 id="string-Âú®-jvm-Â±ÇÁêÜËß£-ÊãìÂ±ï">&lt;code>String&lt;/code> Âú® &lt;code>JVM&lt;/code> Â±ÇÁêÜËß£ ÊãìÂ±ï&lt;/h1>
&lt;p>&lt;code>JVM&lt;/code> Â±ÇÈù¢Êúâ ËôöÊãüÊú∫Ê†à„ÄÅÊú¨Âú∞ÊñπÊ≥ïÊ†à„ÄÅÂ†Ü„ÄÅÁ®ãÂ∫èËÆ°Êï∞Âô®„ÄÅÂÖÉÊï∞ÊçÆÂå∫(ÊñπÊ≥ïÂå∫)
&lt;img src="https://pinkhello.me/String%E4%B8%BA%E4%BB%80%E4%B9%88%E8%AE%BE%E8%AE%A1%E6%88%90final%E5%BD%A2%E6%80%81/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%95%B0%E6%8D%AE%E5%8C%BA.png" alt="ËøêË°åÊó∂Êï∞ÊçÆÂå∫">&lt;/p>
&lt;ul>
&lt;li>Â≠óÁ¨¶‰∏≤ÂàõÂª∫ÂΩ¢Âºè&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">String s1 = &lt;span style="color:#cd5555">&amp;#34;1&amp;#34;&lt;/span>;
String s2 = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> String(&lt;span style="color:#cd5555">&amp;#34;1&amp;#34;&lt;/span>);
&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;ul>
&lt;li>ÁºñËØëÊúüÈó¥ &amp;ldquo;1&amp;rdquo; ‰Ωú‰∏∫Â∏∏ÈáèËøõÂÖ•Â≠óÁ¨¶‰∏≤Â∏∏ÈáèÊ±†ÔºàËøôÊó∂ÂÄôÊòØÈùôÊÄÅÂ∏∏ÈáèÊ±†Ôºâ;&lt;/li>
&lt;li>ÂΩìÁºñËØë &lt;code>s1&lt;/code> Êó∂ÂÄôÔºåÂ∞Ü &lt;code>s1&lt;/code> Êé®ËøõÂ±ÄÈÉ®ÂèòÈáèÂå∫ÔºàÊ†àÂ∏ßÂÜÖÈÉ®Ôºâ; ÂÖàÂà§Êñ≠ &amp;ldquo;1&amp;rdquo; Âú®Â≠óÁ¨¶‰∏≤Â∏∏ÈáèÊ±†Âú®‰∏çÂú®Ôºå‰∏çÂ≠òÂú®ÁöÑËØùÂàõÂª∫Â∏∏Èáè &amp;ldquo;1&amp;rdquo; Âä†ÂÖ•Â∏∏ÈáèÊ±†ÔºåÂπ∂Áõ¥Êé•Â∞Ü &lt;code>s1&lt;/code> ÊåáÂêëÂ≠óÁ¨¶‰∏≤Â∏∏ÈáèÊ±†ÁöÑÂØπË±° &amp;ldquo;1&amp;rdquo; Âú∞ÂùÄÔºõ&lt;/li>
&lt;li>ÂΩì‰ª£Á†ÅËøêË°å &lt;code>s2&lt;/code> Êó∂ÂÄôÔºå‰ΩøÁî®ÁöÑ &lt;code>new&lt;/code> Â≠óÊÆµÔºå&lt;code>JVM&lt;/code> ÂÖàÊ£ÄÊü•Â≠óÁ¨¶‰∏≤Â∏∏ÈáèÂú®Â∏∏ÈáèÊ±†Â≠ò‰∏çÂ≠òÂú®ÔºåÂ¶ÇÊûúÂ∑≤ÁªèÂ≠òÂú®ÔºåÁõ¥Êé•Âú®Â†Ü‰∏≠Â§çÂà∂ÊîπÂØπË±°ÁöÑÂâØÊú¨ÔºåÂπ∂‰∏îÂ∞Ü &lt;code>s2&lt;/code> ÊåáÂêëÂ†Ü‰∏≠ÁöÑÂàöÂàöÂàõÂª∫ÁöÑÂØπË±°Âú∞ÂùÄ„ÄÇ
Â¶ÇÊûú‰∏çÂ≠òÂú®ÔºåÂàô‰ºöÂÆû‰æãÂåñËØ•Â≠óÁ¨¶‰∏≤ &amp;ldquo;1&amp;rdquo; Âπ∂‰∏îÂ∞ÜÂÖ∂ÊîæÂà∞Â∏∏ÈáèÊ±†‰∏≠ÔºàËøôÊó∂ÂÄôÊòØËøêË°åÊó∂Â∏∏ÈáèÊ±†Ôºâ,ÁÑ∂ÂêéÂú®Â†Ü‰∏≠Â§çÂà∂ÂàöÂàöÂä†ÂÖ•Â∏∏ÈáèÊ±†ÂØπË±°ÁöÑÂâØÊú¨ÂàõÂª∫Âá∫Êñ∞ÁöÑÂØπË±°ÔºåÂπ∂Â∞Ü &lt;code>s2&lt;/code> ÊåáÂêëÂÆÉ&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;ul>
&lt;li>&amp;lsquo;+&amp;lsquo;Âè∑ËøûÊé•ÁöÑÂ≠óÁ¨¶‰∏≤&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">String s1 = &lt;span style="color:#cd5555">&amp;#34;1&amp;#34;&lt;/span>+&lt;span style="color:#cd5555">&amp;#34;2&amp;#34;&lt;/span>+&lt;span style="color:#cd5555">&amp;#34;3&amp;#34;&lt;/span>;
&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;ul>
&lt;li>ÁºñËØëÊúüÈó¥Â∞±ËÉΩÁ°ÆÂÆöÔºåÁõ¥Êé•‰Ωú‰∏∫ &amp;ldquo;123&amp;rdquo; ÁöÑÂ∏∏ÈáèËøõÂÖ•Â∏∏ÈáèÊ±†;&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">String s2 = &lt;span style="color:#cd5555">&amp;#34;1&amp;#34;&lt;/span>+&lt;span style="color:#cd5555">&amp;#34;2&amp;#34;&lt;/span>+&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> String(&lt;span style="color:#cd5555">&amp;#34;3&amp;#34;&lt;/span>)+&lt;span style="color:#cd5555">&amp;#34;4&amp;#34;&lt;/span>;
&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;ul>
&lt;li>ÂΩì &amp;lsquo;+&amp;rsquo; ‰∏≠Èó¥ÊúâÂèòÈáèÊó∂ÂÄôÔºå‰πüÂè™ËÉΩÂú®ËøêË°åÊúüÊâçËÉΩÁ°ÆÂÆöÔºå‰ΩÜÊòØÂú®ÁºñËØëÊúüÈó¥‰ºöÂ∞ΩÈáèÁöÑÂ∞ÜÂ≠óÁ¨¶‰∏≤Â∏∏ÈáèËøûÊé•Ëµ∑Êù•ÔºåÂΩ¢ÊàêÊñ∞ÁöÑÂ≠óÁ¨¶‰∏≤Â∏∏Èáè;&lt;/li>
&lt;li>ÂèçÁºñËØëÂêé &lt;code>String s2 = new StringBuilder(&amp;quot;12&amp;quot;).append(new String(&amp;quot;3&amp;quot;&amp;quot;)).append(&amp;quot;4&amp;quot;).toString()&lt;/code>;&lt;/li>
&lt;li>‰πüÂ∞±ÊòØËØ¥Áî® &amp;lsquo;+&amp;rsquo; ËøûÊé•‰∏≠Èó¥ÊúâÂèòÈáèÁöÑÊó∂ÂÄôÔºå&amp;ldquo;13&amp;rdquo;, &amp;ldquo;3&amp;rdquo;, &amp;ldquo;4&amp;rdquo; Âú®Â∏∏ÈáèÊ±†‰∏≠ÔºåÂú®Â†Ü‰∏≠Êúâ &lt;code>StringBuilder(&amp;quot;1234&amp;quot;)&lt;/code>, &lt;code>String(&amp;quot;4&amp;quot;)&lt;/code>,‰ª•Âèä&lt;code>toString&lt;/code>Âêé‰∫ßÁîüÁöÑ&lt;code>String&lt;/code>ÂØπË±°&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">String s3 = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> String(&lt;span style="color:#cd5555">&amp;#34;3&amp;#34;&lt;/span>) + &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> String(&lt;span style="color:#cd5555">&amp;#34;3&amp;#34;&lt;/span>);
&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;ul>
&lt;li>&amp;ldquo;3&amp;rdquo; Âú®Â∏∏ÈáèÊ±†‰∏≠ÔºàÁºñËØëÁöÑÊó∂ÂÄôÔºâ&lt;/li>
&lt;li>ËøêË°åÊó∂ÔºåÂú®Â†Ü‰∏≠‰∫ßÁîü &amp;ldquo;3&amp;rdquo; ÁöÑÂâØÊú¨‰∏§‰∏™ &lt;code>String&lt;/code> ÂØπË±°ÔºåÂπ∂‰∫ßÁîü &lt;code>StringBuilder(&amp;quot;11&amp;quot;)&lt;/code> ÂØπË±°‰ª•Âèä &lt;code>toString&lt;/code> ÁöÑ &lt;code>String&lt;/code> ÂØπË±°&lt;/li>
&lt;/ul>
&lt;/blockquote>
- https://pinkhello.me/posts/03-string%E4%B8%BA%E4%BB%80%E4%B9%88%E8%AE%BE%E8%AE%A1%E6%88%90final/ - PinkHello, All Rights Reserved</description></item><item><title>02 ÂÖ≥‰∫éfinalÁöÑÊÄùËÄÉ</title><link>https://pinkhello.me/posts/02-%E5%85%B3%E4%BA%8Efinal%E7%9A%84%E6%80%9D%E8%80%83/</link><pubDate>Wed, 10 Feb 2021 08:09:36 +0800</pubDate><guid>https://pinkhello.me/posts/02-%E5%85%B3%E4%BA%8Efinal%E7%9A%84%E6%80%9D%E8%80%83/</guid><description>PinkHello https://pinkhello.me/posts/02-%E5%85%B3%E4%BA%8Efinal%E7%9A%84%E6%80%9D%E8%80%83/ -&lt;h2 id="ÂÖ≥‰∫éfinalÁöÑÊÄùËÄÉ">ÂÖ≥‰∫é&lt;code>final&lt;/code>ÁöÑÊÄùËÄÉ&lt;/h2>
&lt;ul>
&lt;li>&lt;code>final&lt;/code> ÊòØÂ£∞ÊòéÊï∞ÊçÆÂüüÊúÄÁªàÁöÑ,‰∏çÂèØ‰ª•‰øÆÊîπÁöÑÔºåÂ∏∏ËßÅÁöÑ ÊòØÁ±ªÁöÑ Â∫èÂàóÂåñ&lt;code>ID&lt;/code>&lt;/li>
&lt;li>&lt;code>String&lt;/code> Á±ªÔºåÂÖ∂Êï∞ÊçÆÂüüÈÉΩÊòØ &lt;code>final&lt;/code> ÁöÑ&lt;/li>
&lt;/ul>
&lt;h3 id="‰øÆÊîπ-final-‰øÆÈ•∞ÁöÑÂ±ûÊÄß">‰øÆÊîπ &lt;code>final&lt;/code> ‰øÆÈ•∞ÁöÑÂ±ûÊÄß&lt;/h3>
&lt;p>ÂèçÂ∞Ñ‰øÆÊîπ &lt;code>final&lt;/code> ‰øÆÈ•∞ÁöÑÊï∞ÊçÆÂüü„ÄêÈùûÂ∏∏ÊàêÂäüÁöÑ‰øÆÊîπ‰∫Ü„Äë&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">class&lt;/span> &lt;span style="color:#008b45;font-weight:bold">Test&lt;/span> {
&lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">final&lt;/span> String name = &lt;span style="color:#cd5555">&amp;#34;hello world&amp;#34;&lt;/span>;
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">main&lt;/span>(String[] args) &lt;span style="color:#8b008b;font-weight:bold">throws&lt;/span> NoSuchFieldException, IllegalAccessException {
Test test = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> Test();
Field field = test.&lt;span style="color:#658b00">getClass&lt;/span>().&lt;span style="color:#658b00">getDeclaredField&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;name&amp;#34;&lt;/span>);
field.&lt;span style="color:#658b00">setAccessible&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">true&lt;/span>);
field.&lt;span style="color:#658b00">set&lt;/span>(test,&lt;span style="color:#cd5555">&amp;#34;HELLO, WORLD!&amp;#34;&lt;/span>);
System.&lt;span style="color:#658b00">out&lt;/span>.&lt;span style="color:#658b00">println&lt;/span>(field.&lt;span style="color:#658b00">get&lt;/span>(test));
System.&lt;span style="color:#658b00">out&lt;/span>.&lt;span style="color:#658b00">println&lt;/span>(test.&lt;span style="color:#658b00">name&lt;/span>);
}
}
ËæìÂá∫
Hello, WORLD!
hello world
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Á¨¨‰∏Ä‰∏™ËæìÂá∫ÊòØÂõ†‰∏∫ËØ¥ÊòéËøêË°åÊàêÂäüÔºå‰øÆÊîπ&lt;code>final&lt;/code>‰øÆÈ•∞ÁöÑÂØπË±°ÁöÑÂ±ûÊÄßÊàêÂäü‰øÆÊîπÔºõ&lt;/p>
&lt;p>‰ΩÜÊòØÁ¨¨‰∫å‰∏™ËæìÂá∫ÔºåË°®Êòé‰∫ÜÊàëÁõ¥Êé•‰ΩøÁî® &lt;code>name&lt;/code> ÁöÑÂ±ûÊÄßÂç¥ËøòÊòØËæìÂá∫Á´ØÈ¢ùÂéüÊù•ÁöÑÂÄº.&lt;/p>
&lt;p>ÂèçÁºñËØëÂêéÁöÑ‰ª£Á†Å&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">class&lt;/span> &lt;span style="color:#008b45;font-weight:bold">Test&lt;/span> {
&lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">final&lt;/span> String name = &lt;span style="color:#cd5555">&amp;#34;hello world&amp;#34;&lt;/span>;
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#008b45">Test&lt;/span>() {
}
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">main&lt;/span>(String[] args) &lt;span style="color:#8b008b;font-weight:bold">throws&lt;/span> NoSuchFieldException, IllegalAccessException {
Test test = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> Test();
Field field = test.&lt;span style="color:#658b00">getClass&lt;/span>().&lt;span style="color:#658b00">getDeclaredField&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;name&amp;#34;&lt;/span>);
field.&lt;span style="color:#658b00">setAccessible&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">true&lt;/span>);
field.&lt;span style="color:#658b00">set&lt;/span>(test, &lt;span style="color:#cd5555">&amp;#34;HELLO, WORLD!&amp;#34;&lt;/span>);
System.&lt;span style="color:#658b00">out&lt;/span>.&lt;span style="color:#658b00">println&lt;/span>(field.&lt;span style="color:#658b00">get&lt;/span>(test));
PrintStream var10000 = System.&lt;span style="color:#658b00">out&lt;/span>;
test.&lt;span style="color:#658b00">getClass&lt;/span>();
var10000.&lt;span style="color:#658b00">println&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;hello world&amp;#34;&lt;/span>);
}
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÂèØ‰ª•ÁúãÂá∫ ‰ΩøÁî®ÂØπË±°.Â±ûÊÄßÁöÑÂ∑≤ÁªèË¢´ÊõøÊç¢‰∫ÜÔºåËøôÊòØÁî±‰∫é&lt;code>JVM&lt;/code> ÁöÑÂÜÖËÅî‰ºòÂåñÔºàÊñπÊ≥ïË∞ÉÁî®(ÂèÇÊï∞ÂéãÊ†à,Ë∑≥ËΩ¨Âà∞ÊñπÊ≥ïÂ§ÑÊâßË°å,ÂÜçË∞ÉÂõû,Â§ÑÁêÜÊ†àÂèÇÊï∞,Â§ÑÁêÜËøîÂõûÂÄº)ÔºâÂØºËá¥ÁöÑÔºå‰ºöÁõ¥Êé•ÊõøÊç¢Êéâ‰ΩøÁî® final ‰øÆÈ•∞ÁöÑÂ≠óÊÆµ„ÄÇ„ÄêÂΩìÁÑ∂‰πüÂèØ‰ª•ÂÖ≥Èó≠ÂÜÖËÅî‰ºòÂåñ„Äë&lt;/p>
&lt;h3 id="‰øÆÊîπ‰ΩøÁî®-final-‰øÆÈ•∞ÁöÑ-static-Á±ªÂ±ûÊÄß">‰øÆÊîπ‰ΩøÁî® &lt;code>final&lt;/code> ‰øÆÈ•∞ÁöÑ &lt;code>static&lt;/code> Á±ªÂ±ûÊÄß&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">class&lt;/span> &lt;span style="color:#008b45;font-weight:bold">Test&lt;/span> {
&lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">final&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> String NAME = &lt;span style="color:#cd5555">&amp;#34;static hello world&amp;#34;&lt;/span>;
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">main&lt;/span>(String[] args) &lt;span style="color:#8b008b;font-weight:bold">throws&lt;/span> NoSuchFieldException, IllegalAccessException {
Test test = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> Test();
&lt;span style="color:#228b22">//‰øÆÊîπNAME
&lt;/span>&lt;span style="color:#228b22">&lt;/span> Field sfield = test.&lt;span style="color:#658b00">getClass&lt;/span>().&lt;span style="color:#658b00">getDeclaredField&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;NAME&amp;#34;&lt;/span>);
sfield.&lt;span style="color:#658b00">setAccessible&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">true&lt;/span>);
sfield.&lt;span style="color:#658b00">set&lt;/span>(test,&lt;span style="color:#cd5555">&amp;#34;STATIC HELLO, WORLD!&amp;#34;&lt;/span>);
System.&lt;span style="color:#658b00">out&lt;/span>.&lt;span style="color:#658b00">println&lt;/span>(sfield.&lt;span style="color:#658b00">get&lt;/span>(test));
System.&lt;span style="color:#658b00">out&lt;/span>.&lt;span style="color:#658b00">println&lt;/span>(test.&lt;span style="color:#658b00">NAME&lt;/span>);
}
}
ËæìÂá∫ÂºÇÂ∏∏ Can not set &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">final&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>‰øÆÊîπ&lt;code>Field&lt;/code>‰∏≠ÁöÑ&lt;code>modifiers&lt;/code>Êï∞ÊçÆÂüüÔºåÊ∏ÖÈô§‰ª£Ë°®&lt;code>final&lt;/code>ÁöÑÈÇ£‰∏™bitÔºåÊâçÂèØ‰ª•ÊàêÂäü‰øÆÊîπ„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">class&lt;/span> &lt;span style="color:#008b45;font-weight:bold">Test&lt;/span> {
&lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">final&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> String NAME = &lt;span style="color:#cd5555">&amp;#34;static hello world&amp;#34;&lt;/span>;
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">main&lt;/span>(String[] args) &lt;span style="color:#8b008b;font-weight:bold">throws&lt;/span> NoSuchFieldException, IllegalAccessException {
Test test = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> Test();
&lt;span style="color:#228b22">//‰øÆÊîπNAME
&lt;/span>&lt;span style="color:#228b22">&lt;/span> Field sfield = test.&lt;span style="color:#658b00">getClass&lt;/span>().&lt;span style="color:#658b00">getDeclaredField&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;NAME&amp;#34;&lt;/span>);
Field modifiers = sfield.&lt;span style="color:#658b00">getClass&lt;/span>().&lt;span style="color:#658b00">getDeclaredField&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;modifiers&amp;#34;&lt;/span>);
modifiers.&lt;span style="color:#658b00">setAccessible&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">true&lt;/span>);
modifiers.&lt;span style="color:#658b00">setInt&lt;/span>(sfield, sfield.&lt;span style="color:#658b00">getModifiers&lt;/span>() &amp;amp; ~Modifier.&lt;span style="color:#658b00">FINAL&lt;/span>);&lt;span style="color:#228b22">//fianlÊ†áÂøó‰ΩçÁΩÆ0
&lt;/span>&lt;span style="color:#228b22">&lt;/span>
sfield.&lt;span style="color:#658b00">setAccessible&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">true&lt;/span>);
sfield.&lt;span style="color:#658b00">set&lt;/span>(test,&lt;span style="color:#cd5555">&amp;#34;STATIC HELLO, WORLD!&amp;#34;&lt;/span>);
System.&lt;span style="color:#658b00">out&lt;/span>.&lt;span style="color:#658b00">println&lt;/span>(sfield.&lt;span style="color:#658b00">get&lt;/span>(test));
System.&lt;span style="color:#658b00">out&lt;/span>.&lt;span style="color:#658b00">println&lt;/span>(test.&lt;span style="color:#658b00">NAME&lt;/span>);
}
}
ËæìÂá∫
STATIC HELLO, WORLD!
&lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> hello world
&lt;/code>&lt;/pre>&lt;/div>- https://pinkhello.me/posts/02-%E5%85%B3%E4%BA%8Efinal%E7%9A%84%E6%80%9D%E8%80%83/ - PinkHello, All Rights Reserved</description></item><item><title>01 ‰∏ÄËá¥ÊÄßÂìàÂ∏åÁÆóÊ≥ï</title><link>https://pinkhello.me/posts/01-%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/</link><pubDate>Tue, 09 Feb 2021 22:50:46 +0800</pubDate><guid>https://pinkhello.me/posts/01-%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/</guid><description>PinkHello https://pinkhello.me/posts/01-%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/ -&lt;h1 id="ÂàÜÂ∏ÉÂºèÂùáË°°ÂØªÂùÄÁÆóÊ≥ï">ÂàÜÂ∏ÉÂºèÂùáË°°ÂØªÂùÄÁÆóÊ≥ï&lt;/h1>
&lt;p>Âú®ÂàÜÂ∏ÉÂºèÈõÜÁæ§‰∏≠ÔºåÂØπÊú∫Âô®ÁöÑÊ∑ªÂä†Âà†Èô§ÔºåÊàñËÄÖÊú∫Âô®ÊïÖÈöúÂêéËá™Âä®ËÑ±ËêΩÈõÜÁæ§ÁöÑÊìç‰ΩúÊòØÂàÜÂ∏ÉÂºèÈõÜÁæ§ÁÆ°ÁêÜÁöÑÂü∫Êú¨ÂäüËÉΩ„ÄÇ&lt;/p>
&lt;blockquote>
&lt;p>Âú®ÈõÜÁæ§ÁéØÂ¢É‰∏≠ÔºåÂà§Êñ≠ÂàÜÂ∏ÉÂºèÂØªÂùÄÁÆóÊ≥ïÂ•ΩÂùèÁöÑÂéüÂàôÔºö&lt;/p>
&lt;ul>
&lt;li>Âπ≥Ë°°ÊÄßÔºàBalanceÔºâ&lt;/li>
&lt;li>ÂçïË∞ÉÊÄßÔºàMonotonicityÔºâ&lt;/li>
&lt;li>ÂàÜÊï£ÊÄßÔºàSpreadÔºâ&lt;/li>
&lt;li>Ë¥üËΩΩÔºàLoadÔºâ&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;h2 id="hashobjectn">Hash(Object)%N&lt;/h2>
&lt;p>ÈõÜÁæ§NÂè∞Êú∫Âô®ÔºåÊ†πÊçÆNÂèñÊ®°ÔºåË∑ØÁî±Âà∞ÂØπÂ∫îÁöÑÊú∫Âô®Ôºå‰ΩÜÊòØÁº∫ÁÇπÂú®‰∫éÔºåÂØπ‰∫éÊú∫Âô®ÁöÑÊ∑ªÂä†Âà†Èô§ÔºåÂ∑≤ÁªèÁºìÂ≠òÁöÑÊï∞ÊçÆÈÉΩÂ§±Êïà„ÄÅ‰∏•ÈáçËøùÂèçÂçïË∞ÉÊÄßÔºå
Â§ßÈáèÁöÑÁºìÂ≠òÈáçÂª∫&lt;/p>
&lt;blockquote>
&lt;p>ÂÅáËÆæ0-3‰∏™ËäÇÁÇπ„ÄÅ20‰∏™Êï∞ÊçÆ:
&lt;img src="https://pinkhello.me/%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/hash.png" alt="ÂìàÂ∏åÊï∞ÊçÆ">&lt;/p>
&lt;p>ËøõË°åÂèñÊ®°ÂêéÂàÜÂ∏É:
&lt;img src="https://pinkhello.me/%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/hash1.png" alt="ÂìàÂ∏åÂèñÊ®°ÂêéÂàÜÂ∏É">&lt;/p>
&lt;p>Êâ©ÂÆπÂêé:
&lt;img src="https://pinkhello.me/%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/hash3.png" alt="Êâ©ÂÆπÂêé">
ÂΩìÂâçÂè™Êúâ4‰∏™Êï∞ÊçÆËÉΩÂëΩ‰∏≠„ÄÇÂëΩ‰∏≠Áéá 4/20 = 20% ,ÂëΩ‰∏≠ÁéáÂ∫ï‰∏ãÔºåÂπ∂‰∏îÊúâÂ§ßÈáèÁºìÂ≠òÈúÄË¶ÅÈáçÂª∫&lt;/p>
&lt;/blockquote>
&lt;h2 id="‰∏ÄËá¥ÊÄßhash--dht-">‰∏ÄËá¥ÊÄßHash ( DHT )&lt;/h2>
&lt;blockquote>
&lt;p>ÂÖ¨ÂÖ±ÂìàÂ∏åÂáΩÊï∞ÂíåÂìàÂ∏åÁéØ
HashÁÆóÊ≥ïËÆæËÆ°: ÈááÂèñÂèñÊ®°ÊñπÂºèÔºåÊåâÂ∏∏Áî®ÁöÑ Hash ÁÆóÊ≥ïÂ∞ÜÂØπÂ∫îÁöÑ Key ÂìàÂ∏åÂà∞‰∏Ä‰∏™ÂÖ∑Êúâ 2^32 Ê¨°ÊñπÁöÑÊ°∂Á©∫Èó¥‰∏≠ÔºåÂç≥ 0 ~ (2^32)-1 ÁöÑÊï∞Â≠óÁ©∫Èó¥„ÄÇÊÉ≥ÊÉ≥‰∏Ä‰∏ãÔºåÂ∞ÜÊï∞Â≠óÈ¶ñ‰ΩçÁõ∏ËøûÔºåÁªÑÊàê‰∏Ä‰∏™Èó≠ÂêàÁöÑÁéØÂΩ¢„ÄÇ
&lt;img src="https://pinkhello.me/%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/hash4.png" alt="ÁéØÂΩ¢HashÁ©∫Èó¥">&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>ÂØπË±°(Object)Êò†Â∞ÑÂà∞ÂìàÂ∏åÁéØ
ÊääÂØπË±°Êò†Â∞ÑÂà∞ 0-2^32-1 Á©∫Èó¥ÈáåÔºåÂÅáËÆæÊúâ4‰∏™ÂØπË±° object1-4 ÔºåÊò†Â∞ÑËøõhashÁéØÁä∂
&lt;img src="https://pinkhello.me/%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/hash5.png" alt="ÂØπË±°Êò†Â∞ÑÁéØÂΩ¢HashÁ©∫Èó¥">&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>ÁºìÂ≠ò(Cache)Êò†Â∞ÑÂà∞ÂìàÂ∏åÁéØ
‰∏ãÈù¢Â∞Ü Cache Êò†Â∞ÑËøõ Hash Á©∫Èó¥ÔºåÂÅáËÆæÁé∞Âú®Êúâ‰∏â‰∏™cacheÔºö&lt;/p>
&lt;blockquote>
&lt;p>Âü∫Êú¨ÊÄùÊÉ≥Â∞±ÊòØ Object Âíå Cache ÈÉΩÊò†Â∞ÑÂà∞Âêå‰∏Ä Hash Êï∞ÂÄºÁ©∫Èó¥‰∏≠ÔºåÂπ∂‰∏î‰ΩøÁî®Áõ∏ÂêåÁöÑ HashÁÆóÊ≥ïÔºåÂèØ‰ª•‰ΩøÁî® Cache ÁöÑ IPÂú∞ÂùÄÊàñËÄÖÂÖ∂‰ªñÂõ†Â≠êÔºâ&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://pinkhello.me/%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/hash6.png" alt="CacheÊò†Â∞ÑÁéØÂΩ¢HashÁ©∫Èó¥">&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>ÂØπË±°ÔºàObjectÊò†Â∞ÑÂà∞ÁºìÂ≠ò(Cache)ËäÇÁÇπ
ÊØè‰∏™ Cache ÁöÑ Key È°∫Êó∂ÈíàÔºåÊâæÂà∞Á¨¨‰∏Ä‰∏™ Cache ËäÇÁÇπÂ∞±ÊòØÂ≠òÂÇ®‰ΩçÁΩÆ:
&lt;img src="https://pinkhello.me/%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/hash7.png" alt="ÊâæÂà∞CacheÂ≠òÂÇ®‰ΩçÁΩÆ">&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>ÁßªÈô§‰∏Ä‰∏™ÁºìÂ≠òËäÇÁÇπ
ÁßªÈô§‰∏Ä‰∏™ CacheB ËäÇÁÇπ, ËøôÊó∂ÂÄô key4 Êó†Ê≥ïÊâæÂØªÂà∞ CacheÔºåkey4Â∞ÜÁªßÁª≠‰ΩøÁî®‰∏ÄËá¥ÊÄßHashÁÆóÊ≥ïÁÆóÂá∫ÊúÄÊñ∞ÁöÑ CacheC, ‰ª•ÂêéÂ≠òÂÇ®‰∏éËØªÂèñÈÉΩÂú® CacheC ‰∏ä„ÄÇ
&lt;img src="https://pinkhello.me/%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/hash8.png" alt="ÁßªÈô§CacheBËäÇÁÇπ">&lt;/p>
&lt;blockquote>
&lt;p>ÁßªÈô§ËäÇÁÇπÂêéÁöÑÂΩ±ÂìçËåÉÂõ¥Âú®ËØ•ËäÇÁÇπÈÄÜÊó∂ÈíàËÆ°ÁÆóÂà∞ÈÅáÂà∞ÁöÑÁ¨¨‰∏Ä‰∏™cacheËäÇÁÇπ‰πãÈó¥ÁöÑÊï∞ÊçÆËäÇÁÇπ„ÄÇ&lt;/p>
&lt;/blockquote>
&lt;/blockquote>
&lt;blockquote>
&lt;p>Â¢ûÂä†‰∏Ä‰∏™ÁºìÂ≠òËäÇÁÇπ
Â¢ûÂä†‰∏Ä‰∏™ CacheËäÇÁÇπ
&lt;img src="https://pinkhello.me/%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/hash9.png" alt="Êñ∞Â¢ûCacheËäÇÁÇπ">&lt;/p>
&lt;blockquote>
&lt;p>ÂΩ±ÂìçËåÉÂõ¥‰∏∫ÔºöÊ∑ªÂä†ËäÇÁÇπÈÄÜÊó∂ÈíàÈÅáÂà∞ÁöÑÁ¨¨‰∏Ä‰∏™cacheËäÇÁÇπ‰πãÈó¥ÁöÑÊï∞ÊçÆËäÇÁÇπ&lt;/p>
&lt;/blockquote>
&lt;/blockquote>
&lt;blockquote>
&lt;p>ËôöÊãüCacheËäÇÁÇπ
Áâ©ÁêÜ‰∏ä‰∏çÂèØËÉΩÈÉ®ÁΩ≤ËäÇÁÇπÊúâÈôêÔºåÊâÄ‰ª•ÈúÄË¶ÅËôöÊãüÂá∫Ë∂≥Â§üÂ§öÁöÑËôöÊãüËäÇÁÇπÔºåÊúÄÁªàËææÂà∞Êï∞ÊçÆÂú®ÂìàÂ∏åÊç¢‰∏äÂùáÂåÄÂàÜÂ∏É&lt;/p>
&lt;blockquote>
&lt;p>ÂÅáÂ¶ÇÂè™Êúâ‰∏§‰∏™ËäÇÁÇπ,ÊØè‰∏™ËäÇÁÇπÈÉΩÂ§çÂà∂Êàê3ÂÄçÔºåÁªìÊûúÁúã‰∏äÂéªÈÉ®ÁΩ≤‰∫Ü6‰∏™ËäÇÁÇπ„ÄÇÂèØ‰ª•ÊÉ≥Ë±°ÂΩìÂ§çÂà∂ÂÄçÊï∞ÊòØ 2^32 Êó∂ÂÄôÔºåÂ∞±ËææÂà∞ÁªùÂØπÁöÑÂùáÂåÄÔºåÈÄöÂ∏∏ÂèØÂèñÁöÑÂ§çÂà∂ÂÄçÊï∞‰∏∫32 ÊàñËÄÖÊõ¥È´ò&lt;/p>
&lt;/blockquote>
&lt;p>ËôöÊãüËäÇÁÇπÂìàÂ∏åÂÄºËÆ°ÁÆóÊñπÊ≥ïË∞ÉÊï¥‰∏∫ ÂØπ &amp;ldquo;ËäÇÁÇπIPÔºàÊàñÊú∫Âô®ÂêçÔºâ+ËôöÊãüËäÇÁÇπÁöÑÂ∫èÂè∑Ôºà1~NÔºâ&amp;rdquo; ‰ΩúÂìàÂ∏å&lt;/p>
&lt;/blockquote>
&lt;h1 id="redis-cluster">Redis Cluster&lt;/h1>
&lt;p>Redis Cluster ÊòØ Redis ÂÆòÊñπÂá∫ÂìÅÁöÑÂàÜÂ∏ÉÂºèËß£ÂÜ≥ÊñπÊ°à&lt;/p>
&lt;p>Redis Cluster Áî±Â§ö‰∏™ Redis ÂÆû‰æãÁªÑÊàêÁöÑÊï¥‰ΩìÔºåÊï∞ÊçÆÊåâÁÖß &lt;em>ÊßΩ(slot)&lt;/em> Â≠òÂÇ®ÂàÜÂ∏ÉÂú®Â§ö‰∏™ÂÆû‰æã‰∏äÔºåÈÄöËøá Gossip ÂçèËÆÆÊù•ËøõË°åËäÇÁÇπÈÄö‰ø°„ÄÇ&lt;/p>
&lt;p>redis ‰∏∫‰ªÄ‰πà‰ΩøÁî® 16384 slots? &lt;a href="https://github.com/antirez/redis/issues/2576">redis ‰ΩúËÄÖÁªôÂá∫Á≠îÊ°à&lt;/a>&lt;/p>
&lt;h1 id="‰∏ÄËá¥ÊÄßhashÁÆóÊ≥ïÁöÑjavaÂÆûÁé∞‰∏éÊ£ÄÈ™å">‰∏ÄËá¥ÊÄßhashÁÆóÊ≥ïÁöÑJAVAÂÆûÁé∞‰∏éÊ£ÄÈ™å&lt;/h1>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java"> &lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">class&lt;/span> &lt;span style="color:#008b45;font-weight:bold">ConsistentHashing&lt;/span> {
&lt;span style="color:#228b22">// Áâ©ÁêÜËäÇÁÇπ
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> Set&amp;lt;String&amp;gt; physicalNodes = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> TreeSet&amp;lt;String&amp;gt;() {
{
add(&lt;span style="color:#cd5555">&amp;#34;192.168.1.101&amp;#34;&lt;/span>);
add(&lt;span style="color:#cd5555">&amp;#34;192.168.1.102&amp;#34;&lt;/span>);
add(&lt;span style="color:#cd5555">&amp;#34;192.168.1.103&amp;#34;&lt;/span>);
add(&lt;span style="color:#cd5555">&amp;#34;192.168.1.104&amp;#34;&lt;/span>);
add(&lt;span style="color:#cd5555">&amp;#34;192.168.1.105&amp;#34;&lt;/span>);
add(&lt;span style="color:#cd5555">&amp;#34;192.168.1.106&amp;#34;&lt;/span>);
}
};
&lt;span style="color:#228b22">//ËôöÊãüËäÇÁÇπ
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">final&lt;/span> &lt;span style="color:#00688b;font-weight:bold">int&lt;/span> VIRTUAL_COPIES = 1; &lt;span style="color:#228b22">// Áâ©ÁêÜËäÇÁÇπËá≥ËôöÊãüËäÇÁÇπÁöÑÂ§çÂà∂ÂÄçÊï∞
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> TreeMap&amp;lt;Long, String&amp;gt; virtualNodes = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> TreeMap&amp;lt;&amp;gt;(); &lt;span style="color:#228b22">// ÂìàÂ∏åÂÄº =&amp;gt; Áâ©ÁêÜËäÇÁÇπ
&lt;/span>&lt;span style="color:#228b22">&lt;/span>
&lt;span style="color:#228b22">// 32‰ΩçÁöÑ Fowler-Noll-Vo ÂìàÂ∏åÁÆóÊ≥ï
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#228b22">// https://en.wikipedia.org/wiki/Fowler‚ÄìNoll‚ÄìVo_hash_function
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> Long &lt;span style="color:#008b45">FNVHash&lt;/span>(String key) {
&lt;span style="color:#8b008b;font-weight:bold">final&lt;/span> &lt;span style="color:#00688b;font-weight:bold">int&lt;/span> p = 16777619;
Long hash = 2166136261L;
&lt;span style="color:#8b008b;font-weight:bold">for&lt;/span> (&lt;span style="color:#00688b;font-weight:bold">int&lt;/span> idx = 0, num = key.&lt;span style="color:#658b00">length&lt;/span>(); idx &amp;lt; num; ++idx) {
hash = (hash ^ key.&lt;span style="color:#658b00">charAt&lt;/span>(idx)) * p;
}
hash += hash &amp;lt;&amp;lt; 13;
hash ^= hash &amp;gt;&amp;gt; 7;
hash += hash &amp;lt;&amp;lt; 3;
hash ^= hash &amp;gt;&amp;gt; 17;
hash += hash &amp;lt;&amp;lt; 5;
&lt;span style="color:#8b008b;font-weight:bold">if&lt;/span> (hash &amp;lt; 0) {
hash = Math.&lt;span style="color:#658b00">abs&lt;/span>(hash);
}
&lt;span style="color:#8b008b;font-weight:bold">return&lt;/span> hash;
}
&lt;span style="color:#228b22">// Ê†πÊçÆÁâ©ÁêÜËäÇÁÇπÔºåÊûÑÂª∫ËôöÊãüËäÇÁÇπÊò†Â∞ÑË°®
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#008b45">ConsistentHashing&lt;/span>() {
&lt;span style="color:#8b008b;font-weight:bold">for&lt;/span> (String nodeIp : physicalNodes) {
addPhysicalNode(nodeIp);
}
}
&lt;span style="color:#228b22">// Ê∑ªÂä†Áâ©ÁêÜËäÇÁÇπ
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">addPhysicalNode&lt;/span>(String nodeIp) {
&lt;span style="color:#8b008b;font-weight:bold">for&lt;/span> (&lt;span style="color:#00688b;font-weight:bold">int&lt;/span> idx = 0; idx &amp;lt; VIRTUAL_COPIES; ++idx) {
&lt;span style="color:#00688b;font-weight:bold">long&lt;/span> hash = FNVHash(nodeIp + &lt;span style="color:#cd5555">&amp;#34;#&amp;#34;&lt;/span> + idx);
virtualNodes.&lt;span style="color:#658b00">put&lt;/span>(hash, nodeIp);
}
}
&lt;span style="color:#228b22">// Âà†Èô§Áâ©ÁêÜËäÇÁÇπ
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">removePhysicalNode&lt;/span>(String nodeIp) {
&lt;span style="color:#8b008b;font-weight:bold">for&lt;/span> (&lt;span style="color:#00688b;font-weight:bold">int&lt;/span> idx = 0; idx &amp;lt; VIRTUAL_COPIES; ++idx) {
&lt;span style="color:#00688b;font-weight:bold">long&lt;/span> hash = FNVHash(nodeIp + &lt;span style="color:#cd5555">&amp;#34;#&amp;#34;&lt;/span> + idx);
virtualNodes.&lt;span style="color:#658b00">remove&lt;/span>(hash);
}
}
&lt;span style="color:#228b22">// Êü•ÊâæÂØπË±°Êò†Â∞ÑÁöÑËäÇÁÇπ
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> String &lt;span style="color:#008b45">getObjectNode&lt;/span>(String object) {
&lt;span style="color:#00688b;font-weight:bold">long&lt;/span> hash = FNVHash(object);
SortedMap&amp;lt;Long, String&amp;gt; tailMap = virtualNodes.&lt;span style="color:#658b00">tailMap&lt;/span>(hash); &lt;span style="color:#228b22">// ÊâÄÊúâÂ§ß‰∫é hash ÁöÑËäÇÁÇπ
&lt;/span>&lt;span style="color:#228b22">&lt;/span> Long key = tailMap.&lt;span style="color:#658b00">isEmpty&lt;/span>() ? virtualNodes.&lt;span style="color:#658b00">firstKey&lt;/span>() : tailMap.&lt;span style="color:#658b00">firstKey&lt;/span>();
&lt;span style="color:#8b008b;font-weight:bold">return&lt;/span> virtualNodes.&lt;span style="color:#658b00">get&lt;/span>(key);
}
&lt;span style="color:#228b22">// ÁªüËÆ°ÂØπË±°‰∏éËäÇÁÇπÁöÑÊò†Â∞ÑÂÖ≥Á≥ª
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">dumpObjectNodeMap&lt;/span>(String label, &lt;span style="color:#00688b;font-weight:bold">int&lt;/span> objectMin, &lt;span style="color:#00688b;font-weight:bold">int&lt;/span> objectMax) {
&lt;span style="color:#228b22">// ÁªüËÆ°
&lt;/span>&lt;span style="color:#228b22">&lt;/span> Map&amp;lt;String, Integer&amp;gt; objectNodeMap = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> TreeMap&amp;lt;&amp;gt;(); &lt;span style="color:#228b22">// IP =&amp;gt; COUNT
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">for&lt;/span> (&lt;span style="color:#00688b;font-weight:bold">int&lt;/span> object = objectMin; object &amp;lt;= objectMax; ++object) {
String nodeIp = getObjectNode(Integer.&lt;span style="color:#658b00">toString&lt;/span>(object));
Integer count = objectNodeMap.&lt;span style="color:#658b00">get&lt;/span>(nodeIp);
objectNodeMap.&lt;span style="color:#658b00">put&lt;/span>(nodeIp, (count == &lt;span style="color:#8b008b;font-weight:bold">null&lt;/span> ? 0 : count + 1));
}
&lt;span style="color:#228b22">// ÊâìÂç∞
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#00688b;font-weight:bold">double&lt;/span> totalCount = objectMax - objectMin + 1;
System.&lt;span style="color:#658b00">out&lt;/span>.&lt;span style="color:#658b00">println&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;======== &amp;#34;&lt;/span> + label + &lt;span style="color:#cd5555">&amp;#34; ========&amp;#34;&lt;/span>);
&lt;span style="color:#8b008b;font-weight:bold">for&lt;/span> (Map.&lt;span style="color:#658b00">Entry&lt;/span>&amp;lt;String, Integer&amp;gt; entry : objectNodeMap.&lt;span style="color:#658b00">entrySet&lt;/span>()) {
&lt;span style="color:#00688b;font-weight:bold">long&lt;/span> percent = (&lt;span style="color:#00688b;font-weight:bold">int&lt;/span>) (100 * entry.&lt;span style="color:#658b00">getValue&lt;/span>() / totalCount);
System.&lt;span style="color:#658b00">out&lt;/span>.&lt;span style="color:#658b00">println&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;IP=&amp;#34;&lt;/span> + entry.&lt;span style="color:#658b00">getKey&lt;/span>() + &lt;span style="color:#cd5555">&amp;#34;: RATE=&amp;#34;&lt;/span> + percent + &lt;span style="color:#cd5555">&amp;#34;%&amp;#34;&lt;/span>);
}
}
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">main&lt;/span>(String[] args) {
ConsistentHashing ch = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> ConsistentHashing();
&lt;span style="color:#228b22">// ÂàùÂßãÊÉÖÂÜµ
&lt;/span>&lt;span style="color:#228b22">&lt;/span> ch.&lt;span style="color:#658b00">dumpObjectNodeMap&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;ÂàùÂßãÊÉÖÂÜµ&amp;#34;&lt;/span>, 0, 65536);
&lt;span style="color:#228b22">// Âà†Èô§Áâ©ÁêÜËäÇÁÇπ
&lt;/span>&lt;span style="color:#228b22">&lt;/span> ch.&lt;span style="color:#658b00">removePhysicalNode&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;192.168.1.105&amp;#34;&lt;/span>);
ch.&lt;span style="color:#658b00">dumpObjectNodeMap&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;Âà†Èô§Áâ©ÁêÜËäÇÁÇπ&amp;#34;&lt;/span>, 0, 65536);
&lt;span style="color:#228b22">// Ê∑ªÂä†Áâ©ÁêÜËäÇÁÇπ
&lt;/span>&lt;span style="color:#228b22">&lt;/span> ch.&lt;span style="color:#658b00">addPhysicalNode&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;192.168.1.107&amp;#34;&lt;/span>);
ch.&lt;span style="color:#658b00">dumpObjectNodeMap&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;Ê∑ªÂä†Áâ©ÁêÜËäÇÁÇπ&amp;#34;&lt;/span>, 0, 65536);
}
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Â§çÂà∂ÂÄçÊï∞‰∏∫ 1 Êó∂ÁöÑÂùáË°°ÊÄßÔºàVIRTUAL_COPIES = 1Ôºâ&lt;/p>
&lt;pre>&lt;code> ======== ÂàùÂßãÊÉÖÂÜµ ========
IP=192.168.1.101: RATE=28%
IP=192.168.1.102: RATE=3%
IP=192.168.1.103: RATE=28%
IP=192.168.1.104: RATE=19%
IP=192.168.1.105: RATE=16%
IP=192.168.1.106: RATE=2%
======== Âà†Èô§Áâ©ÁêÜËäÇÁÇπ ========
IP=192.168.1.101: RATE=45%
IP=192.168.1.102: RATE=3%
IP=192.168.1.103: RATE=28%
IP=192.168.1.104: RATE=19%
IP=192.168.1.106: RATE=2%
======== Ê∑ªÂä†Áâ©ÁêÜËäÇÁÇπ ========
IP=192.168.1.101: RATE=45%
IP=192.168.1.102: RATE=3%
IP=192.168.1.103: RATE=25%
IP=192.168.1.104: RATE=19%
IP=192.168.1.106: RATE=2%
IP=192.168.1.107: RATE=3%
&lt;/code>&lt;/pre>&lt;p>Â§çÂà∂ÂÄçÊï∞‰∏∫ 32 Êó∂ÁöÑÂùáË°°ÊÄßÔºàVIRTUAL_COPIES = 32Ôºâ&lt;/p>
&lt;pre>&lt;code> ======== ÂàùÂßãÊÉÖÂÜµ ========
IP=192.168.1.101: RATE=17%
IP=192.168.1.102: RATE=12%
IP=192.168.1.103: RATE=23%
IP=192.168.1.104: RATE=12%
IP=192.168.1.105: RATE=12%
IP=192.168.1.106: RATE=21%
======== Âà†Èô§Áâ©ÁêÜËäÇÁÇπ ========
IP=192.168.1.101: RATE=17%
IP=192.168.1.102: RATE=12%
IP=192.168.1.103: RATE=25%
IP=192.168.1.104: RATE=23%
IP=192.168.1.106: RATE=21%
======== Ê∑ªÂä†Áâ©ÁêÜËäÇÁÇπ ========
IP=192.168.1.101: RATE=16%
IP=192.168.1.102: RATE=12%
IP=192.168.1.103: RATE=14%
IP=192.168.1.104: RATE=23%
IP=192.168.1.106: RATE=15%
IP=192.168.1.107: RATE=17%
&lt;/code>&lt;/pre>&lt;p>Â§çÂà∂ÂÄçÊï∞‰∏∫ 1M Êó∂ÁöÑÂùáË°°ÊÄßÔºàVIRTUAL_COPIES = 1048576Ôºâ&lt;/p>
&lt;pre>&lt;code> ======== ÂàùÂßãÊÉÖÂÜµ ========
IP=192.168.1.101: RATE=16%
IP=192.168.1.102: RATE=16%
IP=192.168.1.103: RATE=16%
IP=192.168.1.104: RATE=16%
IP=192.168.1.105: RATE=16%
IP=192.168.1.106: RATE=16%
======== Âà†Èô§Áâ©ÁêÜËäÇÁÇπ ========
IP=192.168.1.101: RATE=19%
IP=192.168.1.102: RATE=19%
IP=192.168.1.103: RATE=20%
IP=192.168.1.104: RATE=19%
IP=192.168.1.106: RATE=19%
======== Ê∑ªÂä†Áâ©ÁêÜËäÇÁÇπ ========
IP=192.168.1.101: RATE=16%
IP=192.168.1.102: RATE=16%
IP=192.168.1.103: RATE=16%
IP=192.168.1.104: RATE=16%
IP=192.168.1.106: RATE=16%
IP=192.168.1.107: RATE=16%
&lt;/code>&lt;/pre>- https://pinkhello.me/posts/01-%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/ - PinkHello, All Rights Reserved</description></item></channel></rss>