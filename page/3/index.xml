<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>PinkHello</title><link>https://pinkhello.me/</link><description>Recent content on PinkHello</description><generator>Hugo -- gohugo.io</generator><language>zh</language><copyright>PinkHello, All Rights Reserved</copyright><lastBuildDate>Tue, 25 May 2021 19:00:00 +0800</lastBuildDate><atom:link href="https://pinkhello.me/index.xml" rel="self" type="application/rss+xml"/><item><title>04 Â¶Ç‰ΩïÊûÑÂª∫‰∏Ä‰∏™ÁÆÄÂçïÁöÑRPCË∞ÉÁî®</title><link>https://pinkhello.me/posts/04-%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84rpc%E8%B0%83%E7%94%A8/</link><pubDate>Wed, 10 Feb 2021 08:24:19 +0800</pubDate><guid>https://pinkhello.me/posts/04-%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84rpc%E8%B0%83%E7%94%A8/</guid><description>PinkHello https://pinkhello.me/posts/04-%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84rpc%E8%B0%83%E7%94%A8/ -&lt;p>1„ÄÅ‰ªÄ‰πàÂè´RPC?&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;!-- raw HTML omitted -->
&lt;p>&lt;img src="https://pinkhello.me/%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BARPC%E8%B0%83%E7%94%A8/RPC%E8%B0%83%E7%94%A8%E6%9C%8D%E5%8A%A1%E8%BF%87%E7%A8%8B.jpg" alt="RPCË∞ÉÁî®ÊúçÂä°ËøáÁ®ã">&lt;/p>
&lt;p>RPCÊûÑÊàê&lt;/p>
&lt;ul>
&lt;li>RPC Consumer&lt;/li>
&lt;li>RPC Provider&lt;/li>
&lt;li>ConfigServer&lt;/li>
&lt;/ul>
&lt;ul>
&lt;li>1„ÄÅ&lt;code>Provider&lt;/code> ÂêØÂä® &lt;code>ConfigServer&lt;/code> Ê≥®ÂÜåÊúçÂä°&lt;/li>
&lt;li>2„ÄÅ&lt;code>Consumer&lt;/code> ÂêØÂä® &lt;code>ConfigServer&lt;/code> ËÆ¢ÈòÖÊúçÂä°Ôºå&lt;/li>
&lt;li>3„ÄÅÂèëËµ∑Ë∞ÉÁî® &lt;code>Consumer&lt;/code> &amp;mdash;&amp;gt; &lt;code>Provider&lt;/code>&lt;/li>
&lt;li>4„ÄÅÂìçÂ∫îË∞ÉÁî® &lt;code>Consumer&lt;/code> &amp;lt;&amp;mdash; &lt;code>Provider&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>2„ÄÅ‰ªÄ‰πàÊòØ &lt;code>Netty&lt;/code> ? &lt;a href="https://netty.io/">https://netty.io/&lt;/a>&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;!-- raw HTML omitted -->
&lt;p>&lt;img src="https://pinkhello.me/%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BARPC%E8%B0%83%E7%94%A8/netty%E6%A1%86%E6%9E%B6%E5%9B%BE.png" alt="nettyÊ°ÜÊû∂Âõæ">&lt;/p>
&lt;p>3„ÄÅÁé∞ÊúâÁöÑÂºÄÊ∫êÁöÑÈ°πÁõÆÊòØÂê¶‰ΩøÁî®‰∫Ü &lt;code>Netty&lt;/code> ?&lt;/p>
&lt;ul>
&lt;li>Dubbo&lt;/li>
&lt;li>Grpc&lt;/li>
&lt;li>Spark&lt;/li>
&lt;li>&amp;hellip;.&lt;/li>
&lt;/ul>
&lt;p>4„ÄÅ&lt;code>RPC Provider&lt;/code> ÂêØÂä®&lt;/p>
&lt;ul>
&lt;li>&lt;code>Netty Server&lt;/code> ÊñπÂºèÂêØÂä®&lt;/li>
&lt;li>&lt;code>Rpc&lt;/code> ÊúçÂä°ÁöÑÊ≥®ÂÜå
&lt;img src="https://pinkhello.me/%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BARPC%E8%B0%83%E7%94%A8/RPC%E4%B8%8ENetty%E7%BB%93%E5%90%88Provider%E8%B0%83%E7%94%A8%E8%BF%87%E7%A8%8B.png" alt="RPC‰∏éNettyÁªìÂêàProviderË∞ÉÁî®ËøáÁ®ã">&lt;/li>
&lt;/ul>
&lt;p>5„ÄÅ&lt;code>RPC Consumer&lt;/code> ÂêØÂä®&lt;/p>
&lt;ul>
&lt;li>&lt;code>Netty Client&lt;/code> ÊñπÂºèÂêØÂä®&lt;/li>
&lt;li>&lt;code>RPC&lt;/code> Ê≥õÂåñË∞ÉÁî®„ÄÅÈÄöËøáÂ≠óËäÇÁ†ÅÂü∫‰∫éÂèçÂ∞ÑÊù•ÂÆûÁé∞ËøúÁ®ãË∞ÉÂ∫¶&lt;/li>
&lt;li>&lt;code>Consumer&lt;/code> ÊúçÂä°ËÆ¢ÈòÖ&lt;/li>
&lt;li>ÂêØÂä®Êó∂Âª∫Á´ãÈïøËøûÊé•
&lt;img src="https://pinkhello.me/%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BARPC%E8%B0%83%E7%94%A8/RPC%E4%B8%8ENetty%E7%BB%93%E5%90%88Consumer%E8%B0%83%E7%94%A8%E8%BF%87%E7%A8%8B.png" alt="RPC‰∏éNettyÁªìÂêàConsumerË∞ÉÁî®ËøáÁ®ã">&lt;/li>
&lt;/ul>
&lt;p>6„ÄÅ‰ªéÁ¨¨ÂõõÂèØ‰ª•ÁúãÂá∫ÔºåÂ§ö‰∏™ &lt;code>Provider&lt;/code> ÊòØÁî±‰∏Ä‰∏™ &lt;code>NettyServer&lt;/code> Êèê‰æõÁöÑÔºåÈÄöËøá &lt;code>HandlerMap&lt;/code> Êò†Â∞ÑÊâæÂà∞ÂØπÂ∫îÁöÑ &lt;code>Ioc Bean&lt;/code>ÔºåÂÆåÊàêÊúçÂä°Ë∞ÉÁî®&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">ÊúçÂä°Á´Ø
EventLoopGroup bossGroup = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> NioEventLoopGroup(1);
EventLoopGroup workerGroup = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> NioEventLoopGroup();
&lt;span style="color:#8b008b;font-weight:bold">try&lt;/span> {
ServerBootstrap b = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> ServerBootstrap();
b.&lt;span style="color:#658b00">group&lt;/span>(bossGroup, workerGroup)
.&lt;span style="color:#658b00">channel&lt;/span>(NioServerSocketChannel.&lt;span style="color:#658b00">class&lt;/span>)
.&lt;span style="color:#658b00">option&lt;/span>(ChannelOption.&lt;span style="color:#658b00">SO_BACKLOG&lt;/span>, 100)
.&lt;span style="color:#658b00">handler&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> LoggingHandler(LogLevel.&lt;span style="color:#658b00">INFO&lt;/span>))
.&lt;span style="color:#658b00">childHandler&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> ChannelInitializer&amp;lt;SocketChannel&amp;gt;() {
&lt;span style="color:#707a7c">@Override&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">initChannel&lt;/span>(SocketChannel ch) &lt;span style="color:#8b008b;font-weight:bold">throws&lt;/span> Exception {
ChannelPipeline p = ch.&lt;span style="color:#658b00">pipeline&lt;/span>();
p.&lt;span style="color:#658b00">addLast&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> RpcEncoder(RpcRequest.&lt;span style="color:#658b00">class&lt;/span>));
p.&lt;span style="color:#658b00">addLast&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> RpcDecoder(RpcResponse.&lt;span style="color:#658b00">class&lt;/span>));
p.&lt;span style="color:#658b00">addLast&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> RpcHandler());
}});
&lt;span style="color:#228b22">// Start the server.
&lt;/span>&lt;span style="color:#228b22">&lt;/span> ChannelFuture f = b.&lt;span style="color:#658b00">bind&lt;/span>(PORT).&lt;span style="color:#658b00">sync&lt;/span>();
&lt;span style="color:#228b22">// Wait until the server socket is closed.
&lt;/span>&lt;span style="color:#228b22">&lt;/span> f.&lt;span style="color:#658b00">channel&lt;/span>().&lt;span style="color:#658b00">closeFuture&lt;/span>().&lt;span style="color:#658b00">sync&lt;/span>();
} &lt;span style="color:#8b008b;font-weight:bold">finally&lt;/span> {
&lt;span style="color:#228b22">// Shut down all event loops to terminate all threads.
&lt;/span>&lt;span style="color:#228b22">&lt;/span> bossGroup.&lt;span style="color:#658b00">shutdownGracefully&lt;/span>();
workerGroup.&lt;span style="color:#658b00">shutdownGracefully&lt;/span>();
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://pinkhello.me/%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BARPC%E8%B0%83%E7%94%A8/Netty%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86%E5%AE%A2%E6%88%B7%E7%AB%AFTCP%E9%93%BE%E6%8E%A5%E4%B8%8A%E7%9A%84%E8%AF%B7%E6%B1%82.jpg" alt="NettyÂ¶Ç‰ΩïÂ§ÑÁêÜÂÆ¢Êà∑Á´ØTCPÈìæÊé•‰∏äÁöÑËØ∑Ê±Ç">&lt;/p>
&lt;p>&lt;img src="https://pinkhello.me/%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BARPC%E8%B0%83%E7%94%A8/NettyReactor%E5%B7%A5%E4%BD%9C%E6%A1%86%E6%9E%B6%E5%9B%BE.jpg" alt="NettyReactorÂ∑•‰ΩúÊ°ÜÊû∂Âõæ">&lt;/p>
&lt;ul>
&lt;li>&lt;code>BossGroup&lt;/code> -&amp;gt; Â§ÑÁêÜÂÆ¢Êà∑Á´ØÁöÑËØ∑Ê±Ç&lt;/li>
&lt;li>&lt;code>EventGroup&lt;/code> ‚Äî&amp;gt; Â§ÑÁêÜIO &lt;code>Read/Write&lt;/code> Êìç‰Ωú„ÄÅÊâßË°å‰ªªÂä°Á≥ªÁªüTask„ÄÅÂÆöÊó∂‰ªªÂä°&lt;/li>
&lt;li>&lt;code>ChildChannelHandler&lt;/code> ÊñπÂºèÊòØÂØπ &lt;code>ChannelPipeline&lt;/code> ÁöÑËÆæÁΩÆ„ÄÅ&lt;/li>
&lt;li>&lt;code>ChannelPipeline&lt;/code> ÊòØÁõ∏ÂΩì‰∫é‰ªªÂä°ÈìæÁöÑÊ®°Âºè, ÊòØ‰∏Ä‰∏≤ &lt;code>ChannelHandler&lt;/code> ÁöÑÂÆû‰æã&lt;/li>
&lt;li>&lt;code>ChannelHandlerContext&lt;/code> ÊòØ &lt;code>ChannelPipeline&lt;/code> Âíå &lt;code>ChannelHandler&lt;/code> ÁöÑÂÖ≥Á≥ª&lt;/li>
&lt;li>ÊØè‰∏™ÈìæÊé•ÂØπ‰∫é &lt;code>Sever&lt;/code> Á´ØÈÉΩ‰ºöÂàõÂª∫‰∏Ä‰∏™ &lt;code>Channel&lt;/code> ÔºåÂèØ‰ª•Â∞Ü &lt;code>Channel&lt;/code> ÁêÜËß£‰∏∫ &lt;code>Connection&lt;/code> ÔºàÂÖ∂ÂÆûÁúüÊ≠£ÁöÑÊòØ &lt;code>Connection&lt;/code> Â±û‰∫é &lt;code>Channel&lt;/code> ÁöÑ‰∏ÄÈÉ®ÂàÜÔºâ&lt;/li>
&lt;li>ÊØè‰∏™ &lt;code>Channel&lt;/code> ÈÉΩÊúâ‰∏Ä‰∏™Ëá™Â∑±ÁöÑÂîØ‰∏ÄÁöÑ &lt;code>ChannelPipeline&lt;/code> Êìç‰ΩúÔºåÂØπ‰∫éÂÖ∂‰ªñÁöÑ &lt;code>Channel&lt;/code> ÁöÑ &lt;code>ChannelPipeline&lt;/code> ÊòØÈöîÁ¶ªÁöÑ&lt;/li>
&lt;li>&lt;code>RPC Handler&lt;/code> ÊòØÊàë‰ª¨ÂØπ‰∫éËá™Â∑±ÁöÑÊâæÂØª &lt;code>RPC&lt;/code> ÊúçÂä°Â§ÑÁêÜÁöÑ &lt;code>Handler&lt;/code> ÂÆûÁé∞&lt;/li>
&lt;li>&lt;code>RPC Encoder&lt;/code> ÊòØÊàë‰ª¨ÂØπ‰∫éËá™Â∑±ÁöÑÊâæÂØª &lt;code>RPC&lt;/code> Â∫èÂàóÂåñÁöÑÁºñÁ†ÅÁöÑ &lt;code>Handler&lt;/code> ÂÆûÁé∞&lt;/li>
&lt;li>&lt;code>RPC Decoder&lt;/code> ÊòØÊàë‰ª¨ÂØπ‰∫éËá™Â∑±ÁöÑÊâæÂØª &lt;code>RPC&lt;/code> Â∫èÂàóÂåñÁöÑËß£Á†ÅÁöÑ &lt;code>Handler&lt;/code> ÂÆûÁé∞&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">ÂÆ¢Êà∑Á´Ø
EventLoopGroup group = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> NioEventLoopGroup();
&lt;span style="color:#8b008b;font-weight:bold">try&lt;/span> {
Bootstrap b = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> Bootstrap();
b.&lt;span style="color:#658b00">group&lt;/span>(group)
.&lt;span style="color:#658b00">channel&lt;/span>(NioSocketChannel.&lt;span style="color:#658b00">class&lt;/span>)
.&lt;span style="color:#658b00">option&lt;/span>(ChannelOption.&lt;span style="color:#658b00">TCP_NODELAY&lt;/span>, &lt;span style="color:#8b008b;font-weight:bold">true&lt;/span>)
.&lt;span style="color:#658b00">handler&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> ChannelInitializer&amp;lt;SocketChannel&amp;gt;() {
&lt;span style="color:#707a7c">@Override&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">initChannel&lt;/span>(SocketChannel ch) &lt;span style="color:#8b008b;font-weight:bold">throws&lt;/span> Exception {
ChannelPipeline p = ch.&lt;span style="color:#658b00">pipeline&lt;/span>();
p.&lt;span style="color:#658b00">addLast&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> RpcEncoder(RpcResponse.&lt;span style="color:#658b00">class&lt;/span>));
p.&lt;span style="color:#658b00">addLast&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> RpcDecoder(RpcRequest.&lt;span style="color:#658b00">class&lt;/span>));
p.&lt;span style="color:#658b00">addLast&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> RpcClientHandler());
}});
&lt;span style="color:#228b22">// Start the client.
&lt;/span>&lt;span style="color:#228b22">&lt;/span> ChannelFuture f = b.&lt;span style="color:#658b00">connect&lt;/span>(HOST, PORT).&lt;span style="color:#658b00">sync&lt;/span>();
&lt;span style="color:#228b22">// Wait until the connection is closed.
&lt;/span>&lt;span style="color:#228b22">&lt;/span> f.&lt;span style="color:#658b00">channel&lt;/span>().&lt;span style="color:#658b00">closeFuture&lt;/span>().&lt;span style="color:#658b00">sync&lt;/span>();
} &lt;span style="color:#8b008b;font-weight:bold">finally&lt;/span> {
&lt;span style="color:#228b22">// Shut down the event loop to terminate all threads.
&lt;/span>&lt;span style="color:#228b22">&lt;/span> group.&lt;span style="color:#658b00">shutdownGracefully&lt;/span>();
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>7„ÄÅ&lt;code>RPC&lt;/code> Â∫èÂàóÂåñ&lt;/p>
&lt;ul>
&lt;li>‰∫åËøõÂà∂Êï∞ÊçÆ&lt;/li>
&lt;li>Hessian&lt;/li>
&lt;li>Avro&lt;/li>
&lt;li>ProtoBuffer (Protobuf)&lt;/li>
&lt;li>JSON&lt;/li>
&lt;li>XML&lt;/li>
&lt;/ul>
&lt;p>8„ÄÅÂÖ≥‰∫é &lt;code>RPC&lt;/code> ÁöÑÂÆûÁé∞ÊÄùËÄÉ‰∏éÊäÄÊúØËÆ®ËÆ∫&lt;/p>
&lt;ul>
&lt;li>‰∏öÂä°ÊñπÊ≥ï„ÄÅÂõ†‰∏∫ÊòØÊî∂Âà∞ËØ∑Ê±ÇÊ∂àÊÅØËÄåËß¶ÂèëÁöÑÂêéÁª≠Âä®‰ΩúË∞ÉÁî®Ôºå‰∏çÂÅöÈ¢ùÂ§ñËÆæÁΩÆÔºåËÇØÂÆöÊòØ‰ΩøÁî®ÁöÑ &lt;code>WorkGroup&lt;/code> ÈáåÈù¢ÁöÑÁ∫øÁ®ãÊìç‰ΩúÁöÑ„ÄÇ
ËÄå‰Ωú‰∏∫‰∏öÂä°Â±ÇÔºå‰∏çÂ∫îËØ•‰∏éÂ∫ïÂ±ÇÂÖ≥ËÅîÔºåÂ∫îËØ•ÂàáÂâ≤ÂºÄÊù•ÔºåÂäøÂøÖ‰ºöÂºïÂÖ•ÁúüÁöÑ‰∏öÂä°‰æßÁ∫øÁ®ãÊ±†„ÄÇ
ÈÇ£‰πàÂ¶Ç‰ΩïÂºïÁî®„ÄÅÊÄé‰πàÂºïÁî®Ôºü(ÂÖ≥‰∫é ‰∏öÂä°Á∫øÁ®ãÊ±† ‰∏é &lt;code>WorkGroup&lt;/code> ÁöÑ &lt;code>EvenLoop&lt;/code> ÁöÑÊÄùËÄÉ )&lt;/li>
&lt;li>ÂÖ≥‰∫é &lt;code>RPC&lt;/code> Ë∞ÉÁî®Â§ßÈÉ®ÂàÜÊòØÂêåÊ≠•ÁöÑË∞ÉÁî®ÔºåËÄå &lt;code>Netty&lt;/code> Â∫ïÂ±ÇÊòØÂÆåÂÖ®ÂºÇÊ≠•‰∫ã‰ª∂Êú∫Âà∂ÔºåÂú®RPCÊ°ÜÊû∂Â±ÇÈù¢Â¶Ç‰ΩïÂÆûÁé∞ÂêåÊ≠•ÁöÑË∞ÉÁî®ÊñπÂºèÁöÑÔºü&lt;/li>
&lt;li>Âü∫‰∫é &lt;code>TCP&lt;/code> ÁöÑÈïøÈìæÊé•Ë∞ÉÁî®ÔºåÂú® &lt;code>RPC&lt;/code> ‰∏ä‰Ω†‰ºöÊÉ≥Âà∞ÂÖ∂‰ªñÁöÑÂì™‰∫õ‰∏ú‰∏úÔºü&lt;/li>
&lt;li>Âú®Ê≠§ÁéØÂ¢É‰∏ãÔºåÊàëÊ≤°Êúâ‰ªãÁªç &lt;code>RPC&lt;/code> ÊúçÂä°‰∫é IOCÂÆπÂô®ÁöÑÁªìÂêàÔºåÂèØ‰ª•ÊÄùËÄÉ‰∏Ä‰∏ãÔºåÂ¶Ç‰ΩïÂÅöÂà∞ Ê≥®Ëß£Êú∫Âà∂„ÄÅ&lt;code>JAVA CONFIG&lt;/code> Êú∫Âà∂„ÄÅ&lt;code>XML SCHEMA&lt;/code> Êú∫Âà∂Êù•ÂÅö?
&lt;ul>
&lt;li>GUICE&lt;/li>
&lt;li>SPRING&lt;/li>
&lt;li>SPI&lt;/li>
&lt;li>&amp;hellip;.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
- https://pinkhello.me/posts/04-%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84rpc%E8%B0%83%E7%94%A8/ - PinkHello, All Rights Reserved</description></item><item><title>ÈìæÊé•</title><link>https://pinkhello.me/links/</link><pubDate>Tue, 09 Feb 2021 10:38:21 +0800</pubDate><guid>https://pinkhello.me/links/</guid><description>PinkHello https://pinkhello.me/links/ -- https://pinkhello.me/links/ - PinkHello, All Rights Reserved</description></item><item><title>ÂÖ≥‰∫éÊàë</title><link>https://pinkhello.me/about/</link><pubDate>Tue, 09 Feb 2021 10:36:43 +0800</pubDate><guid>https://pinkhello.me/about/</guid><description>PinkHello https://pinkhello.me/about/ -&lt;hr>
&lt;h2 id="-‰∏™‰∫∫‰ªãÁªç">üë∑ ‰∏™‰∫∫‰ªãÁªç&lt;/h2>
&lt;p>PinkHello &lt;img src="https://views.whatilearened.today/views/github/pinkhello/pinkhello.svg" alt="views">&lt;/p>
&lt;p>&lt;img src="https://github-readme-stats.vercel.app/api?username=pinkhello&amp;amp;show_icons=true&amp;amp;theme=vue&amp;amp;hide_border=true&amp;amp;line_height=20&amp;amp;count_private=true" alt="">&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">PinkHello := &amp;amp;Info {
Name: &lt;span style="color:#cd5555">&amp;#34;PinkHello&amp;#34;&lt;/span>,
Occupation: &lt;span style="color:#cd5555">&amp;#34;Full Stack Developer&amp;#34;&lt;/span>,
Email: &lt;span style="color:#cd5555">&amp;#34;lee123lee123@163.com&amp;#34;&lt;/span>,
Wechat: &lt;span style="color:#cd5555">&amp;#34;chess_1&amp;#34;&lt;/span>,
Website: &lt;span style="color:#cd5555">&amp;#34;https://pinkhello.me&amp;#34;&lt;/span>,
Location: &lt;span style="color:#cd5555">&amp;#34;Shanghai China&amp;#34;&lt;/span>
}
&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;h2 id="-ÊäÄËÉΩ">‚ö° ÊäÄËÉΩ&lt;/h2>
&lt;p>Language&lt;br>
&lt;img src="https://img.shields.io/badge/-Java-black?style=flat-square&amp;amp;logo=Java" alt="Java">
&lt;img src="https://img.shields.io/badge/-Go-black?style=flat-square&amp;amp;logo=Go" alt="Go">
&lt;img src="https://img.shields.io/badge/-Python-black?style=flat-square&amp;amp;logo=Python" alt="Python">
&lt;img src="https://img.shields.io/badge/-JavaScript-black?style=flat-square&amp;amp;logo=JavaScript" alt="JavaScript">&lt;/p>
&lt;p>Framework&lt;br>
&lt;img src="https://img.shields.io/badge/-Vue-000000?style=flat-square&amp;amp;logo=Vue.js" alt="Vue">
&lt;img src="https://img.shields.io/badge/-Spring-black?style=flat-square&amp;amp;logo=Spring" alt="Spring">
&lt;img src="https://img.shields.io/badge/-Spring%20Boot(Cloud)-black?style=flat-square&amp;amp;logo=Spring%20Boot(Cloud)" alt="Spring Boot(Cloud)">
&lt;img src="https://img.shields.io/badge/-Dubbo-black?style=flat-square&amp;amp;logo=Dubbo" alt="Dubbo">
&lt;img src="https://img.shields.io/badge/-Flask-black?style=flat-square&amp;amp;logo=Flask" alt="Flask">
&lt;img src="https://img.shields.io/badge/-Echo-black?style=flat-square&amp;amp;logo=Echo" alt="Echo">
&lt;img src="https://img.shields.io/badge/-Gin-black?style=flat-square&amp;amp;logo=Gin" alt="Gin">
&lt;img src="https://img.shields.io/badge/-Grpc-black?style=flat-square&amp;amp;logo=Grpc" alt="Grpc">&lt;/p>
&lt;p>Tools&lt;br>
&lt;img src="https://img.shields.io/badge/-Redis-black?style=flat-square&amp;amp;logo=Redis" alt="Redis">
&lt;img src="https://img.shields.io/badge/-MySQL-black?style=flat-square&amp;amp;logo=mysql" alt="MySQL">
&lt;img src="https://img.shields.io/badge/-Nginx-black?style=flat-square&amp;amp;logo=Nginx" alt="Nginx">
&lt;img src="https://img.shields.io/badge/-MongoDB-black?style=flat-square&amp;amp;logo=MongoDB" alt="MongoDB">
&lt;img src="https://img.shields.io/badge/-Pulsar-black?style=flat-square&amp;amp;logo=Pulsar" alt="Pulsar">
&lt;img src="https://img.shields.io/badge/-Kafka-black?style=flat-square&amp;amp;logo=Kafka" alt="Kafka">
&lt;img src="https://img.shields.io/badge/-Nsq-black?style=flat-square&amp;amp;logo=Nsq" alt="Nsq">
&lt;img src="https://img.shields.io/badge/-RabbitMQ-black?style=flat-square&amp;amp;logo=RabbitMQ" alt="RabbitMQ">
&lt;img src="https://img.shields.io/badge/-GitHub-181717?style=flat-square&amp;amp;logo=github" alt="GitHub">&lt;/p>
&lt;p>Others&lt;br>
&lt;img src="https://img.shields.io/badge/-Kubernetes-black?style=flat-square&amp;amp;logo=Kubernetes" alt="Kubernetes">
&lt;img src="https://img.shields.io/badge/-Docker-black?style=flat-square&amp;amp;logo=Docker" alt="Docker">
&lt;img src="https://img.shields.io/badge/-Linux-black?style=flat-square&amp;amp;logo=Linux" alt="Linux">
&lt;img src="https://img.shields.io/badge/-Deepin-007CFF?style=flat-square&amp;amp;logo=deepin" alt="Deepin">
&lt;img src="https://img.shields.io/badge/-Centos-262577?style=flat-square&amp;amp;logo=Centos" alt="Centos">
&lt;img src="https://img.shields.io/badge/-Raspberry%20Pi-C51A4A?style=flat-square&amp;amp;logo=Raspberry-Pi" alt="Raspberry Pi">&lt;/p>
&lt;hr>
&lt;h2 id="-‰∏™‰∫∫ÂºÄÊ∫êÈ°πÁõÆ">üê≥ ‰∏™‰∫∫ÂºÄÊ∫êÈ°πÁõÆ&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align:left">È°πÁõÆ&lt;/th>
&lt;th style="text-align:left">ÊèèËø∞&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align:left">&lt;a href="https://github.com/pinkhello/gopush">GoPush&lt;/a>&lt;/td>
&lt;td style="text-align:left">‰∏Ä‰∏™ÂÆûÊó∂Êé®ÈÄÅÁªÑ‰ª∂&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">&lt;a href="https://github.com/pinkhello/spring-boot-starter-dubbo">spring-boot-starter-dubbo&lt;/a>&lt;/td>
&lt;td style="text-align:left">dubbo-spring-boot-ËÑöÊâãÊû∂&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">&lt;a href="https://github.com/pinkhello/go-starter">go-starter&lt;/a>&lt;/td>
&lt;td style="text-align:left">GoÊúçÂä°ÂºÄÂèëËÑöÊâãÊû∂&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;hr>
&lt;h2 id="-2021-okr-ËøõÂ∫¶">üöÄ 2021 OKR ËøõÂ∫¶&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align:left">Âä®‰Ωú&lt;/th>
&lt;th style="text-align:left">ËøõÂ∫¶&lt;/th>
&lt;th style="text-align:left">ÁõÆÊ†á&lt;/th>
&lt;th style="text-align:left">Áº∫Èô∑&lt;/th>
&lt;th style="text-align:left">ÂÖ∂‰ªñ&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align:left">üëØ GoÊúçÂä°ÂºÄÂèëËÑöÊâãÊû∂&lt;/td>
&lt;td style="text-align:left">done&lt;/td>
&lt;td style="text-align:left">&lt;a href="https://github.com/pinkhello/go-starter">go-starter&lt;/a>&lt;/td>
&lt;td style="text-align:left">ut&lt;/td>
&lt;td style="text-align:left">-&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">üíµ GoÊúçÂä°ÂºÄÂèëËÑöÊâãÊû∂ÂºÄÂèë‰∏Ä‰∏™ÁÆÄÂçïÂâçÂêéÁ´ØÁ≥ªÁªü&lt;/td>
&lt;td style="text-align:left">done&lt;/td>
&lt;td style="text-align:left">&lt;a href="http://121.4.242.26">Êàø‰∫ßCRM‰ø°ÊÅØÁ≥ªÁªü&lt;/a> test/123456&lt;/td>
&lt;td style="text-align:left">-&lt;/td>
&lt;td style="text-align:left">BEÈááÁî®ÁöÑ&lt;a href="https://github.com/pinkhello/go-starter">go-starter&lt;/a>, FE ÈááÁî®ÁöÑ&lt;a href="https://pro.antdv.com/">ant-design-vue-pro&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">üê≥ K8SÂéüÁêÜ&lt;/td>
&lt;td style="text-align:left">running&lt;/td>
&lt;td style="text-align:left">&lt;a href="https://pinkhello.me/categories/k8s/">K8SÂçöÂÆ¢ÊàêÊ°£&lt;/a>&lt;/td>
&lt;td style="text-align:left">-&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">üöÄ RocketMQ Ê∫ê‰ª£Á†ÅÈòÖËØª(Java)&lt;/td>
&lt;td style="text-align:left">running&lt;/td>
&lt;td style="text-align:left">&lt;a href="https://pinkhello.me/categories/rocketmq/">RocketMQÂçöÂÆ¢ÊàêÊ°£&lt;/a>&lt;/td>
&lt;td style="text-align:left">-&lt;/td>
&lt;td style="text-align:left">-&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">üöÄ RocketMQ ÂÆ¢Êà∑Á´Ø‰ª£Á†ÅÈòÖËØª(Compare Go/Java)&lt;/td>
&lt;td style="text-align:left">running&lt;/td>
&lt;td style="text-align:left">&lt;a href="https://pinkhello.me/categories/rocketmq/">RocketMQÂçöÂÆ¢ÊàêÊ°£&lt;/a>&lt;/td>
&lt;td style="text-align:left">-&lt;/td>
&lt;td style="text-align:left">-&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">üòÑ MySQLÂÆûÁé∞ÂéüÁêÜËß£Êûê&lt;/td>
&lt;td style="text-align:left">prepare&lt;/td>
&lt;td style="text-align:left">ÂçöÂÆ¢ÊàêÊ°£&lt;/td>
&lt;td style="text-align:left">-&lt;/td>
&lt;td style="text-align:left">-&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">üè´ Êï∞ÊçÆÁªìÊûÑ‰∏éÁÆóÊ≥ï‰πãÁæé&lt;/td>
&lt;td style="text-align:left">prepare&lt;/td>
&lt;td style="text-align:left">ÂçöÂÆ¢ÊàêÊ°£&lt;/td>
&lt;td style="text-align:left">-&lt;/td>
&lt;td style="text-align:left">-&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
- https://pinkhello.me/about/ - PinkHello, All Rights Reserved</description></item><item><title>14 Â∑•‰ΩúÁ∫™ÂÆû2020</title><link>https://pinkhello.me/posts/14-%E5%B7%A5%E4%BD%9C%E7%BA%AA%E5%AE%9E2020/</link><pubDate>Mon, 10 Feb 2020 10:00:19 +0800</pubDate><guid>https://pinkhello.me/posts/14-%E5%B7%A5%E4%BD%9C%E7%BA%AA%E5%AE%9E2020/</guid><description>PinkHello https://pinkhello.me/posts/14-%E5%B7%A5%E4%BD%9C%E7%BA%AA%E5%AE%9E2020/ -&lt;h1 id="ÊØèÊó•‰∏ÄÊÄùÁØá">ÊØèÊó•‰∏ÄÊÄùÁØá&lt;/h1>
&lt;h2 id="2019-10-12-ÊØèÊó•‰∏ÄÊÄù-mysql-walÊäÄÊúØ-Âíå-ringbuffer-ÊÄùÊÉ≥Â•Ω‰∏ÄËá¥">[2019-10-12 ÊØèÊó•‰∏ÄÊÄù] Mysql WALÊäÄÊúØ Âíå RingBuffer ÊÄùÊÉ≥Â•Ω‰∏ÄËá¥?&lt;/h2>
&lt;h2 id="2019-10-14-ÊØèÊó•‰∏ÄÊÄù-jwt-Áª≠Á≠æËØ•Â¶Ç‰ΩïÂÅö">[2019-10-14 ÊØèÊó•‰∏ÄÊÄù] JWT Áª≠Á≠æËØ•Â¶Ç‰ΩïÂÅö?&lt;/h2>
&lt;h2 id="2019-10-16-ÊØèÊó•‰∏ÄÊÄù-tcpip-ÂçèËÆÆÂÖ∑‰ΩìÊåáÂì™‰∫õ">[2019-10-16 ÊØèÊó•‰∏ÄÊÄù] TCP/IP ÂçèËÆÆÂÖ∑‰ΩìÊåáÂì™‰∫õ?&lt;/h2>
&lt;blockquote>
&lt;p>Êàë‰ª¨ÈÉΩÁü•ÈÅìÁΩëÁªúÊòØ7Â±ÇÊ®°ÂûãÔºåÂ∫îË°®‰ºö‰º†ÁΩëÊï∞Áâ©Ôºå
Áé∞Âú®ÊàëÂè™ËÆ®ËÆ∫Â∫î‰º†ÁΩëÊï∞Ëøô4Â±Ç„ÄÇTCP/IPÂçèËÆÆÂ∫îËØ•Ë¢´Áß∞‰∏∫TCP/IPÊóèÔºå
ÊàëÁöÑÁêÜËß£‰ªñ‰∏çÊòØÂ±û‰∫éÂçï‰∏™ÁöÑÂçèËÆÆÁ±ªÂûãÔºåÊòØ‰∏Ä‰∏™ÁªüÁß∞ÔºåÁü•ÈÅìÁΩëÁªúÊ®°ÂûãÊ†∏ÂøÉËÆæËÆ°ÊÄùÊÉ≥ÊòØÂàÜÂ±ÇÔºå‰∏∫‰ªÄ‰πàÂàÜÂ±ÇÔºåÂàÜÂ±Ç‰ªéËÆæËÆ°‰∏äÂíåÂÆûÁé∞ÈöæÂ∫¶‰∏äÈÉΩÁÆÄÂçïÂæàÂ§öÔºåÂì™‰∏ÄÂ±ÇÈúÄË¶Å‰øÆÊîπÂè™ÈúÄË¶Å‰øÆÊîπËøô‰∏ÄÂ±Ç„ÄÇ&lt;/p>
&lt;ul>
&lt;li>Â∫îÁî®Â±ÇÔºåÂÉèÊúÄÂ∏∏ËßÅÁöÑhttp„ÄÅftp„ÄÅdns„ÄÅrtsp„ÄÅrtmpÁ≠âÁ≠âÂçèËÆÆÈÉΩÊòØÂ±û‰∫éËøôÁ±ªÔºå&lt;/li>
&lt;li>‰º†ËæìÂ±ÇÂë¢ÊåâÁÖß‰º†ËæìÁ±ªÂûãÂèàÂàÜ‰∫ÜTCPÂíåUDP,&lt;/li>
&lt;li>ÁΩëÁªúÂ±ÇÔºåÊòØÊï∞ÊçÆÂåÖ‰∫§‰∫íÁöÑÂ±ÇÈù¢Ôºå&lt;/li>
&lt;li>Êï∞ÊçÆÈìæË∑ØÂ±ÇÊòØÂ§ÑÁêÜÁΩëÂç°„ÄÅÊìç‰ΩúÁ≥ªÁªüÁ≠âÁ≠âËΩØÁ°¨ÊäΩË±°Âá∫ÁöÑÂèØËßÅÈÉ®ÂàÜ„ÄÇ&lt;/li>
&lt;/ul>
&lt;p>‰∏æ‰∏Ä‰∏™Ê†óÂ≠êÔºå‰∏Ä‰∏™httpËØ∑Ê±ÇÔºåÂú®Â∫îÁî®Â±ÇÈù¢ÊòØÂÆåÊï¥ÁöÑÔºåÂêéÈù¢Ë¢´‰º†ËæìÂ±ÇÔºàTCPÂ±ÇÔºâË¢´ÂàÜÂåÖÔºåÂπ∂Êâì‰∏äÂ∫èÂè∑Ê†áËÆ∞ÔºåÂÜçËøõÂÖ•ÁΩëÁªúÂ±ÇÔºàIPÂ±ÇÔºâÊ∑ªÂä†IPÈ¶ñÈÉ®ÔºàÁõÆÊ†ámacÂú∞ÂùÄÁ≠âÁ≠âÔºâÔºå
‰∏ãÈù¢Â∞±ÊòØÂºÄÂßãÁñØÁãÇÁöÑÂèëÈÄÅ‰∫ÜÔºåÊé•Êî∂Êñπ‰∏ÄÊ†∑ÊòØËøô‰∏™ËøáÁ®ãÁöÑÈÄÜÂ∫è„ÄÇÂ∫îÁî®Â§ÑÁêÜÂÆåÊàêÂêéÈù¢ÁöÑÂìçÂ∫îËøáÁ®ã‰∏éËØ∑Ê±ÇËøáÁ®ã‰∏ÄÊ†∑ÁöÑ‰∏Ä‰∏™ËøáÁ®ã„ÄÇÂêåÊó∂ÂèØ‰ª•Êâ©Â±ïÂá∫L4‰∏éL7ÁöÑÈóÆÈ¢òÔºå
ÂêÑËá™ÊòØÂ¶Ç‰ΩïÂéªÂÆûÁé∞Ë¥üËΩΩÂùáË°°ÁöÑÔºüL4ÊòØÂèØ‰ª•ÁúãÂá∫ÊòØÂü∫‰∫é‰º†ËæìÂ±ÇÂç≥TCPÂ±ÇÂ∑•‰ΩúÔºàÈÄöËøáÂèëÂ∏ÉVIPÔºàÁ¨¨‰∏âÂ±ÇÔºâ‰ª•ÂèäÁ¨¨ÂõõÂ±ÇÁ´ØÂè£ÔºâÔºåL7Âü∫‰∫éÂ∫îÁî®Â±ÇÂ∑•‰ΩúÔºàÁ¨¨ÂõõÂ±ÇÂü∫Á°Ä‰∏ä+ËÄÉËôëÂ∫îÁî®ÁâπÂæÅÔºâÔºå
ÊØîÂ¶ÇHTTPÁöÑURL„ÄÅÂÆ¢Êà∑Á´ØÁöÑÁ±ªÂà´„ÄÅËØ≠Ë®ÄÁ±ªÂûãÁ≠âÁ≠â„ÄÇ&lt;/p>
&lt;/blockquote>
&lt;h2 id="2019-10-18-ÊØèÊó•‰∏ÄÊÄù‰∏ÄÁßçÂú∫ÊôØrabbitmq-ÁöÑ-exchange-‰∏∫-fanout-Á±ªÂûãÁªëÂÆöÂà∞Â§ö‰∏™queue-‰ªÄ‰πàÊÉÖÂÜµ‰ºöËß¶Âèë-rabbitmq-ÊµÅÊéßÂ¶Ç‰ΩïËß£ÂÜ≥">[2019-10-18 ÊØèÊó•‰∏ÄÊÄù]‰∏ÄÁßçÂú∫ÊôØÔºårabbitmq ÁöÑ Exchange ‰∏∫ fanout Á±ªÂûãÔºåÁªëÂÆöÂà∞Â§ö‰∏™queue, ‰ªÄ‰πàÊÉÖÂÜµ‰ºöËß¶Âèë rabbitmq ÊµÅÊéßÔºüÂ¶Ç‰ΩïËß£ÂÜ≥Ôºü&lt;/h2>
&lt;h2 id="2019-10-22-ÊØèÊó•‰∏ÄÊÄùidÂ∫èÂàóÁîü‰∫ßÂô®ÊÄé‰πàÂÆûÁé∞Âë¢">[2019-10-22 ÊØèÊó•‰∏ÄÊÄù]IDÂ∫èÂàóÁîü‰∫ßÂô®ÊÄé‰πàÂÆûÁé∞Âë¢Ôºü&lt;/h2>
&lt;blockquote>
&lt;p>uuidÁîüÊàê&lt;/p>
&lt;ul>
&lt;li>Âü∫‰∫éÊó∂Èó¥Ôºà60‰ΩçutcÊó∂Èó¥ Âíå Êó∂Èó¥Â∫èÂàóÂÄº14‰ΩçÔºå‰ª•ÂèämacÂú∞ÂùÄÔºâ&lt;/li>
&lt;li>Âü∫‰∫éÂêçÁß∞ÔºàÈíàÂØπÂëΩÂêçÁ©∫Èó¥dns„ÄÅurlÁ≠âÂàÜÈÖçÔºåÊääÂêçÁß∞ËΩ¨ÊàêÂ≠óËäÇÂ∫èÂàóÔºåÂÜçÁî®md5Êàñsha-1‰∏éÂëΩÂêçÁ©∫Èó¥Ê†áËØÜËøõË°åËÆ°ÁÆóÔºå‰∫ßÁîüÂìàÂ∏åÁªìÊûúÔºâ&lt;/li>
&lt;li>Âü∫‰∫éÈöèÊú∫Êï∞ÔºàÂØÜÁ†ÅÂ≠¶ÈöèÊú∫Êï∞ÔºåÁ≥ªÁªüÁöÑÁ°¨ÁõòÂÜÖÂ≠òÁ∫øÁ®ãÂ†ÜÊ†àËøõÁ®ãÂè•ÊüÑÁ≠âsha-1ÁîüÊàêÂìàÂ∏åÁªìÊûúÔºâ&lt;/li>
&lt;/ul>
&lt;p>snowflakeÔºå64bitÔºålongÂûãID&lt;/p>
&lt;ul>
&lt;li>IDÁîüÊàêÊñπÂºè 1bitÔºà‰∏ç‰ΩøÁî®ÔºâÔºå41bitÊó∂Èó¥Êà≥ÔºàÂΩìÂâçÊØ´ÁßíÊï∞„ÄÅ69Âπ¥‰∏ÄËΩÆÂõûÔºâÔºå10bitÊú∫Âô®Á†ÅÔºà1024Âè∞Ôºå5bitÊï∞ÊçÆ‰∏≠ÂøÉÔºå5bitÊú∫Âô®IDÔºâÔºå12bit‰Ωú‰∏∫ÊØ´ÁßíÂÜÖÂ∫èÂàóÂè∑ÔºàÂçïÊú∫ÁêÜËÆ∫ 409.6w/sÔºâ&lt;/li>
&lt;li>Èõ™Ëä±ÁÆóÊ≥ïÔºåÂ§öÂè∞Êú∫Âô®ÔºåÊúâÂõ†‰∏∫Êó∂ÈíüÂõûÊã®ÂØºËá¥ÁöÑIDÁîüÊàêÈóÆÈ¢òÔºåÂΩìÁÑ∂ÂèØ‰ª•ÈÄöËøáÂèëÁîüÊó∂ÈíüÂõûÊã®Âêé‰∏Ä‰∏™ÈòàÂÄºÔºåÂú®ÈòàÂÄºÂÜÖÂàô‰∏çÂÖÅËÆ∏‰∫ßÁîüÊñ∞ÁöÑIDÔºåÂêåÊ≠•ÈòªÂ°ûÔºåÂú®ÈòàÂÄºÂ§ñÈáçÊñ∞ËÆæÁΩÆÊú∫Âô®IDÊù•Ëß£ÂÜ≥&lt;/li>
&lt;li>github.com/baidu/uid-generator ÊäÄÊúØËÄÅÈìÅÁôæÂ∫¶ÂºÄÊ∫êÁöÑÂü∫‰∫ésnowflakeÂÆûÁé∞ÁöÑIDÁîüÊàêÂô®ÔºåÂèØ‰ª•ÂÄüÈâ¥Á†îËØª‰∏Ä‰∏ã&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;h2 id="2019-11-01-ÊØèÊó•‰∏ÄÊÄùÊàë‰ª¨Â∏∏ËØ¥ÁöÑÈôêÊµÅÊòØ‰ªÄ‰πà‰∏∫‰ªÄ‰πàË¶ÅÈôêÊµÅÈôêÊµÅÊúâÂì™‰∫õÊñπÂºè">[2019-11-01 ÊØèÊó•‰∏ÄÊÄù]Êàë‰ª¨Â∏∏ËØ¥ÁöÑÈôêÊµÅÊòØ‰ªÄ‰πàÔºü‰∏∫‰ªÄ‰πàË¶ÅÈôêÊµÅÔºüÈôêÊµÅÊúâÂì™‰∫õÊñπÂºèÔºü&lt;/h2>
&lt;blockquote>
&lt;p>Êàë‰ª¨Â∏∏ËØ¥ÁöÑÈôêÊµÅÔºåÈ°æÂêçÊÄù‰πâÂç≥ÈôêÂà∂ÊµÅÈáè. ÈôêÂà∂Á≥ªÁªüÁöÑËæìÂÖ•ÂíåËæìÂá∫
Â∏∏Áî®ÁöÑÈôêÊµÅÂèëÂ±ïËá≥‰ªäÔºåÊúâÂõõÁßçÊñπÂºè&lt;/p>
&lt;ul>
&lt;li>Âõ∫ÂÆöÊó∂Èó¥ËÆ°Êï∞Âô®&lt;/li>
&lt;li>ÊºèÊ°∂&lt;/li>
&lt;li>‰ª§ÁâåÊ°∂&lt;/li>
&lt;li>ÊªëÂä®Á™óÂè£ËÆ°Êï∞Âô®&lt;/li>
&lt;/ul>
&lt;p>Âõ∫ÂÆöÁ™óÂè£ËÆ°Êï∞Âô®Ôºö‰ª•Âçï‰ΩçÊó∂Èó¥ÂÜÖËøõÂÖ•Á≥ªÁªüÔºàÁ≥ªÁªüÁ∫ßÂà´ÔºâÊàñËÄÖÊüê‰∏Ä‰∏™Âçï‰∏ÄÊé•Âè£ÊúçÂä°ÔºàÁ≥ªÁªüÊúçÂä°Á∫ßÂà´ÔºâËØ∑Ê±ÇÊ¨°Êï∞ÔºåÂú®Ëøô‰∏™Âçï‰ΩçÊó∂Èó¥ÂÜÖÁöÑË∂ÖËøáÊ¨°Êï∞ÔºåÊãíÁªùÊúçÂä°ÊàñËÄÖÊõ¥Êç¢ÂÖ∂‰ªñÊñπÊ°àÔºàÈôçÁ∫ß„ÄÅÁÜîÊñ≠ÔºâËææÂà∞ÈôêÊµÅÁõÆÁöÑ„ÄÇ&lt;/p>
&lt;blockquote>
&lt;p>ÂèØ‰ª•ÁúãÂá∫ÔºåÊòéÊòæÁöÑÁº∫ÁÇπÔºå‰ªéÊï¥‰ΩìÊõ≤Á∫ø‰∏äÔºåÊØõÂà∫Áé∞Ë±°ÈùûÂ∏∏‰∏•ÈáçÔºåÂÅáËÆæÂçï‰ΩçÊó∂Èó¥ 1s ÂÜÖÈôêÂà∂ 100 Ê¨°ÔºåÂú®0-10msÂÜÖÊàëÂ∑≤ÁªèËØ∑Ê±ÇË∂ÖËøá100Ê¨°‰∫ÜÔºåÂêéÈù¢ÁöÑËØ∑Ê±ÇÂÖ®ÈÉ®ÊãíÁªùÊàñËÄÖÂÅöÂÖ∂‰ªñÂ§ÑÁêÜ‰∫Ü„ÄÇÊó†Ê≥ïÊéßÂà∂Âçï‰ΩçÊó∂Èó¥ÂÜÖÁöÑÁ™ÅÂèëÊµÅÈáè„ÄÇ&lt;/p>
&lt;/blockquote>
&lt;p>ÊºèÊ°∂: Ê°∂ÁöÑÂÆπÈáèÂõ∫ÂÆöÔºåÊ°∂ÊµÅÂá∫ÁöÑÈÄüÁéáÊÅíÂÆö„ÄÇÊ°∂Êª°ÂàôÈôêÊµÅ„ÄÇ‰πüÊòØÊó†Ê≥ïÂ∫îÂØπÁ™ÅÂèëÊµÅÈáè&lt;/p>
&lt;p>‰ª§ÁâåÊ°∂Ôºö ËøòÊòØÊ°∂ÁöÑÊñπÂºèÔºå Ê°∂‰∏≠Â≠òÊîæÁöÑÊòØ token ÔºåÊ†πÊçÆÈôêÊµÅÁöÑÂ§ßÂ∞èÔºå token ‰ª•ÊÅíÂÆöÈÄüÁéáËøõÂÖ•Ê°∂‰∏≠ÔºåËÆæÁΩÆÊ°∂ÁöÑÊúÄÂ§ßÁöÑ token ÂÆπÈáèÔºåÂΩìÊ°∂Êª°Êó∂ÂÄôÊãíÁªùÊñ∞Ê∑ªÂä†ÁöÑtoken
ÔºåÊàñËÄÖÁõ¥Êé•‰∏¢ÂºÉ„ÄÇÊâÄÊúâËØ∑Ê±ÇËøõÂÖ•ÂÖàËé∑Âèñ‰ª§ÁâåÔºåÂæóÂà∞‰ª§ÁâåÁªßÁª≠‰∏ãÈù¢ÁöÑ‰∏öÂä°ÈÄªËæëÔºåÂ§ÑÁêÜÂÆåÊàêÂà†Èô§ token„ÄÇ&lt;/p>
&lt;blockquote>
&lt;p>Áõ∏ÊØî ÊºèÊ°∂Ôºå ‰∏ÄÂÆöÁ®ãÂ∫¶‰∏äÂÖÅËÆ∏Á™ÅÂèëÊµÅÈáèÔºåÂπ≥ÊªëÈôêÊµÅÔºåÂõ†‰∏∫ Ê°∂ ‰∏≠ÁöÑ token ÊòØÂåÄÈÄüÊîæÂÖ•ÁöÑÔºåÊäµÂæ°Á™ÅÂèëÊµÅÈáè„ÄÇÊ°∂ÁöÑ token Êï∞Èáè‰∏ç‰ºöË∂ÖËøáÁªôÂÆöÁöÑÊúÄÂ§ßÂÄº„ÄÇ
ÂèÇËÄÉ guava rate limiter&lt;/p>
&lt;/blockquote>
&lt;p>ÊªëÂä®Á™óÂè£ËÆ°Êï∞Âô®:(ÂèÇËÄÉSentinel‰∏≠‰ΩøÁî®ÁöÑÈªòËÆ§ÈôêÊµÅÊñπÂºè)
ÊòØÂØπÂõ∫ÂÆöÊó∂Èó¥Á™óÂè£ËÆ°Êï∞Âô®ÁöÑ‰ºòÂåñÔºåÂ∞±ÊòØ‰∏∫‰∫ÜËß£ÂÜ≥Âõ∫ÂÆöÊó∂Èó¥ËÆ°Êï∞Âô®ÁöÑÊó†Ê≥ïÈù¢ÂØπÁ™ÅÂèëÊµÅÈáèÔºå‰Ωï‰∏∫ÊªëÂä®Á™óÂè£Âë¢Ôºü
ÂÅáËÆæÂçï‰ΩçÊó∂Èó¥ÂÆö‰Ωç 1sÔºå ËÆ°Êï∞Âô®ÈôêÂà∂Âú® 1000 Ê¨°Ôºå ÂÜçÂ∞ÜËÄÖ 1s ÂàíÂàÜ‰∏∫ 100ms ‰∏∫‰∏Ä‰∏™Â∞èÊ†ºÂ≠êÔºåÊÄªÂÖ± 10 ‰∏™Ê†ºÂ≠êÔºå
ÊØè‰∏™Ê†ºÂ≠êËøòÊúâËÆ°Êï∞Âô®ÔºåÂΩì‰∏Ä‰∏™ËØ∑Ê±ÇËøõÊù•ÔºåÂú®ÂØπÂ∫îÁöÑÊó∂Èó¥Ê†ºÂ≠êÈáåÈù¢ÁöÑËÆ°Êï∞Âô® +1 ÔºåÂè™Ë¶ÅÊÄªÁöÑËøô‰∏™Âçï‰ΩçÊó∂Èó¥ÂÜÖÊâÄÊúâÁöÑÊó∂Èó¥Ê†ºÂ≠êËÆ°Êï∞Âô®ÊÄªÂíåÂ∞è‰∫é ÈôêÂà∂Ê¨°Êï∞ÔºåÂ∞±‰∏ç‰ºöÂêØÂä®ÈôêÊµÅ‰ΩúÁî®„ÄÇ
ÂèØ‰ª•ÁúãÂá∫Êù•ÔºåÂÅáÂ¶ÇÊàëÁöÑÂàíÂàÜÁöÑÊ†ºÂ≠êÂæàÂ∞èÔºåÊªëÂä®Á™óÂè£ÊªöÂä®Â∞ÜÊòØË∂äÂπ≥ÊªëÁöÑ„ÄÇ
psÔºö 0.00 - 1.00 Êúâ 10 ‰∏™Ê†ºÂ≠êÔºåËøôÊòØ‰∏Ä‰∏™ÊªëÂä®Á™óÂè£ÊúüÔºåÁÑ∂Âêé 0.10-1.10ÊòØ‰∏Ä‰∏™Á™óÂè£ÊúüÔºåËøôÊ†∑ËÆ°ÁÆóÁöÑ&lt;/p>
&lt;/blockquote>
&lt;h2 id="2019-11-04-ÊØèÊó•‰∏ÄÊÄù-ÂÅáÂ¶ÇmqÊ∂àÊÅØÈòüÂàó‰∫ßÁîü‰∫ÜÂ†ÜÁßØÂ¶Ç‰ΩïÊõ¥Âø´ÁöÑÊ∂àË¥π">[2019-11-04 ÊØèÊó•‰∏ÄÊÄù] ÂÅáÂ¶ÇMQÊ∂àÊÅØÈòüÂàó‰∫ßÁîü‰∫ÜÂ†ÜÁßØÔºåÂ¶Ç‰ΩïÊõ¥Âø´ÁöÑÊ∂àË¥πÔºü&lt;/h2>
&lt;blockquote>
&lt;p>‰ºö‰ªéÂ§öÁßçÈòüÂàóÂéªÂàÜÊûêÔºårabbitmqÔºåkafkaÔºårocketmqÔºåpulsarÁ≠âÂ§ö‰∏™Ê∂àÊÅØ‰∏≠Èó¥‰ª∂ÂéªÂàÜÊûê„ÄÇ
RabbitMqÂæóÁúãÊòØ‰ªÄ‰πàÊ®°ÂºèÔºåÂ¶ÇÊûúÊòØÁîü‰∫ßÊ∂àË¥πËÄÖÊ®°ÂºèÊòØÂèØ‰ª•ÁöÑÔºåÂèëÂ∏ÉËÆ¢ÈòÖÊ®°ÂºèÂ∞±Ê≤°ÂçµÁî®ÔºåÂä†‰∏™ËÆ¢ÈòÖËÄÖËÄåÂ∑≤„ÄÇkafkaÁúãconsumerÁöÑÊï∞ÈáèÂêßÔºåÂ¶ÇÊûúÂ∑≤ÁªèÂ§ß‰∫éÁ≠â‰∫épartitionÊï∞Èáè‰∫ÜÔºåÂä†consumer‰πüÊ≤°ÂçµÁî®„ÄÇpulsar
ÊòØ‰πü‰∏ÄÊ†∑ÂïäÔºåÊúâÁîü‰∫ßËÄÖÊ∂àË¥πËÄÖÊ®°ÂºèÔºå‰πüÊúâÁã¨Âç†ÂíåÂ§±Ë¥•ÊõøË°•Ê®°Âºè„ÄÇ&lt;/p>
&lt;p>ÂØπÁöÑÔºåÂÖàËØ¥kafkaÂíåRocketMQÔºå‰ªñ‰ª¨ÈÉΩÊòØÂü∫‰∫épartitionÁöÑÂ≠òÂÇ®Ê®°ÂûãÔºå‰πüÂ∞±ÊòØËØ¥ÊØè‰∏™subjectÂàÜ‰∏∫‰∏Ä‰∏™ÊàñÂ§ö‰∏™partitionÔºåServerÊî∂Âà∞Ê∂àÊÅØÂàÜÂèëÂà∞Êüê‰∏™partition‰∏äÔºåËÄåconsumer
Ê∂àË¥πÊó∂ÂÄôÊòØ‰∏épartitionÁõ∏ÂØπÂ∫îÁöÑÔºåÂΩìpartition‰∏éconsumerÊï∞ÈáèÁõ∏Á≠âÊó∂ÔºåÊòØ‰∏ÄÂØπ‰∏ÄÔºåÂΩìÂ∞è‰∫éÊó∂ÂÄôÔºå‰ºöÊúâconsumerÁ©∫Èó≤ÔºåÂ§ß‰∫éÊó∂ÂÄôÔºåÁúãÊï∞ÈáèÔºåÊúâconsumer
‰ºöË¥üË¥£Â§ö‰∏™ÔºåÊØîËæÉÁπÅÂøô„ÄÇÂú®‰∫ßÁîüÈòüÂàóÁßØÂéãÊó∂ÂÄôÔºåËøôÊó∂ÂÄôÊúÄÂêàÁêÜÁöÑÂàÜÈÖçÂáèÂéãÁ≠ñÁï•ÊòØ partitionÊï∞ÈáèÂíåconsumerÊï∞ÈáèÊàêÂÄçÊï∞ÂÖ≥Á≥ªÔºåÂçï‰∏™Â¢ûÂä†consumer
Êï∞ÈáèÂπ∂‰∏çËÉΩÊúâÊïàÊèêÈ´òÊó∂ÂÄôÔºåÂπ∂‰∏îÂπ∂‰∏çËÉΩÈ©¨‰∏äÊèêÈ´òÊ∂àË¥πÊïàÁéáÔºåÈúÄË¶ÅÊ∑ªÂä†ÂØπÂ∫îÁöÑpartitionÊï∞ÈáèÔºå‰ΩÜÊòØÂ∞±Â∏¶Êù•‰∫ÜÂè¶Â§ñÁöÑÈóÆÈ¢òÔºåpartitionÊï∞ÈáèÂ¢ûÂä†ÔºåÁâπÂà´ÊòØkafkaÔºåpartitionËµÑÊ∫êÊòØ‰∏Ä‰∏™ÊØîËæÉÈáçÁöÑËµÑÊ∫êÔºåÂ¢ûÂä†partition
Êï∞ÈáèËøòÈúÄË¶ÅËÄÉËôëÈõÜÁæ§ÁöÑÂ§ÑÁêÜËÉΩÂäõÔºåÂè¶Â§ñÂú®È´òÂ≥∞ËøáÂêéÔºåÊÉ≥Ë¶ÅconsumerÁº©ÂÆπ‰πüÊØîËæÉÈ∫ªÁÉ¶Âì¶ÔºåÂõ†‰∏∫partitionÂè™ËÉΩÂ¢ûÂä†‰∏çËÉΩÂáèÂ∞ë„ÄÇ&lt;/p>
&lt;p>ÈíàÂØπpartitionÂ≠òÂÇ®ÊñπÂºèÁöÑÔºåÊâ©ÂÆπÁõ∏ÂÖ≥ÁöÑÈóÆÈ¢òÔºåÂ∑≤ÁªèÂ†ÜÁßØÁöÑÊ∂àÊÅØÊòØ‰∏çËÉΩÂø´ÈÄüÊ∂àË¥πÁöÑÔºåÂÅáËÆæÊòØ2partitionÂØπ2‰∏™consumerÔºåËøôÊó∂ÂÄôÂ¢ûÂä†partitionÂíåconsumerÊòØÊó†Áî®ÁöÑÔºåÂõ†‰∏∫Â∑≤ÁªèÂ†ÜÁßØÁöÑÂè™ËÉΩÁî±Ëøô‰∏§‰∏™consumer
Ê∂àË¥πÔºåÊ®™ÂêëÊâ©Â±ï‰∏çÂèØËÉΩ‰∫ÜÔºåÂè™ËÉΩÁ∫µÂêëÊâ©Â±ïÔºåËøôÊó∂ÂÄôË¶Å‰πàÂè™ËÉΩÊé•ÂèóÂ∑≤ÁªèÂ†ÜÁßØÊÖ¢ÊÖ¢Ê∂àË¥πÔºåÂπ∂‰∏îÂ∞ΩÈáèÂáèÂ∞ëÂÖ•Ëøô‰∏§‰∏™partitionÁöÑÊ∂àÊÅØÔºåÊàñËÄÖÊâßË°åÊØîËæÉÈáçÁÇπÂÜçÂùáË°°Á≠ñÁï•ÔºÅ&lt;/p>
&lt;/blockquote>
&lt;h2 id="2019-11-18-ÊØèÊó•‰∏ÄÊÄù-httpdnsÊúâÂï•Â•ΩÂ§Ñ-httpdns-‰∏∫‰ªÄ‰πà‰∏ÄËà¨Âè™ÈÄÇÁî®‰∫é-app-ÊàñËÄÖ-cs-Êû∂ÊûÑbs-‰∏∫‰Ωï‰∏çÈÄÇÁî®">[2019-11-18 ÊØèÊó•‰∏ÄÊÄù] HttpDNSÊúâÂï•Â•ΩÂ§Ñ, HttpDNS ‰∏∫‰ªÄ‰πà‰∏ÄËà¨Âè™ÈÄÇÁî®‰∫é APP ÊàñËÄÖ C/S Êû∂ÊûÑÔºåB/S ‰∏∫‰Ωï‰∏çÈÄÇÁî®?#&lt;/h2>
&lt;blockquote>
&lt;p>HttpDNS ÊòØÂü∫‰∫éHTTPÂçèËÆÆÂèëËµ∑ÊúçÂä°Âô®AËÆ∞ÂΩïÁöÑÂú∞ÂùÄÔºå‰∏çÂ≠òÂú®ÂêëÊú¨Âú∞ËøêËê•ÂïÜËØ¢ÈóÆ domain Ëß£ÊûêËøáÁ®ã
ÈÄÇÁî®‰∫éAPPÊàñËÄÖC/SÊû∂ÊûÑÔºåÊòØÂÆÉÁöÑÁâπÊÆäÊÄßÂØºËá¥ÁöÑÔºå&lt;/p>
&lt;ul>
&lt;li>‰∏ÄËà¨Âú®ÁªàÁ´ØËøôÁßç‰ø°Âè∑Â∑Æ„ÄÅ‰ø°Âè∑‰∏çÁ®≥ÂÆö‰∏ãÔºåË¶ÅÊÉ≥Â∞ΩÈáèÁöÑ‰ªãÁªç‰∫§‰∫í&lt;/li>
&lt;li>Ë∑ëÈ©¨Êú∫Âà∂ÈÄâÂèñÂ∞±ËøëÂú∞ÂùÄ&lt;/li>
&lt;li>SDKÂµåÂÖ•&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;h2 id="2019-12-12-ÊØèÊó•‰∏ÄÊÄùÊàë‰ª¨Áü•ÈÅìËÆ∏Â§öÈïøÈìæÊé•ÊÉÖÂÜµ‰∏ã‰øùËØÅÈìæÊé•ÊúâÊïàÂ§ßÈÉ®ÂàÜÊòØÈÄöËøá-tcp-keepalive-‰∏é-Â∫îÁî®ÂøÉË∑≥-Êù•Á°ÆÂÆöÂêÑËá™ÁöÑÂÆö‰ΩçÊòØ‰ªÄ‰πà‰∏∫‰ªÄ‰πàÂ§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÂæàÂ§öimÁ≥ªÁªüÂêåÊó∂‰ΩøÁî®-tcp-keepalive-‰∏é-Â∫îÁî®Â±ÇÂøÉË∑≥ÂéªÁ°ÆËÆ§-Â∫îÁî®Â±ÇÂøÉË∑≥ËÆæËÆ°‰∏äÊúâÂï•ËÆ≤Á©∂">[2019-12-12 ÊØèÊó•‰∏ÄÊÄù]Êàë‰ª¨Áü•ÈÅìËÆ∏Â§öÈïøÈìæÊé•ÊÉÖÂÜµ‰∏ãÔºå‰øùËØÅÈìæÊé•ÊúâÊïàÂ§ßÈÉ®ÂàÜÊòØÈÄöËøá TCP Keepalive ‰∏é Â∫îÁî®ÂøÉË∑≥ Êù•Á°ÆÂÆöÔºåÂêÑËá™ÁöÑÂÆö‰ΩçÊòØ‰ªÄ‰πàÔºü‰∏∫‰ªÄ‰πàÂ§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÂæàÂ§öIMÁ≥ªÁªüÂêåÊó∂‰ΩøÁî® TCP Keepalive ‰∏é Â∫îÁî®Â±ÇÂøÉË∑≥ÂéªÁ°ÆËÆ§Ôºü Â∫îÁî®Â±ÇÂøÉË∑≥ËÆæËÆ°‰∏äÊúâÂï•ËÆ≤Á©∂Ôºü&lt;/h2>
&lt;blockquote>
&lt;p>TCP Keepalive ÊòØ TCP/IP ÂçèËÆÆËá™Â∏¶ÔºåÊó†ÈúÄÈ¢ùÂ§ñÁöÑÂºÄÂèëÔºå‰ΩÜÊòØ‰∏çÁÅµÊ¥ªÔºåËÄå‰∏îÊàë‰ª¨‰∏ÄËà¨Âú®Â∫îÁî®Â±ÇÈù¢ÊòØÊó†Ê≥ïÊÑüÁü•„ÄÇÊõ¥ÊîπTCP Keepalive Áõ∏ÂÖ≥ÂèÇÊï∞ÈúÄË¶Å‰øÆÊîπ/etc/sysctl.conf&lt;/p>
&lt;p>Â∫îÁî®Â±ÇÂøÉË∑≥ÊòØ‰∏∫‰∫Ü‰øùÊ¥ªÔºå‰øùËØÅÈìæÊé•ÁöÑÂèØÁî®ÊÄß&lt;/p>
&lt;ul>
&lt;li>ËøêËê•ÂïÜÁöÑÁéØÂ¢ÉÔºåÔºåÂ≠òÂú® NAT Ë∂ÖÊó∂Êñ≠ÈìæÈóÆÈ¢ò&lt;/li>
&lt;li>ËÆ©Â∫îÁî®Áü•ÊôìÁΩëÁªúÂèØÁî®ÊÉÖÂÜµÔºåÈÖåÊÉÖÂ§ÑÁêÜÊñ≠ÈìæÈáçËøûÈóÆÈ¢ò&lt;/li>
&lt;li>ÂèØ‰ª•ÊúâÊïàÁöÑÊ±üÈÉΩÊúçÂä°Á´Ø‰∏∫‰∫ÜÁª¥Êä§Êó†ÊïàÈìæÊé•ÁöÑÂºÄÈîÄ&lt;/li>
&lt;/ul>
&lt;p>Â∫îÁî®Â±ÇÂøÉË∑≥ËÆæËÆ°‰∏ä&lt;/p>
&lt;ul>
&lt;li>Âõ∫ÂÆöÈ¢ëÁéáÔºåÈÄöÂ∏∏Âè™ÊúâËØ∑Ê±ÇÂ§¥ÔºåÊ∂àÊÅØ‰ΩìÁ©∫ÂåÖÔºàÂú®Âà§Êñ≠ËøôÁ±ªÂøÉË∑≥Â§ÑÁêÜÊó∂ÂÄôÔºåÂÆ¢Êà∑Á´Ø‰∏ÄËà¨Ë¶ÅÂà§Êñ≠Ë∂ÖÊó∂Êó∂Èó¥Â§ß‰∫éÂøÉË∑≥Èó¥Èöî„ÄêÂèØËÉΩÂ≠òÂú®ÁΩëÁªúÂª∂Ëøü„ÄëÔºâ&lt;/li>
&lt;li>Êô∫ËÉΩÂøÉË∑≥ÔºåÊ†πÊçÆÁΩëÁªúÁä∂ÂÜµËá™Âä®Ë∞ÉÊï¥ÂèëÈÄÅÁöÑÈ¢ëÁéáÔºåÊù•ÈÄÇÈÖçÂΩìÂâçÁΩëÁªúÊÉÖÂÜµÁöÑÊúÄ‰Ω≥ÂøÉË∑≥È¢ëÁéáÔºàÂêÑ‰∏™Âú∞Âå∫ÂêÑ‰∏™ÊúçÂä°ÂïÜ NAT Ë∂ÖÊó∂ËÆæËÆ°‰∏ç‰∏ÄÊ†∑ÔºåÈïøÁöÑÂ§öËææÂá†‰∏™Â∞èÊó∂ÔºåÂ∞ëÁöÑÂè™ÊúâÂá†ÁßíÔºâ&lt;/li>
&lt;/ul>
&lt;p>Êô∫ËÉΩÂøÉË∑≥Ôºå‰∏ÄËà¨ÈááÁî®‰∫åÂàÜÊ≥ïÊù•ÈÄêÊ∏êÈÄºËøëÊúçÂä°ÂïÜÁöÑ NAT Ë∂ÖÊó∂ËÆæËÆ°„ÄÇÂøÉË∑≥ËÆæËÆ°‰∏ä‰∏ç‰ºöÊòØÁ©∫ÂåÖÔºåËÄåÊòØ‰º†ËæìÁöÑÊòØÂÆ¢Êà∑Á´ØÁöÑÂøÉË∑≥È¢ëÁéáÊòØÂ§öÂ∞ë„ÄÇ
ÔºàÂÅáËÆæ ÊúÄÂ∞èÂÄº 20 s ÊúÄÂ§ßÂÄº 1Â∞èÊó∂Ôºâ===&amp;gt; ÈÄêÊ∏ê‰∫åÂàÜ‰∏ãÂéª&lt;/p>
&lt;/blockquote>
&lt;h2 id="2019-12-14-ÊØèÊó•‰∏ÄÊÄù-Â¶Ç‰ΩïÂà§Êñ≠‰ªªÊÑèÁî®Êà∑‰∏ä‰º†ÁöÑÊñá‰ª∂Âú®ÊúçÂä°Á´ØÊòØÂê¶Â≠òÂú®Âë¢ÁΩëÁõòÁöÑÁßí‰º†ÁöÑÂÆûÁé∞ÊÄùË∑Ø">[2019-12-14 ÊØèÊó•‰∏ÄÊÄù] Â¶Ç‰ΩïÂà§Êñ≠‰ªªÊÑèÁî®Êà∑‰∏ä‰º†ÁöÑÊñá‰ª∂Âú®ÊúçÂä°Á´ØÊòØÂê¶Â≠òÂú®Âë¢ÔºüÁΩëÁõòÁöÑ‚ÄúÁßí‰º†‚ÄùÁöÑÂÆûÁé∞ÊÄùË∑ØÔºü&lt;/h2>
&lt;blockquote>
&lt;p>ÂØπÊØîÊñá‰ª∂ÔºåÁ°ÆÂÆûÊòØ‰ΩøÁî®ÁöÑÊñá‰ª∂ÁöÑÊèêÂèñÁöÑÁâπÂæÅÂÄºÔºàÂçïÈ°πÂìàÂ∏åÁÆóÊ≥ïÔºâ,ÂìàÂ∏åÁÆóÊ≥ïÊòØÊúâÂÜ≤Á™ÅÁöÑÔºåËôΩÁÑ∂Ê¶ÇÁéáËæÉÂ∞èÔºå ÈÇ£‰πàÂ¶Ç‰ΩïËøôÁßçÂÜ≤Á™ÅÂë¢ÔºöÂú®ÊúçÂä°Á´ØÔºå
ÂØπËØ•Êñá‰ª∂ËøõË°å‰∏çÂêåÁöÑÂçïÂêëHashÁÆóÊ≥ïÔºàMD5ÔºåSHA-1ÔºâÁ≠âÁ≠âÂæóÂà∞Â§ö‰∏™ÂÄºÔºå‰∏Ä‰∏ÄÂØπÊØîÔºåÂè™ÊúâÂÖ®ÈÉ®Áõ∏ÂêåÊâçËÆ§‰∏∫ÊòØÂêå‰∏Ä‰∏™Êñá‰ª∂„ÄÇ&lt;/p>
&lt;p>‰∏∫‰ªÄ‰πàË¶ÅÂìàÂ∏åÔºü‰∏∫‰∫ÜÂ∞Ü‰∏Ä‰∏™‰∏çÂÆöÈïø„ÄÅ‰∏çÁ°ÆÂÆöÁöÑ‰∏ú‰∏ú ËΩ¨ÂåñÊàê Âõ∫ÂÆöÈïøÂ∫¶ÁöÑÂõ∫ÂåñÁöÑÁâπÂæÅÂÄºÔºåÂπ∂Ë¶Å‰øùËØÅÂîØ‰∏ÄÊÄß„ÄÇ&lt;/p>
&lt;/blockquote>
&lt;h1 id="Â°´ÂùëËÆ∞ÂΩï">Â°´ÂùëËÆ∞ÂΩï&lt;/h1>
&lt;h2 id="dockerÁõ∏ÂÖ≥">dockerÁõ∏ÂÖ≥&lt;/h2>
&lt;ul>
&lt;li>dockerÈªòËÆ§ÁΩëÊ°•ÈóÆÈ¢ò&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>ÊúçÂä°Âô®ÈªòËÆ§ÁΩëÊ°• 172.19.0.0, ËÄå docker ÁΩëÊ°•ÈªòËÆ§172.17.0.0,
Âú®ÂêØÂä®Â§ö‰∏™ÁöÑdockerÂÆπÂô®ÁöÑÊó∂ÂÄô‰ºöÂØºËá¥Âú∞ÂùÄÂÜ≤Á™ÅÔºåÊ°•Êé•ÁΩëÂç°ÂáâÔºå
ÈúÄË¶ÅÊõ¥Êîπdocker ÈªòËÆ§ÁöÑÁΩëÊ°•Âú∞ÂùÄ&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-markdown" data-lang="markdown"> {
&amp;#34;debug&amp;#34; : true,
&amp;#34;default-address-pools&amp;#34; : [
{
&amp;#34;base&amp;#34; : &amp;#34;172.31.0.0/16&amp;#34;,
&amp;#34;size&amp;#34; : 24
}
]
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Êõ¥ÊîπÊàêÂíå‰∏ªÊú∫‰∏ç‰∏ÄÊ†∑ÁöÑÁöÑÁΩëÊÆµÂú∞ÂùÄ&lt;/p>
&lt;/blockquote>
&lt;h2 id="redisÂàÜÂ∏ÉÂºèÈîÅ">redisÂàÜÂ∏ÉÂºèÈîÅ&lt;/h2>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">
&lt;span style="color:#8b008b;font-weight:bold">package&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">com.kezaihui.thor.biz.core.adapter.redis.lock&lt;/span>;
&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">lombok.extern.slf4j.Slf4j&lt;/span>;
&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">org.springframework.beans.factory.annotation.Autowired&lt;/span>;
&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">org.springframework.data.redis.core.RedisTemplate&lt;/span>;
&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">org.springframework.data.redis.core.script.DefaultRedisScript&lt;/span>;
&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">org.springframework.stereotype.Component&lt;/span>;
&lt;span style="color:#8b008b;font-weight:bold">import&lt;/span> &lt;span style="color:#008b45;text-decoration:underline">java.util.Collections&lt;/span>;
&lt;span style="color:#228b22">/**
&lt;/span>&lt;span style="color:#228b22"> * RedisTemplateDistributeLockUtil
&lt;/span>&lt;span style="color:#228b22"> */&lt;/span>
&lt;span style="color:#707a7c">@Slf4j&lt;/span>
&lt;span style="color:#707a7c">@Component&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">class&lt;/span> &lt;span style="color:#008b45;font-weight:bold">RedisTemplateDistributeLockUtil&lt;/span> {
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">final&lt;/span> String LOCK_SCRIPT =
&lt;span style="color:#cd5555">&amp;#34;local key = KEYS[1]; local value = ARGV[1]; if redis.call(&amp;#39;set&amp;#39;, key, value, &amp;#39;NX&amp;#39; ,&amp;#39;PX&amp;#39;, %d) &amp;#34;&lt;/span>
+ &lt;span style="color:#cd5555">&amp;#34;then return 1 else return 0 end&amp;#34;&lt;/span>;
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">final&lt;/span> String UNLOCK_SCRIPT =
&lt;span style="color:#cd5555">&amp;#34;if redis.call(&amp;#39;get&amp;#39;, KEYS[1]) == ARGV[1] then return redis.call(&amp;#39;del&amp;#39;,KEYS[1]) else return 0 end&amp;#34;&lt;/span>;
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">final&lt;/span> &lt;span style="color:#00688b;font-weight:bold">int&lt;/span> EXPIRE = 5000;
&lt;span style="color:#707a7c">@Autowired&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> RedisTemplate redisTemplate;
&lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> String &lt;span style="color:#008b45">lockExpireScript&lt;/span>(&lt;span style="color:#00688b;font-weight:bold">int&lt;/span> expireMills) {
&lt;span style="color:#8b008b;font-weight:bold">if&lt;/span> (expireMills &amp;lt;= 0) {
expireMills = EXPIRE;
}
&lt;span style="color:#8b008b;font-weight:bold">return&lt;/span> String.&lt;span style="color:#658b00">format&lt;/span>(LOCK_SCRIPT, expireMills);
}
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#00688b;font-weight:bold">boolean&lt;/span> &lt;span style="color:#008b45">lock&lt;/span>(String key, String value, &lt;span style="color:#00688b;font-weight:bold">int&lt;/span> expireMills) {
String script = lockExpireScript(expireMills);
DefaultRedisScript&amp;lt;Long&amp;gt; redisScript = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> DefaultRedisScript&amp;lt;&amp;gt;(script, Long.&lt;span style="color:#658b00">class&lt;/span>);
Long execute = (Long) redisTemplate.&lt;span style="color:#658b00">execute&lt;/span>(redisScript, Collections.&lt;span style="color:#658b00">singletonList&lt;/span>(key),
Collections.&lt;span style="color:#658b00">singletonList&lt;/span>(value));
&lt;span style="color:#8b008b;font-weight:bold">return&lt;/span> execute != &lt;span style="color:#8b008b;font-weight:bold">null&lt;/span> &amp;amp;&amp;amp; execute != 0;
}
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#00688b;font-weight:bold">boolean&lt;/span> &lt;span style="color:#008b45">blockLock&lt;/span>(String key, String value, &lt;span style="color:#00688b;font-weight:bold">int&lt;/span> expireMills) &lt;span style="color:#8b008b;font-weight:bold">throws&lt;/span> DistributeLockTimeoutException {
&lt;span style="color:#228b22">// Ë¢´ÈòªÂ°ûÁöÑÊó∂Èó¥Ë∂ÖËøá5ÁßíÂ∞±ÂÅúÊ≠¢Ëé∑ÂèñÈîÅ
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#00688b;font-weight:bold">int&lt;/span> blockTime = expireMills;
&lt;span style="color:#228b22">// ÈªòËÆ§ÁöÑÈó¥ÈöîÊó∂Èó¥
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">for&lt;/span> (; ; ) {
&lt;span style="color:#8b008b;font-weight:bold">if&lt;/span> (blockTime &amp;gt;= 0) {
String script = lockExpireScript(expireMills);
DefaultRedisScript&amp;lt;Long&amp;gt; redisScript = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> DefaultRedisScript&amp;lt;&amp;gt;(script, Long.&lt;span style="color:#658b00">class&lt;/span>);
Long result = (Long) redisTemplate.&lt;span style="color:#658b00">execute&lt;/span>(redisScript, Collections.&lt;span style="color:#658b00">singletonList&lt;/span>(key), value);
&lt;span style="color:#8b008b;font-weight:bold">if&lt;/span> (result != &lt;span style="color:#8b008b;font-weight:bold">null&lt;/span> &amp;amp;&amp;amp; result == 1) {
&lt;span style="color:#228b22">// ÂæóÂà∞‰∫ÜÈîÅ
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">return&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">true&lt;/span>;
} &lt;span style="color:#8b008b;font-weight:bold">else&lt;/span> {
blockTime -= 300;
&lt;span style="color:#8b008b;font-weight:bold">try&lt;/span> {
Thread.&lt;span style="color:#658b00">sleep&lt;/span>(300);
} &lt;span style="color:#8b008b;font-weight:bold">catch&lt;/span> (InterruptedException e) {
log.&lt;span style="color:#658b00">error&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;RedisTemplateDistributeLockUtil.blockLock error!&amp;#34;&lt;/span>, e);
}
}
} &lt;span style="color:#8b008b;font-weight:bold">else&lt;/span> {
&lt;span style="color:#228b22">// Â∑≤ÁªèË∂ÖÊó∂
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">throw&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> DistributeLockTimeoutException(&lt;span style="color:#cd5555">&amp;#34;Distribute Lock Timeout&amp;#34;&lt;/span>);
}
}
}
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#00688b;font-weight:bold">boolean&lt;/span> &lt;span style="color:#008b45">unlock&lt;/span>(String key, String value) {
String script = UNLOCK_SCRIPT;
DefaultRedisScript&amp;lt;Long&amp;gt; redisScript = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> DefaultRedisScript&amp;lt;&amp;gt;(script, Long.&lt;span style="color:#658b00">class&lt;/span>);
Long execute = (Long) redisTemplate.&lt;span style="color:#658b00">execute&lt;/span>(redisScript, Collections.&lt;span style="color:#658b00">singletonList&lt;/span>(key), value);
&lt;span style="color:#8b008b;font-weight:bold">return&lt;/span> execute != &lt;span style="color:#8b008b;font-weight:bold">null&lt;/span> &amp;amp;&amp;amp; execute != 0;
}
}
&lt;/code>&lt;/pre>&lt;/div>- https://pinkhello.me/posts/14-%E5%B7%A5%E4%BD%9C%E7%BA%AA%E5%AE%9E2020/ - PinkHello, All Rights Reserved</description></item><item><title>03 String‰∏∫‰ªÄ‰πàËÆæËÆ°Êàêfinal</title><link>https://pinkhello.me/posts/03-string%E4%B8%BA%E4%BB%80%E4%B9%88%E8%AE%BE%E8%AE%A1%E6%88%90final/</link><pubDate>Sun, 10 Feb 2019 08:19:51 +0800</pubDate><guid>https://pinkhello.me/posts/03-string%E4%B8%BA%E4%BB%80%E4%B9%88%E8%AE%BE%E8%AE%A1%E6%88%90final/</guid><description>PinkHello https://pinkhello.me/posts/03-string%E4%B8%BA%E4%BB%80%E4%B9%88%E8%AE%BE%E8%AE%A1%E6%88%90final/ -&lt;h1 id="stringÊ∫êÁ†ÅÂâñÊûê">&lt;code>String&lt;/code>Ê∫êÁ†ÅÂâñÊûê&lt;/h1>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">final&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">class&lt;/span> &lt;span style="color:#008b45;font-weight:bold">String&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">implements&lt;/span> java.&lt;span style="color:#658b00">io&lt;/span>.&lt;span style="color:#658b00">Serializable&lt;/span>, Comparable&amp;lt;String&amp;gt;, CharSequence {
&lt;span style="color:#228b22">/** The value is used for character storage. */&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">final&lt;/span> &lt;span style="color:#00688b;font-weight:bold">char&lt;/span> value[];
&lt;span style="color:#228b22">/** Cache the hash code for the string */&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> &lt;span style="color:#00688b;font-weight:bold">int&lt;/span> hash; &lt;span style="color:#228b22">// Default to 0
&lt;/span>&lt;span style="color:#228b22">&lt;/span>
&lt;span style="color:#228b22">/** use serialVersionUID from JDK 1.0.2 for interoperability */&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">final&lt;/span> &lt;span style="color:#00688b;font-weight:bold">long&lt;/span> serialVersionUID = -6849794470754667710L;
&lt;span style="color:#228b22">/**
&lt;/span>&lt;span style="color:#228b22"> * Class String is special cased within the Serialization Stream Protocol.
&lt;/span>&lt;span style="color:#228b22"> *
&lt;/span>&lt;span style="color:#228b22"> * A String instance is written into an ObjectOutputStream according to
&lt;/span>&lt;span style="color:#228b22"> * &amp;lt;a href=&amp;#34;{@docRoot}/../platform/serialization/spec/output.html&amp;#34;&amp;gt;
&lt;/span>&lt;span style="color:#228b22"> * Object Serialization Specification, Section 6.2, &amp;#34;Stream Elements&amp;#34;&amp;lt;/a&amp;gt;
&lt;/span>&lt;span style="color:#228b22"> */&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">final&lt;/span> ObjectStreamField[] serialPersistentFields =
&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> ObjectStreamField[0];
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>String&lt;/code> Â¶Ç‰Ωï‰øùËØÅ ‰∏çÂèØÂèòÁöÑÂë¢Ôºü&lt;/p>
&lt;blockquote>
&lt;p>Â≠óÁ¨¶Êï∞ÁªÑ‰ΩøÁî®‰∫Ü &lt;code>final&lt;/code> ‰øÆÈ•∞ÔºåËøô‰πüÂè™ÊòØË°®Á§∫‰∫Ü Â≠óÁ¨¶Êï∞ÁªÑÁöÑÂºïÁî®Âú∞ÂùÄ‰∏çÂèØÂèòÔºåÂπ∂‰∏ç‰ª£Ë°®ÂÜÖÂÆπ‰∏çÂèØÂèò„ÄÇ
ÂÖ∂‰ΩøÁî® &lt;code>private&lt;/code> ‰øÆÈ•∞ÔºåÂ§ñÈÉ®Ê≤°ÊúâÂÖ•Âè£ËææÂà∞ÂèòÂä®Ôºå‰ªéËÄå‰øùËØÅ‰∫Ü String ÁöÑ‰∏çÂèØÂèòÊÄß&lt;/p>
&lt;/blockquote>
&lt;p>‰∏∫‰ªÄ‰πà‰øùËØÅ &lt;code>String&lt;/code> ÊòØ &lt;code>final&lt;/code> ÁöÑÂë¢ÔºüÁâπÁÇπÔºö&lt;/p>
&lt;blockquote>
&lt;ul>
&lt;li>Âõ†‰∏∫Âè™Êúâ‰øùËØÅ &lt;code>String&lt;/code> ÊòØ &lt;code>final&lt;/code> ÁöÑÂë¢ &lt;strong>Âè™ÊúâÂΩìÂ≠óÁ¨¶‰∏≤‰∏çÂèØÂèòÁöÑÔºåÂ≠óÁ¨¶‰∏≤Ê±†ÊâçÂèØËÉΩÂÆûÁé∞&lt;/strong>;Â≠óÁ¨¶‰∏≤Ê±†ÁöÑÂÆûÁé∞ÂèØ‰ª•ËäÇÁúÅÂæàÂ§öÁöÑ &lt;code>Heap&lt;/code>Á©∫Èó¥ÔºåÂõ†‰∏∫‰∏çÂêåÁöÑÂ≠óÁ¨¶‰∏≤ÂèòÈáèÈÉΩÊåáÂêëÊ±†‰∏≠ÁöÑÂêå‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤.&lt;/li>
&lt;li>ÂÅáÂ¶ÇÂ≠óÁ¨¶‰∏≤ÂèØÂèòÔºåÈÇ£‰πà&lt;code>String&lt;/code> &lt;code>interning&lt;/code> ‰∏çËÉΩÂÆûÁé∞ÔºåÈÇ£‰πàÂèòÈáèÊîπÂèò‰∫ÜËøô‰∏™Â≠óÁ¨¶‰∏≤ÁöÑÂÄºÔºåÈÇ£‰πàÂÖ∂‰ªñÊåáÂêëËøô‰∏™ÂÄºÁöÑÂèòÈáèÁöÑÂÄº‰πüÊîπÂèò‰∫Ü„ÄÇ ÔºàÂÆâÂÖ®ÈóÆÈ¢òÊù•‰∫ÜÔºåÁî®Êà∑ÂêçÂØÜÁ†ÅÔºåÁ´ØÂè£„ÄÅIPÁ≠âÔºâ&lt;/li>
&lt;li>Â≠óÁ¨¶‰∏≤‰∏çÂèØÂèòÔºåÂ§öÁ∫øÁ®ãÂÆâÂÖ®ÔºåÂêå‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÂÆû‰æãÂèØ‰ª•Ë¢´ÂØπÊ≠åÁ∫øÁ®ãÂÖ±‰∫´Ôºå‰∏çÈúÄË¶ÅËÄÉËôëÂêåÊ≠•ÈóÆÈ¢ò&lt;/li>
&lt;li>‰∏äÈù¢ÁúãÂá∫ÔºåÂú®Â≠óÁ¨¶‰∏≤‰∏çÂèØÂèòÁöÑÊÉÖÂÜµ‰∏ãÔºåÂàõÂª∫ÁöÑÊó∂ÂÄô &lt;code>hashcode&lt;/code>‰πüË¢´ÁºìÂ≠ò‰∫ÜÔºå‰∏çÈúÄË¶ÅÈáçÊñ∞ËÆ°ÁÆó„ÄÇ‰∏ÄÈÉ®ÂàÜÊÄßËÉΩÈóÆÈ¢òÂèØ‰ª•ÂæàÂ•ΩÁöÑÈÄâÊã©Â≠óÁ¨¶‰∏≤&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;h1 id="string-Âú®-jvm-Â±ÇÁêÜËß£-ÊãìÂ±ï">&lt;code>String&lt;/code> Âú® &lt;code>JVM&lt;/code> Â±ÇÁêÜËß£ ÊãìÂ±ï&lt;/h1>
&lt;p>&lt;code>JVM&lt;/code> Â±ÇÈù¢Êúâ ËôöÊãüÊú∫Ê†à„ÄÅÊú¨Âú∞ÊñπÊ≥ïÊ†à„ÄÅÂ†Ü„ÄÅÁ®ãÂ∫èËÆ°Êï∞Âô®„ÄÅÂÖÉÊï∞ÊçÆÂå∫(ÊñπÊ≥ïÂå∫)
&lt;img src="https://pinkhello.me/String%E4%B8%BA%E4%BB%80%E4%B9%88%E8%AE%BE%E8%AE%A1%E6%88%90final%E5%BD%A2%E6%80%81/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%95%B0%E6%8D%AE%E5%8C%BA.png" alt="ËøêË°åÊó∂Êï∞ÊçÆÂå∫">&lt;/p>
&lt;ul>
&lt;li>Â≠óÁ¨¶‰∏≤ÂàõÂª∫ÂΩ¢Âºè&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">String s1 = &lt;span style="color:#cd5555">&amp;#34;1&amp;#34;&lt;/span>;
String s2 = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> String(&lt;span style="color:#cd5555">&amp;#34;1&amp;#34;&lt;/span>);
&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;ul>
&lt;li>ÁºñËØëÊúüÈó¥ &amp;ldquo;1&amp;rdquo; ‰Ωú‰∏∫Â∏∏ÈáèËøõÂÖ•Â≠óÁ¨¶‰∏≤Â∏∏ÈáèÊ±†ÔºàËøôÊó∂ÂÄôÊòØÈùôÊÄÅÂ∏∏ÈáèÊ±†Ôºâ;&lt;/li>
&lt;li>ÂΩìÁºñËØë &lt;code>s1&lt;/code> Êó∂ÂÄôÔºåÂ∞Ü &lt;code>s1&lt;/code> Êé®ËøõÂ±ÄÈÉ®ÂèòÈáèÂå∫ÔºàÊ†àÂ∏ßÂÜÖÈÉ®Ôºâ; ÂÖàÂà§Êñ≠ &amp;ldquo;1&amp;rdquo; Âú®Â≠óÁ¨¶‰∏≤Â∏∏ÈáèÊ±†Âú®‰∏çÂú®Ôºå‰∏çÂ≠òÂú®ÁöÑËØùÂàõÂª∫Â∏∏Èáè &amp;ldquo;1&amp;rdquo; Âä†ÂÖ•Â∏∏ÈáèÊ±†ÔºåÂπ∂Áõ¥Êé•Â∞Ü &lt;code>s1&lt;/code> ÊåáÂêëÂ≠óÁ¨¶‰∏≤Â∏∏ÈáèÊ±†ÁöÑÂØπË±° &amp;ldquo;1&amp;rdquo; Âú∞ÂùÄÔºõ&lt;/li>
&lt;li>ÂΩì‰ª£Á†ÅËøêË°å &lt;code>s2&lt;/code> Êó∂ÂÄôÔºå‰ΩøÁî®ÁöÑ &lt;code>new&lt;/code> Â≠óÊÆµÔºå&lt;code>JVM&lt;/code> ÂÖàÊ£ÄÊü•Â≠óÁ¨¶‰∏≤Â∏∏ÈáèÂú®Â∏∏ÈáèÊ±†Â≠ò‰∏çÂ≠òÂú®ÔºåÂ¶ÇÊûúÂ∑≤ÁªèÂ≠òÂú®ÔºåÁõ¥Êé•Âú®Â†Ü‰∏≠Â§çÂà∂ÊîπÂØπË±°ÁöÑÂâØÊú¨ÔºåÂπ∂‰∏îÂ∞Ü &lt;code>s2&lt;/code> ÊåáÂêëÂ†Ü‰∏≠ÁöÑÂàöÂàöÂàõÂª∫ÁöÑÂØπË±°Âú∞ÂùÄ„ÄÇ
Â¶ÇÊûú‰∏çÂ≠òÂú®ÔºåÂàô‰ºöÂÆû‰æãÂåñËØ•Â≠óÁ¨¶‰∏≤ &amp;ldquo;1&amp;rdquo; Âπ∂‰∏îÂ∞ÜÂÖ∂ÊîæÂà∞Â∏∏ÈáèÊ±†‰∏≠ÔºàËøôÊó∂ÂÄôÊòØËøêË°åÊó∂Â∏∏ÈáèÊ±†Ôºâ,ÁÑ∂ÂêéÂú®Â†Ü‰∏≠Â§çÂà∂ÂàöÂàöÂä†ÂÖ•Â∏∏ÈáèÊ±†ÂØπË±°ÁöÑÂâØÊú¨ÂàõÂª∫Âá∫Êñ∞ÁöÑÂØπË±°ÔºåÂπ∂Â∞Ü &lt;code>s2&lt;/code> ÊåáÂêëÂÆÉ&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;ul>
&lt;li>&amp;lsquo;+&amp;lsquo;Âè∑ËøûÊé•ÁöÑÂ≠óÁ¨¶‰∏≤&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">String s1 = &lt;span style="color:#cd5555">&amp;#34;1&amp;#34;&lt;/span>+&lt;span style="color:#cd5555">&amp;#34;2&amp;#34;&lt;/span>+&lt;span style="color:#cd5555">&amp;#34;3&amp;#34;&lt;/span>;
&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;ul>
&lt;li>ÁºñËØëÊúüÈó¥Â∞±ËÉΩÁ°ÆÂÆöÔºåÁõ¥Êé•‰Ωú‰∏∫ &amp;ldquo;123&amp;rdquo; ÁöÑÂ∏∏ÈáèËøõÂÖ•Â∏∏ÈáèÊ±†;&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">String s2 = &lt;span style="color:#cd5555">&amp;#34;1&amp;#34;&lt;/span>+&lt;span style="color:#cd5555">&amp;#34;2&amp;#34;&lt;/span>+&lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> String(&lt;span style="color:#cd5555">&amp;#34;3&amp;#34;&lt;/span>)+&lt;span style="color:#cd5555">&amp;#34;4&amp;#34;&lt;/span>;
&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;ul>
&lt;li>ÂΩì &amp;lsquo;+&amp;rsquo; ‰∏≠Èó¥ÊúâÂèòÈáèÊó∂ÂÄôÔºå‰πüÂè™ËÉΩÂú®ËøêË°åÊúüÊâçËÉΩÁ°ÆÂÆöÔºå‰ΩÜÊòØÂú®ÁºñËØëÊúüÈó¥‰ºöÂ∞ΩÈáèÁöÑÂ∞ÜÂ≠óÁ¨¶‰∏≤Â∏∏ÈáèËøûÊé•Ëµ∑Êù•ÔºåÂΩ¢ÊàêÊñ∞ÁöÑÂ≠óÁ¨¶‰∏≤Â∏∏Èáè;&lt;/li>
&lt;li>ÂèçÁºñËØëÂêé &lt;code>String s2 = new StringBuilder(&amp;quot;12&amp;quot;).append(new String(&amp;quot;3&amp;quot;&amp;quot;)).append(&amp;quot;4&amp;quot;).toString()&lt;/code>;&lt;/li>
&lt;li>‰πüÂ∞±ÊòØËØ¥Áî® &amp;lsquo;+&amp;rsquo; ËøûÊé•‰∏≠Èó¥ÊúâÂèòÈáèÁöÑÊó∂ÂÄôÔºå&amp;ldquo;13&amp;rdquo;, &amp;ldquo;3&amp;rdquo;, &amp;ldquo;4&amp;rdquo; Âú®Â∏∏ÈáèÊ±†‰∏≠ÔºåÂú®Â†Ü‰∏≠Êúâ &lt;code>StringBuilder(&amp;quot;1234&amp;quot;)&lt;/code>, &lt;code>String(&amp;quot;4&amp;quot;)&lt;/code>,‰ª•Âèä&lt;code>toString&lt;/code>Âêé‰∫ßÁîüÁöÑ&lt;code>String&lt;/code>ÂØπË±°&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">String s3 = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> String(&lt;span style="color:#cd5555">&amp;#34;3&amp;#34;&lt;/span>) + &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> String(&lt;span style="color:#cd5555">&amp;#34;3&amp;#34;&lt;/span>);
&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;ul>
&lt;li>&amp;ldquo;3&amp;rdquo; Âú®Â∏∏ÈáèÊ±†‰∏≠ÔºàÁºñËØëÁöÑÊó∂ÂÄôÔºâ&lt;/li>
&lt;li>ËøêË°åÊó∂ÔºåÂú®Â†Ü‰∏≠‰∫ßÁîü &amp;ldquo;3&amp;rdquo; ÁöÑÂâØÊú¨‰∏§‰∏™ &lt;code>String&lt;/code> ÂØπË±°ÔºåÂπ∂‰∫ßÁîü &lt;code>StringBuilder(&amp;quot;11&amp;quot;)&lt;/code> ÂØπË±°‰ª•Âèä &lt;code>toString&lt;/code> ÁöÑ &lt;code>String&lt;/code> ÂØπË±°&lt;/li>
&lt;/ul>
&lt;/blockquote>
- https://pinkhello.me/posts/03-string%E4%B8%BA%E4%BB%80%E4%B9%88%E8%AE%BE%E8%AE%A1%E6%88%90final/ - PinkHello, All Rights Reserved</description></item><item><title>02 ÂÖ≥‰∫éfinalÁöÑÊÄùËÄÉ</title><link>https://pinkhello.me/posts/02-%E5%85%B3%E4%BA%8Efinal%E7%9A%84%E6%80%9D%E8%80%83/</link><pubDate>Sun, 10 Feb 2019 08:09:36 +0800</pubDate><guid>https://pinkhello.me/posts/02-%E5%85%B3%E4%BA%8Efinal%E7%9A%84%E6%80%9D%E8%80%83/</guid><description>PinkHello https://pinkhello.me/posts/02-%E5%85%B3%E4%BA%8Efinal%E7%9A%84%E6%80%9D%E8%80%83/ -&lt;h2 id="ÂÖ≥‰∫éfinalÁöÑÊÄùËÄÉ">ÂÖ≥‰∫é&lt;code>final&lt;/code>ÁöÑÊÄùËÄÉ&lt;/h2>
&lt;ul>
&lt;li>&lt;code>final&lt;/code> ÊòØÂ£∞ÊòéÊï∞ÊçÆÂüüÊúÄÁªàÁöÑ,‰∏çÂèØ‰ª•‰øÆÊîπÁöÑÔºåÂ∏∏ËßÅÁöÑ ÊòØÁ±ªÁöÑ Â∫èÂàóÂåñ&lt;code>ID&lt;/code>&lt;/li>
&lt;li>&lt;code>String&lt;/code> Á±ªÔºåÂÖ∂Êï∞ÊçÆÂüüÈÉΩÊòØ &lt;code>final&lt;/code> ÁöÑ&lt;/li>
&lt;/ul>
&lt;h3 id="‰øÆÊîπ-final-‰øÆÈ•∞ÁöÑÂ±ûÊÄß">‰øÆÊîπ &lt;code>final&lt;/code> ‰øÆÈ•∞ÁöÑÂ±ûÊÄß&lt;/h3>
&lt;p>ÂèçÂ∞Ñ‰øÆÊîπ &lt;code>final&lt;/code> ‰øÆÈ•∞ÁöÑÊï∞ÊçÆÂüü„ÄêÈùûÂ∏∏ÊàêÂäüÁöÑ‰øÆÊîπ‰∫Ü„Äë&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">class&lt;/span> &lt;span style="color:#008b45;font-weight:bold">Test&lt;/span> {
&lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">final&lt;/span> String name = &lt;span style="color:#cd5555">&amp;#34;hello world&amp;#34;&lt;/span>;
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">main&lt;/span>(String[] args) &lt;span style="color:#8b008b;font-weight:bold">throws&lt;/span> NoSuchFieldException, IllegalAccessException {
Test test = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> Test();
Field field = test.&lt;span style="color:#658b00">getClass&lt;/span>().&lt;span style="color:#658b00">getDeclaredField&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;name&amp;#34;&lt;/span>);
field.&lt;span style="color:#658b00">setAccessible&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">true&lt;/span>);
field.&lt;span style="color:#658b00">set&lt;/span>(test,&lt;span style="color:#cd5555">&amp;#34;HELLO, WORLD!&amp;#34;&lt;/span>);
System.&lt;span style="color:#658b00">out&lt;/span>.&lt;span style="color:#658b00">println&lt;/span>(field.&lt;span style="color:#658b00">get&lt;/span>(test));
System.&lt;span style="color:#658b00">out&lt;/span>.&lt;span style="color:#658b00">println&lt;/span>(test.&lt;span style="color:#658b00">name&lt;/span>);
}
}
ËæìÂá∫
Hello, WORLD!
hello world
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Á¨¨‰∏Ä‰∏™ËæìÂá∫ÊòØÂõ†‰∏∫ËØ¥ÊòéËøêË°åÊàêÂäüÔºå‰øÆÊîπ&lt;code>final&lt;/code>‰øÆÈ•∞ÁöÑÂØπË±°ÁöÑÂ±ûÊÄßÊàêÂäü‰øÆÊîπÔºõ&lt;/p>
&lt;p>‰ΩÜÊòØÁ¨¨‰∫å‰∏™ËæìÂá∫ÔºåË°®Êòé‰∫ÜÊàëÁõ¥Êé•‰ΩøÁî® &lt;code>name&lt;/code> ÁöÑÂ±ûÊÄßÂç¥ËøòÊòØËæìÂá∫Á´ØÈ¢ùÂéüÊù•ÁöÑÂÄº.&lt;/p>
&lt;p>ÂèçÁºñËØëÂêéÁöÑ‰ª£Á†Å&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">class&lt;/span> &lt;span style="color:#008b45;font-weight:bold">Test&lt;/span> {
&lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">final&lt;/span> String name = &lt;span style="color:#cd5555">&amp;#34;hello world&amp;#34;&lt;/span>;
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#008b45">Test&lt;/span>() {
}
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">main&lt;/span>(String[] args) &lt;span style="color:#8b008b;font-weight:bold">throws&lt;/span> NoSuchFieldException, IllegalAccessException {
Test test = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> Test();
Field field = test.&lt;span style="color:#658b00">getClass&lt;/span>().&lt;span style="color:#658b00">getDeclaredField&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;name&amp;#34;&lt;/span>);
field.&lt;span style="color:#658b00">setAccessible&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">true&lt;/span>);
field.&lt;span style="color:#658b00">set&lt;/span>(test, &lt;span style="color:#cd5555">&amp;#34;HELLO, WORLD!&amp;#34;&lt;/span>);
System.&lt;span style="color:#658b00">out&lt;/span>.&lt;span style="color:#658b00">println&lt;/span>(field.&lt;span style="color:#658b00">get&lt;/span>(test));
PrintStream var10000 = System.&lt;span style="color:#658b00">out&lt;/span>;
test.&lt;span style="color:#658b00">getClass&lt;/span>();
var10000.&lt;span style="color:#658b00">println&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;hello world&amp;#34;&lt;/span>);
}
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÂèØ‰ª•ÁúãÂá∫ ‰ΩøÁî®ÂØπË±°.Â±ûÊÄßÁöÑÂ∑≤ÁªèË¢´ÊõøÊç¢‰∫ÜÔºåËøôÊòØÁî±‰∫é&lt;code>JVM&lt;/code> ÁöÑÂÜÖËÅî‰ºòÂåñÔºàÊñπÊ≥ïË∞ÉÁî®(ÂèÇÊï∞ÂéãÊ†à,Ë∑≥ËΩ¨Âà∞ÊñπÊ≥ïÂ§ÑÊâßË°å,ÂÜçË∞ÉÂõû,Â§ÑÁêÜÊ†àÂèÇÊï∞,Â§ÑÁêÜËøîÂõûÂÄº)ÔºâÂØºËá¥ÁöÑÔºå‰ºöÁõ¥Êé•ÊõøÊç¢Êéâ‰ΩøÁî® final ‰øÆÈ•∞ÁöÑÂ≠óÊÆµ„ÄÇ„ÄêÂΩìÁÑ∂‰πüÂèØ‰ª•ÂÖ≥Èó≠ÂÜÖËÅî‰ºòÂåñ„Äë&lt;/p>
&lt;h3 id="‰øÆÊîπ‰ΩøÁî®-final-‰øÆÈ•∞ÁöÑ-static-Á±ªÂ±ûÊÄß">‰øÆÊîπ‰ΩøÁî® &lt;code>final&lt;/code> ‰øÆÈ•∞ÁöÑ &lt;code>static&lt;/code> Á±ªÂ±ûÊÄß&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">class&lt;/span> &lt;span style="color:#008b45;font-weight:bold">Test&lt;/span> {
&lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">final&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> String NAME = &lt;span style="color:#cd5555">&amp;#34;static hello world&amp;#34;&lt;/span>;
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">main&lt;/span>(String[] args) &lt;span style="color:#8b008b;font-weight:bold">throws&lt;/span> NoSuchFieldException, IllegalAccessException {
Test test = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> Test();
&lt;span style="color:#228b22">//‰øÆÊîπNAME
&lt;/span>&lt;span style="color:#228b22">&lt;/span> Field sfield = test.&lt;span style="color:#658b00">getClass&lt;/span>().&lt;span style="color:#658b00">getDeclaredField&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;NAME&amp;#34;&lt;/span>);
sfield.&lt;span style="color:#658b00">setAccessible&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">true&lt;/span>);
sfield.&lt;span style="color:#658b00">set&lt;/span>(test,&lt;span style="color:#cd5555">&amp;#34;STATIC HELLO, WORLD!&amp;#34;&lt;/span>);
System.&lt;span style="color:#658b00">out&lt;/span>.&lt;span style="color:#658b00">println&lt;/span>(sfield.&lt;span style="color:#658b00">get&lt;/span>(test));
System.&lt;span style="color:#658b00">out&lt;/span>.&lt;span style="color:#658b00">println&lt;/span>(test.&lt;span style="color:#658b00">NAME&lt;/span>);
}
}
ËæìÂá∫ÂºÇÂ∏∏ Can not set &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">final&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>‰øÆÊîπ&lt;code>Field&lt;/code>‰∏≠ÁöÑ&lt;code>modifiers&lt;/code>Êï∞ÊçÆÂüüÔºåÊ∏ÖÈô§‰ª£Ë°®&lt;code>final&lt;/code>ÁöÑÈÇ£‰∏™bitÔºåÊâçÂèØ‰ª•ÊàêÂäü‰øÆÊîπ„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">class&lt;/span> &lt;span style="color:#008b45;font-weight:bold">Test&lt;/span> {
&lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">final&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> String NAME = &lt;span style="color:#cd5555">&amp;#34;static hello world&amp;#34;&lt;/span>;
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">main&lt;/span>(String[] args) &lt;span style="color:#8b008b;font-weight:bold">throws&lt;/span> NoSuchFieldException, IllegalAccessException {
Test test = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> Test();
&lt;span style="color:#228b22">//‰øÆÊîπNAME
&lt;/span>&lt;span style="color:#228b22">&lt;/span> Field sfield = test.&lt;span style="color:#658b00">getClass&lt;/span>().&lt;span style="color:#658b00">getDeclaredField&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;NAME&amp;#34;&lt;/span>);
Field modifiers = sfield.&lt;span style="color:#658b00">getClass&lt;/span>().&lt;span style="color:#658b00">getDeclaredField&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;modifiers&amp;#34;&lt;/span>);
modifiers.&lt;span style="color:#658b00">setAccessible&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">true&lt;/span>);
modifiers.&lt;span style="color:#658b00">setInt&lt;/span>(sfield, sfield.&lt;span style="color:#658b00">getModifiers&lt;/span>() &amp;amp; ~Modifier.&lt;span style="color:#658b00">FINAL&lt;/span>);&lt;span style="color:#228b22">//fianlÊ†áÂøó‰ΩçÁΩÆ0
&lt;/span>&lt;span style="color:#228b22">&lt;/span>
sfield.&lt;span style="color:#658b00">setAccessible&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">true&lt;/span>);
sfield.&lt;span style="color:#658b00">set&lt;/span>(test,&lt;span style="color:#cd5555">&amp;#34;STATIC HELLO, WORLD!&amp;#34;&lt;/span>);
System.&lt;span style="color:#658b00">out&lt;/span>.&lt;span style="color:#658b00">println&lt;/span>(sfield.&lt;span style="color:#658b00">get&lt;/span>(test));
System.&lt;span style="color:#658b00">out&lt;/span>.&lt;span style="color:#658b00">println&lt;/span>(test.&lt;span style="color:#658b00">NAME&lt;/span>);
}
}
ËæìÂá∫
STATIC HELLO, WORLD!
&lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> hello world
&lt;/code>&lt;/pre>&lt;/div>- https://pinkhello.me/posts/02-%E5%85%B3%E4%BA%8Efinal%E7%9A%84%E6%80%9D%E8%80%83/ - PinkHello, All Rights Reserved</description></item><item><title>01 ‰∏ÄËá¥ÊÄßÂìàÂ∏åÁÆóÊ≥ï</title><link>https://pinkhello.me/posts/01-%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/</link><pubDate>Sat, 09 Feb 2019 22:50:46 +0800</pubDate><guid>https://pinkhello.me/posts/01-%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/</guid><description>PinkHello https://pinkhello.me/posts/01-%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/ -&lt;h1 id="ÂàÜÂ∏ÉÂºèÂùáË°°ÂØªÂùÄÁÆóÊ≥ï">ÂàÜÂ∏ÉÂºèÂùáË°°ÂØªÂùÄÁÆóÊ≥ï&lt;/h1>
&lt;p>Âú®ÂàÜÂ∏ÉÂºèÈõÜÁæ§‰∏≠ÔºåÂØπÊú∫Âô®ÁöÑÊ∑ªÂä†Âà†Èô§ÔºåÊàñËÄÖÊú∫Âô®ÊïÖÈöúÂêéËá™Âä®ËÑ±ËêΩÈõÜÁæ§ÁöÑÊìç‰ΩúÊòØÂàÜÂ∏ÉÂºèÈõÜÁæ§ÁÆ°ÁêÜÁöÑÂü∫Êú¨ÂäüËÉΩ„ÄÇ&lt;/p>
&lt;blockquote>
&lt;p>Âú®ÈõÜÁæ§ÁéØÂ¢É‰∏≠ÔºåÂà§Êñ≠ÂàÜÂ∏ÉÂºèÂØªÂùÄÁÆóÊ≥ïÂ•ΩÂùèÁöÑÂéüÂàôÔºö&lt;/p>
&lt;ul>
&lt;li>Âπ≥Ë°°ÊÄßÔºàBalanceÔºâ&lt;/li>
&lt;li>ÂçïË∞ÉÊÄßÔºàMonotonicityÔºâ&lt;/li>
&lt;li>ÂàÜÊï£ÊÄßÔºàSpreadÔºâ&lt;/li>
&lt;li>Ë¥üËΩΩÔºàLoadÔºâ&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;h2 id="hashobjectn">Hash(Object)%N&lt;/h2>
&lt;p>ÈõÜÁæ§NÂè∞Êú∫Âô®ÔºåÊ†πÊçÆNÂèñÊ®°ÔºåË∑ØÁî±Âà∞ÂØπÂ∫îÁöÑÊú∫Âô®Ôºå‰ΩÜÊòØÁº∫ÁÇπÂú®‰∫éÔºåÂØπ‰∫éÊú∫Âô®ÁöÑÊ∑ªÂä†Âà†Èô§ÔºåÂ∑≤ÁªèÁºìÂ≠òÁöÑÊï∞ÊçÆÈÉΩÂ§±Êïà„ÄÅ‰∏•ÈáçËøùÂèçÂçïË∞ÉÊÄßÔºå
Â§ßÈáèÁöÑÁºìÂ≠òÈáçÂª∫&lt;/p>
&lt;blockquote>
&lt;p>ÂÅáËÆæ0-3‰∏™ËäÇÁÇπ„ÄÅ20‰∏™Êï∞ÊçÆ:
&lt;img src="https://pinkhello.me/%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/hash.png" alt="ÂìàÂ∏åÊï∞ÊçÆ">&lt;/p>
&lt;p>ËøõË°åÂèñÊ®°ÂêéÂàÜÂ∏É:
&lt;img src="https://pinkhello.me/%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/hash1.png" alt="ÂìàÂ∏åÂèñÊ®°ÂêéÂàÜÂ∏É">&lt;/p>
&lt;p>Êâ©ÂÆπÂêé:
&lt;img src="https://pinkhello.me/%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/hash3.png" alt="Êâ©ÂÆπÂêé">
ÂΩìÂâçÂè™Êúâ4‰∏™Êï∞ÊçÆËÉΩÂëΩ‰∏≠„ÄÇÂëΩ‰∏≠Áéá 4/20 = 20% ,ÂëΩ‰∏≠ÁéáÂ∫ï‰∏ãÔºåÂπ∂‰∏îÊúâÂ§ßÈáèÁºìÂ≠òÈúÄË¶ÅÈáçÂª∫&lt;/p>
&lt;/blockquote>
&lt;h2 id="‰∏ÄËá¥ÊÄßhash--dht-">‰∏ÄËá¥ÊÄßHash ( DHT )&lt;/h2>
&lt;blockquote>
&lt;p>ÂÖ¨ÂÖ±ÂìàÂ∏åÂáΩÊï∞ÂíåÂìàÂ∏åÁéØ
HashÁÆóÊ≥ïËÆæËÆ°: ÈááÂèñÂèñÊ®°ÊñπÂºèÔºåÊåâÂ∏∏Áî®ÁöÑ Hash ÁÆóÊ≥ïÂ∞ÜÂØπÂ∫îÁöÑ Key ÂìàÂ∏åÂà∞‰∏Ä‰∏™ÂÖ∑Êúâ 2^32 Ê¨°ÊñπÁöÑÊ°∂Á©∫Èó¥‰∏≠ÔºåÂç≥ 0 ~ (2^32)-1 ÁöÑÊï∞Â≠óÁ©∫Èó¥„ÄÇÊÉ≥ÊÉ≥‰∏Ä‰∏ãÔºåÂ∞ÜÊï∞Â≠óÈ¶ñ‰ΩçÁõ∏ËøûÔºåÁªÑÊàê‰∏Ä‰∏™Èó≠ÂêàÁöÑÁéØÂΩ¢„ÄÇ
&lt;img src="https://pinkhello.me/%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/hash4.png" alt="ÁéØÂΩ¢HashÁ©∫Èó¥">&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>ÂØπË±°(Object)Êò†Â∞ÑÂà∞ÂìàÂ∏åÁéØ
ÊääÂØπË±°Êò†Â∞ÑÂà∞ 0-2^32-1 Á©∫Èó¥ÈáåÔºåÂÅáËÆæÊúâ4‰∏™ÂØπË±° object1-4 ÔºåÊò†Â∞ÑËøõhashÁéØÁä∂
&lt;img src="https://pinkhello.me/%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/hash5.png" alt="ÂØπË±°Êò†Â∞ÑÁéØÂΩ¢HashÁ©∫Èó¥">&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>ÁºìÂ≠ò(Cache)Êò†Â∞ÑÂà∞ÂìàÂ∏åÁéØ
‰∏ãÈù¢Â∞Ü Cache Êò†Â∞ÑËøõ Hash Á©∫Èó¥ÔºåÂÅáËÆæÁé∞Âú®Êúâ‰∏â‰∏™cacheÔºö&lt;/p>
&lt;blockquote>
&lt;p>Âü∫Êú¨ÊÄùÊÉ≥Â∞±ÊòØ Object Âíå Cache ÈÉΩÊò†Â∞ÑÂà∞Âêå‰∏Ä Hash Êï∞ÂÄºÁ©∫Èó¥‰∏≠ÔºåÂπ∂‰∏î‰ΩøÁî®Áõ∏ÂêåÁöÑ HashÁÆóÊ≥ïÔºåÂèØ‰ª•‰ΩøÁî® Cache ÁöÑ IPÂú∞ÂùÄÊàñËÄÖÂÖ∂‰ªñÂõ†Â≠êÔºâ&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://pinkhello.me/%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/hash6.png" alt="CacheÊò†Â∞ÑÁéØÂΩ¢HashÁ©∫Èó¥">&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>ÂØπË±°ÔºàObjectÊò†Â∞ÑÂà∞ÁºìÂ≠ò(Cache)ËäÇÁÇπ
ÊØè‰∏™ Cache ÁöÑ Key È°∫Êó∂ÈíàÔºåÊâæÂà∞Á¨¨‰∏Ä‰∏™ Cache ËäÇÁÇπÂ∞±ÊòØÂ≠òÂÇ®‰ΩçÁΩÆ:
&lt;img src="https://pinkhello.me/%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/hash7.png" alt="ÊâæÂà∞CacheÂ≠òÂÇ®‰ΩçÁΩÆ">&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>ÁßªÈô§‰∏Ä‰∏™ÁºìÂ≠òËäÇÁÇπ
ÁßªÈô§‰∏Ä‰∏™ CacheB ËäÇÁÇπ, ËøôÊó∂ÂÄô key4 Êó†Ê≥ïÊâæÂØªÂà∞ CacheÔºåkey4Â∞ÜÁªßÁª≠‰ΩøÁî®‰∏ÄËá¥ÊÄßHashÁÆóÊ≥ïÁÆóÂá∫ÊúÄÊñ∞ÁöÑ CacheC, ‰ª•ÂêéÂ≠òÂÇ®‰∏éËØªÂèñÈÉΩÂú® CacheC ‰∏ä„ÄÇ
&lt;img src="https://pinkhello.me/%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/hash8.png" alt="ÁßªÈô§CacheBËäÇÁÇπ">&lt;/p>
&lt;blockquote>
&lt;p>ÁßªÈô§ËäÇÁÇπÂêéÁöÑÂΩ±ÂìçËåÉÂõ¥Âú®ËØ•ËäÇÁÇπÈÄÜÊó∂ÈíàËÆ°ÁÆóÂà∞ÈÅáÂà∞ÁöÑÁ¨¨‰∏Ä‰∏™cacheËäÇÁÇπ‰πãÈó¥ÁöÑÊï∞ÊçÆËäÇÁÇπ„ÄÇ&lt;/p>
&lt;/blockquote>
&lt;/blockquote>
&lt;blockquote>
&lt;p>Â¢ûÂä†‰∏Ä‰∏™ÁºìÂ≠òËäÇÁÇπ
Â¢ûÂä†‰∏Ä‰∏™ CacheËäÇÁÇπ
&lt;img src="https://pinkhello.me/%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/hash9.png" alt="Êñ∞Â¢ûCacheËäÇÁÇπ">&lt;/p>
&lt;blockquote>
&lt;p>ÂΩ±ÂìçËåÉÂõ¥‰∏∫ÔºöÊ∑ªÂä†ËäÇÁÇπÈÄÜÊó∂ÈíàÈÅáÂà∞ÁöÑÁ¨¨‰∏Ä‰∏™cacheËäÇÁÇπ‰πãÈó¥ÁöÑÊï∞ÊçÆËäÇÁÇπ&lt;/p>
&lt;/blockquote>
&lt;/blockquote>
&lt;blockquote>
&lt;p>ËôöÊãüCacheËäÇÁÇπ
Áâ©ÁêÜ‰∏ä‰∏çÂèØËÉΩÈÉ®ÁΩ≤ËäÇÁÇπÊúâÈôêÔºåÊâÄ‰ª•ÈúÄË¶ÅËôöÊãüÂá∫Ë∂≥Â§üÂ§öÁöÑËôöÊãüËäÇÁÇπÔºåÊúÄÁªàËææÂà∞Êï∞ÊçÆÂú®ÂìàÂ∏åÊç¢‰∏äÂùáÂåÄÂàÜÂ∏É&lt;/p>
&lt;blockquote>
&lt;p>ÂÅáÂ¶ÇÂè™Êúâ‰∏§‰∏™ËäÇÁÇπ,ÊØè‰∏™ËäÇÁÇπÈÉΩÂ§çÂà∂Êàê3ÂÄçÔºåÁªìÊûúÁúã‰∏äÂéªÈÉ®ÁΩ≤‰∫Ü6‰∏™ËäÇÁÇπ„ÄÇÂèØ‰ª•ÊÉ≥Ë±°ÂΩìÂ§çÂà∂ÂÄçÊï∞ÊòØ 2^32 Êó∂ÂÄôÔºåÂ∞±ËææÂà∞ÁªùÂØπÁöÑÂùáÂåÄÔºåÈÄöÂ∏∏ÂèØÂèñÁöÑÂ§çÂà∂ÂÄçÊï∞‰∏∫32 ÊàñËÄÖÊõ¥È´ò&lt;/p>
&lt;/blockquote>
&lt;p>ËôöÊãüËäÇÁÇπÂìàÂ∏åÂÄºËÆ°ÁÆóÊñπÊ≥ïË∞ÉÊï¥‰∏∫ ÂØπ &amp;ldquo;ËäÇÁÇπIPÔºàÊàñÊú∫Âô®ÂêçÔºâ+ËôöÊãüËäÇÁÇπÁöÑÂ∫èÂè∑Ôºà1~NÔºâ&amp;rdquo; ‰ΩúÂìàÂ∏å&lt;/p>
&lt;/blockquote>
&lt;h1 id="redis-cluster">Redis Cluster&lt;/h1>
&lt;p>Redis Cluster ÊòØ Redis ÂÆòÊñπÂá∫ÂìÅÁöÑÂàÜÂ∏ÉÂºèËß£ÂÜ≥ÊñπÊ°à&lt;/p>
&lt;p>Redis Cluster Áî±Â§ö‰∏™ Redis ÂÆû‰æãÁªÑÊàêÁöÑÊï¥‰ΩìÔºåÊï∞ÊçÆÊåâÁÖß &lt;em>ÊßΩ(slot)&lt;/em> Â≠òÂÇ®ÂàÜÂ∏ÉÂú®Â§ö‰∏™ÂÆû‰æã‰∏äÔºåÈÄöËøá Gossip ÂçèËÆÆÊù•ËøõË°åËäÇÁÇπÈÄö‰ø°„ÄÇ&lt;/p>
&lt;p>redis ‰∏∫‰ªÄ‰πà‰ΩøÁî® 16384 slots? &lt;a href="https://github.com/antirez/redis/issues/2576">redis ‰ΩúËÄÖÁªôÂá∫Á≠îÊ°à&lt;/a>&lt;/p>
&lt;h1 id="‰∏ÄËá¥ÊÄßhashÁÆóÊ≥ïÁöÑjavaÂÆûÁé∞‰∏éÊ£ÄÈ™å">‰∏ÄËá¥ÊÄßhashÁÆóÊ≥ïÁöÑJAVAÂÆûÁé∞‰∏éÊ£ÄÈ™å&lt;/h1>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java"> &lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">class&lt;/span> &lt;span style="color:#008b45;font-weight:bold">ConsistentHashing&lt;/span> {
&lt;span style="color:#228b22">// Áâ©ÁêÜËäÇÁÇπ
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> Set&amp;lt;String&amp;gt; physicalNodes = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> TreeSet&amp;lt;String&amp;gt;() {
{
add(&lt;span style="color:#cd5555">&amp;#34;192.168.1.101&amp;#34;&lt;/span>);
add(&lt;span style="color:#cd5555">&amp;#34;192.168.1.102&amp;#34;&lt;/span>);
add(&lt;span style="color:#cd5555">&amp;#34;192.168.1.103&amp;#34;&lt;/span>);
add(&lt;span style="color:#cd5555">&amp;#34;192.168.1.104&amp;#34;&lt;/span>);
add(&lt;span style="color:#cd5555">&amp;#34;192.168.1.105&amp;#34;&lt;/span>);
add(&lt;span style="color:#cd5555">&amp;#34;192.168.1.106&amp;#34;&lt;/span>);
}
};
&lt;span style="color:#228b22">//ËôöÊãüËäÇÁÇπ
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">final&lt;/span> &lt;span style="color:#00688b;font-weight:bold">int&lt;/span> VIRTUAL_COPIES = 1; &lt;span style="color:#228b22">// Áâ©ÁêÜËäÇÁÇπËá≥ËôöÊãüËäÇÁÇπÁöÑÂ§çÂà∂ÂÄçÊï∞
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> TreeMap&amp;lt;Long, String&amp;gt; virtualNodes = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> TreeMap&amp;lt;&amp;gt;(); &lt;span style="color:#228b22">// ÂìàÂ∏åÂÄº =&amp;gt; Áâ©ÁêÜËäÇÁÇπ
&lt;/span>&lt;span style="color:#228b22">&lt;/span>
&lt;span style="color:#228b22">// 32‰ΩçÁöÑ Fowler-Noll-Vo ÂìàÂ∏åÁÆóÊ≥ï
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#228b22">// https://en.wikipedia.org/wiki/Fowler‚ÄìNoll‚ÄìVo_hash_function
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> Long &lt;span style="color:#008b45">FNVHash&lt;/span>(String key) {
&lt;span style="color:#8b008b;font-weight:bold">final&lt;/span> &lt;span style="color:#00688b;font-weight:bold">int&lt;/span> p = 16777619;
Long hash = 2166136261L;
&lt;span style="color:#8b008b;font-weight:bold">for&lt;/span> (&lt;span style="color:#00688b;font-weight:bold">int&lt;/span> idx = 0, num = key.&lt;span style="color:#658b00">length&lt;/span>(); idx &amp;lt; num; ++idx) {
hash = (hash ^ key.&lt;span style="color:#658b00">charAt&lt;/span>(idx)) * p;
}
hash += hash &amp;lt;&amp;lt; 13;
hash ^= hash &amp;gt;&amp;gt; 7;
hash += hash &amp;lt;&amp;lt; 3;
hash ^= hash &amp;gt;&amp;gt; 17;
hash += hash &amp;lt;&amp;lt; 5;
&lt;span style="color:#8b008b;font-weight:bold">if&lt;/span> (hash &amp;lt; 0) {
hash = Math.&lt;span style="color:#658b00">abs&lt;/span>(hash);
}
&lt;span style="color:#8b008b;font-weight:bold">return&lt;/span> hash;
}
&lt;span style="color:#228b22">// Ê†πÊçÆÁâ©ÁêÜËäÇÁÇπÔºåÊûÑÂª∫ËôöÊãüËäÇÁÇπÊò†Â∞ÑË°®
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#008b45">ConsistentHashing&lt;/span>() {
&lt;span style="color:#8b008b;font-weight:bold">for&lt;/span> (String nodeIp : physicalNodes) {
addPhysicalNode(nodeIp);
}
}
&lt;span style="color:#228b22">// Ê∑ªÂä†Áâ©ÁêÜËäÇÁÇπ
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">addPhysicalNode&lt;/span>(String nodeIp) {
&lt;span style="color:#8b008b;font-weight:bold">for&lt;/span> (&lt;span style="color:#00688b;font-weight:bold">int&lt;/span> idx = 0; idx &amp;lt; VIRTUAL_COPIES; ++idx) {
&lt;span style="color:#00688b;font-weight:bold">long&lt;/span> hash = FNVHash(nodeIp + &lt;span style="color:#cd5555">&amp;#34;#&amp;#34;&lt;/span> + idx);
virtualNodes.&lt;span style="color:#658b00">put&lt;/span>(hash, nodeIp);
}
}
&lt;span style="color:#228b22">// Âà†Èô§Áâ©ÁêÜËäÇÁÇπ
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">removePhysicalNode&lt;/span>(String nodeIp) {
&lt;span style="color:#8b008b;font-weight:bold">for&lt;/span> (&lt;span style="color:#00688b;font-weight:bold">int&lt;/span> idx = 0; idx &amp;lt; VIRTUAL_COPIES; ++idx) {
&lt;span style="color:#00688b;font-weight:bold">long&lt;/span> hash = FNVHash(nodeIp + &lt;span style="color:#cd5555">&amp;#34;#&amp;#34;&lt;/span> + idx);
virtualNodes.&lt;span style="color:#658b00">remove&lt;/span>(hash);
}
}
&lt;span style="color:#228b22">// Êü•ÊâæÂØπË±°Êò†Â∞ÑÁöÑËäÇÁÇπ
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> String &lt;span style="color:#008b45">getObjectNode&lt;/span>(String object) {
&lt;span style="color:#00688b;font-weight:bold">long&lt;/span> hash = FNVHash(object);
SortedMap&amp;lt;Long, String&amp;gt; tailMap = virtualNodes.&lt;span style="color:#658b00">tailMap&lt;/span>(hash); &lt;span style="color:#228b22">// ÊâÄÊúâÂ§ß‰∫é hash ÁöÑËäÇÁÇπ
&lt;/span>&lt;span style="color:#228b22">&lt;/span> Long key = tailMap.&lt;span style="color:#658b00">isEmpty&lt;/span>() ? virtualNodes.&lt;span style="color:#658b00">firstKey&lt;/span>() : tailMap.&lt;span style="color:#658b00">firstKey&lt;/span>();
&lt;span style="color:#8b008b;font-weight:bold">return&lt;/span> virtualNodes.&lt;span style="color:#658b00">get&lt;/span>(key);
}
&lt;span style="color:#228b22">// ÁªüËÆ°ÂØπË±°‰∏éËäÇÁÇπÁöÑÊò†Â∞ÑÂÖ≥Á≥ª
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">dumpObjectNodeMap&lt;/span>(String label, &lt;span style="color:#00688b;font-weight:bold">int&lt;/span> objectMin, &lt;span style="color:#00688b;font-weight:bold">int&lt;/span> objectMax) {
&lt;span style="color:#228b22">// ÁªüËÆ°
&lt;/span>&lt;span style="color:#228b22">&lt;/span> Map&amp;lt;String, Integer&amp;gt; objectNodeMap = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> TreeMap&amp;lt;&amp;gt;(); &lt;span style="color:#228b22">// IP =&amp;gt; COUNT
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">for&lt;/span> (&lt;span style="color:#00688b;font-weight:bold">int&lt;/span> object = objectMin; object &amp;lt;= objectMax; ++object) {
String nodeIp = getObjectNode(Integer.&lt;span style="color:#658b00">toString&lt;/span>(object));
Integer count = objectNodeMap.&lt;span style="color:#658b00">get&lt;/span>(nodeIp);
objectNodeMap.&lt;span style="color:#658b00">put&lt;/span>(nodeIp, (count == &lt;span style="color:#8b008b;font-weight:bold">null&lt;/span> ? 0 : count + 1));
}
&lt;span style="color:#228b22">// ÊâìÂç∞
&lt;/span>&lt;span style="color:#228b22">&lt;/span> &lt;span style="color:#00688b;font-weight:bold">double&lt;/span> totalCount = objectMax - objectMin + 1;
System.&lt;span style="color:#658b00">out&lt;/span>.&lt;span style="color:#658b00">println&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;======== &amp;#34;&lt;/span> + label + &lt;span style="color:#cd5555">&amp;#34; ========&amp;#34;&lt;/span>);
&lt;span style="color:#8b008b;font-weight:bold">for&lt;/span> (Map.&lt;span style="color:#658b00">Entry&lt;/span>&amp;lt;String, Integer&amp;gt; entry : objectNodeMap.&lt;span style="color:#658b00">entrySet&lt;/span>()) {
&lt;span style="color:#00688b;font-weight:bold">long&lt;/span> percent = (&lt;span style="color:#00688b;font-weight:bold">int&lt;/span>) (100 * entry.&lt;span style="color:#658b00">getValue&lt;/span>() / totalCount);
System.&lt;span style="color:#658b00">out&lt;/span>.&lt;span style="color:#658b00">println&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;IP=&amp;#34;&lt;/span> + entry.&lt;span style="color:#658b00">getKey&lt;/span>() + &lt;span style="color:#cd5555">&amp;#34;: RATE=&amp;#34;&lt;/span> + percent + &lt;span style="color:#cd5555">&amp;#34;%&amp;#34;&lt;/span>);
}
}
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">main&lt;/span>(String[] args) {
ConsistentHashing ch = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> ConsistentHashing();
&lt;span style="color:#228b22">// ÂàùÂßãÊÉÖÂÜµ
&lt;/span>&lt;span style="color:#228b22">&lt;/span> ch.&lt;span style="color:#658b00">dumpObjectNodeMap&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;ÂàùÂßãÊÉÖÂÜµ&amp;#34;&lt;/span>, 0, 65536);
&lt;span style="color:#228b22">// Âà†Èô§Áâ©ÁêÜËäÇÁÇπ
&lt;/span>&lt;span style="color:#228b22">&lt;/span> ch.&lt;span style="color:#658b00">removePhysicalNode&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;192.168.1.105&amp;#34;&lt;/span>);
ch.&lt;span style="color:#658b00">dumpObjectNodeMap&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;Âà†Èô§Áâ©ÁêÜËäÇÁÇπ&amp;#34;&lt;/span>, 0, 65536);
&lt;span style="color:#228b22">// Ê∑ªÂä†Áâ©ÁêÜËäÇÁÇπ
&lt;/span>&lt;span style="color:#228b22">&lt;/span> ch.&lt;span style="color:#658b00">addPhysicalNode&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;192.168.1.107&amp;#34;&lt;/span>);
ch.&lt;span style="color:#658b00">dumpObjectNodeMap&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;Ê∑ªÂä†Áâ©ÁêÜËäÇÁÇπ&amp;#34;&lt;/span>, 0, 65536);
}
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Â§çÂà∂ÂÄçÊï∞‰∏∫ 1 Êó∂ÁöÑÂùáË°°ÊÄßÔºàVIRTUAL_COPIES = 1Ôºâ&lt;/p>
&lt;pre>&lt;code> ======== ÂàùÂßãÊÉÖÂÜµ ========
IP=192.168.1.101: RATE=28%
IP=192.168.1.102: RATE=3%
IP=192.168.1.103: RATE=28%
IP=192.168.1.104: RATE=19%
IP=192.168.1.105: RATE=16%
IP=192.168.1.106: RATE=2%
======== Âà†Èô§Áâ©ÁêÜËäÇÁÇπ ========
IP=192.168.1.101: RATE=45%
IP=192.168.1.102: RATE=3%
IP=192.168.1.103: RATE=28%
IP=192.168.1.104: RATE=19%
IP=192.168.1.106: RATE=2%
======== Ê∑ªÂä†Áâ©ÁêÜËäÇÁÇπ ========
IP=192.168.1.101: RATE=45%
IP=192.168.1.102: RATE=3%
IP=192.168.1.103: RATE=25%
IP=192.168.1.104: RATE=19%
IP=192.168.1.106: RATE=2%
IP=192.168.1.107: RATE=3%
&lt;/code>&lt;/pre>&lt;p>Â§çÂà∂ÂÄçÊï∞‰∏∫ 32 Êó∂ÁöÑÂùáË°°ÊÄßÔºàVIRTUAL_COPIES = 32Ôºâ&lt;/p>
&lt;pre>&lt;code> ======== ÂàùÂßãÊÉÖÂÜµ ========
IP=192.168.1.101: RATE=17%
IP=192.168.1.102: RATE=12%
IP=192.168.1.103: RATE=23%
IP=192.168.1.104: RATE=12%
IP=192.168.1.105: RATE=12%
IP=192.168.1.106: RATE=21%
======== Âà†Èô§Áâ©ÁêÜËäÇÁÇπ ========
IP=192.168.1.101: RATE=17%
IP=192.168.1.102: RATE=12%
IP=192.168.1.103: RATE=25%
IP=192.168.1.104: RATE=23%
IP=192.168.1.106: RATE=21%
======== Ê∑ªÂä†Áâ©ÁêÜËäÇÁÇπ ========
IP=192.168.1.101: RATE=16%
IP=192.168.1.102: RATE=12%
IP=192.168.1.103: RATE=14%
IP=192.168.1.104: RATE=23%
IP=192.168.1.106: RATE=15%
IP=192.168.1.107: RATE=17%
&lt;/code>&lt;/pre>&lt;p>Â§çÂà∂ÂÄçÊï∞‰∏∫ 1M Êó∂ÁöÑÂùáË°°ÊÄßÔºàVIRTUAL_COPIES = 1048576Ôºâ&lt;/p>
&lt;pre>&lt;code> ======== ÂàùÂßãÊÉÖÂÜµ ========
IP=192.168.1.101: RATE=16%
IP=192.168.1.102: RATE=16%
IP=192.168.1.103: RATE=16%
IP=192.168.1.104: RATE=16%
IP=192.168.1.105: RATE=16%
IP=192.168.1.106: RATE=16%
======== Âà†Èô§Áâ©ÁêÜËäÇÁÇπ ========
IP=192.168.1.101: RATE=19%
IP=192.168.1.102: RATE=19%
IP=192.168.1.103: RATE=20%
IP=192.168.1.104: RATE=19%
IP=192.168.1.106: RATE=19%
======== Ê∑ªÂä†Áâ©ÁêÜËäÇÁÇπ ========
IP=192.168.1.101: RATE=16%
IP=192.168.1.102: RATE=16%
IP=192.168.1.103: RATE=16%
IP=192.168.1.104: RATE=16%
IP=192.168.1.106: RATE=16%
IP=192.168.1.107: RATE=16%
&lt;/code>&lt;/pre>- https://pinkhello.me/posts/01-%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/ - PinkHello, All Rights Reserved</description></item><item><title>00 Threadlocal È≠îÊ≥ï</title><link>https://pinkhello.me/posts/00-threadlocal-%E9%AD%94%E6%B3%95/</link><pubDate>Sat, 09 Feb 2019 22:25:26 +0800</pubDate><guid>https://pinkhello.me/posts/00-threadlocal-%E9%AD%94%E6%B3%95/</guid><description>PinkHello https://pinkhello.me/posts/00-threadlocal-%E9%AD%94%E6%B3%95/ -&lt;h1 id="threadlocal-ËØ¶Ëß£">&lt;code>ThreadLocal&lt;/code> ËØ¶Ëß£&lt;/h1>
&lt;h2 id="ÂâçË®Ä">ÂâçË®Ä&lt;/h2>
&lt;p>ÂØπ‰∫é &lt;code>ThreadLocal&lt;/code> ÁöÑ‰ΩøÁî®ÔºåÂπ∂‰∏çÈöæÔºåËøôÊ¨°‰∏ªË¶ÅËÆ≤Ëø∞ &lt;code>ThreadLocal&lt;/code> ÁöÑÂÆûÁé∞ÊñπÂºè‰ª•ÂèäÂéüÁêÜ&lt;/p>
&lt;h2 id="threadlocal-ÊòØ‰ªÄ‰πà">&lt;code>ThreadLocal&lt;/code> ÊòØ‰ªÄ‰πà&lt;/h2>
&lt;p>&lt;code>ThreadLocal&lt;/code> ‰∏∫Ëß£ÂÜ≥Â§öÁ∫øÁ®ãÂπ∂ÂèëÈóÆÈ¢òÊèê‰æõÁöÑ‰∏ÄÁßçÊñ∞ÁöÑÊÄùË∑Ø„ÄÇ&lt;/p>
&lt;p>ÂΩì‰ΩøÁî® &lt;code>ThreadLocal&lt;/code> Áª¥Êä§ÂèòÈáèÁöÑÊó∂ÂÄôÔºå&lt;code>ThreadLocal&lt;/code> ‰∏∫ÊØè‰∏™‰ΩøÁî®ËØ•ÂèòÈáèÁöÑÁ∫øÁ®ãÊèê‰æõÁã¨Á´ãÁöÑÂèòÈáèÂâØÊú¨ÔºåÊâÄ‰ª•ÊØè‰∏™Á∫øÁ®ãÈÉΩÂèØ‰ª•Áã¨Á´ã‰øÆÊîπËá™Â∑±ÁöÑÂâØÊú¨ÔºåËÄå‰∏ç‰ºö‰øÆÊîπÂà∞ÂÖ∂‰ªñ‰∫∫ÁöÑÂèòÈáèÂâØÊú¨„ÄÇ&lt;/p>
&lt;p>‰ªéÁ∫øÁ®ãËßíÂ∫¶ÁúãÔºå&lt;code>Local&lt;/code> Âç≥Êú¨Âú∞ÊÑèÊÄùÔºåÁõÆÊ†áÂèòÈáèÂ∞±ÂÉèÊòØÁ∫øÁ®ãÁöÑÊú¨Âú∞ÂèòÈáè„ÄÇ&lt;/p>
&lt;h3 id="ÂéüÁêÜ">ÂéüÁêÜ&lt;/h3>
&lt;p>&lt;code>ThreadLocal&lt;/code> ÊòØËøûÊé• &lt;code>Thread&lt;/code> ‰∏é &lt;code>ThreadLocalMap&lt;/code> Á≤òÂêàÂâÇÔºåÊòØÁî®Êù•Â§ÑÁêÜ &lt;code>Thread&lt;/code> ÁöÑ &lt;code>ThreadLocalMap&lt;/code> Â±ûÊÄßÔºå
ÂåÖÊã¨ &lt;em>initialValue()&lt;/em> ÂèòÈáèÔºå&lt;em>set&lt;/em> ÂØπÂ∫îÁöÑÂèòÈáèÔºå&lt;em>get&lt;/em> ÂØπÂ∫îÁöÑÂèòÈáè„ÄÇ&lt;/p>
&lt;p>&lt;code>ThreadLocalMap&lt;/code> Áî®Êù•Â≠òÂÇ®Êï∞ÊçÆÔºåÈááÁî®Á±ª‰ºº&lt;code>HashMap&lt;/code>ÁöÑÊú∫Âà∂ÔºåÂ≠òÂÇ®‰∫Ü‰ª•&lt;code>ThreadLocal&lt;/code>‰∏∫&lt;code>Key&lt;/code>ÔºåÁõÆÊ†áÊï∞ÊçÆ‰∏∫&lt;code>Value&lt;/code>ÁöÑ&lt;code>Entry&lt;/code>ÈîÆÂÄºÂØπÊï∞ÁªÑÁªìÊûÑ„ÄÇ&lt;/p>
&lt;p>&lt;code>Thread&lt;/code> Êúâ‰∏™ &lt;em>ThreadLocalMap&lt;/em> ÁöÑÂ±ûÊÄßÔºåÂ≠òÂÇ®ÁöÑÊï∞ÊçÆÂ≠òÊîæÂú®Ê≠§Â§Ñ„ÄÇ&lt;/p>
&lt;h3 id="threadthreadlocal-threadlocalmapÁöÑÂÖ≥Á≥ª">&lt;code>Thread&lt;/code>„ÄÅ&lt;code>ThreadLocal&lt;/code>„ÄÅ &lt;code>ThreadLocalMap&lt;/code>ÁöÑÂÖ≥Á≥ª&lt;/h3>
&lt;p>&lt;code>ThreadLocalMap&lt;/code> ÊòØ &lt;code>ThreadLocal&lt;/code> ÁöÑÂÜÖÈÉ®Á±ªÔºåÊúâ &lt;code>ThreadLocal&lt;/code>ÂàõÂª∫Ôºå&lt;code>Thread&lt;/code>Êúâ &lt;code>ThreadLocal.ThreadLocalMap&lt;/code> Á±ªÂûãÁöÑÂ±ûÊÄßÔºåÊ∫êÁ†ÅÂ¶Ç‰∏ã&lt;/p>
&lt;h4 id="thread">Thread&lt;/h4>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java"> &lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">class&lt;/span> &lt;span style="color:#008b45;font-weight:bold">Thread&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">implements&lt;/span> Runnable {
&lt;span style="color:#228b22">/*
&lt;/span>&lt;span style="color:#228b22"> * ThreadLocal values pertaining to this thread. This map is maintained
&lt;/span>&lt;span style="color:#228b22"> * by the ThreadLocal class.
&lt;/span>&lt;span style="color:#228b22"> */&lt;/span>
ThreadLocal.&lt;span style="color:#658b00">ThreadLocalMap&lt;/span> threadLocals = &lt;span style="color:#8b008b;font-weight:bold">null&lt;/span>;
&lt;span style="color:#228b22">/*
&lt;/span>&lt;span style="color:#228b22"> * InheritableThreadLocal values pertaining to this thread. This map is
&lt;/span>&lt;span style="color:#228b22"> * maintained by the InheritableThreadLocal class.
&lt;/span>&lt;span style="color:#228b22"> */&lt;/span>
ThreadLocal.&lt;span style="color:#658b00">ThreadLocalMap&lt;/span> inheritableThreadLocals = &lt;span style="color:#8b008b;font-weight:bold">null&lt;/span>;
}
&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="threadlocal-Âíå-threadlocalmap">&lt;code>ThreadLocal&lt;/code> Âíå &lt;code>ThreadLocalMap&lt;/code>&lt;/h4>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java"> &lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">class&lt;/span> &lt;span style="color:#008b45;font-weight:bold">ThreadLocal&lt;/span>&amp;lt;T&amp;gt; {
&lt;span style="color:#228b22">/**
&lt;/span>&lt;span style="color:#228b22"> * ThreadLocalMap is a customized hash map suitable only for
&lt;/span>&lt;span style="color:#228b22"> * maintaining thread local values. No operations are exported
&lt;/span>&lt;span style="color:#228b22"> * outside of the ThreadLocal class. The class is package private to
&lt;/span>&lt;span style="color:#228b22"> * allow declaration of fields in class Thread. To help deal with
&lt;/span>&lt;span style="color:#228b22"> * very large and long-lived usages, the hash table entries use
&lt;/span>&lt;span style="color:#228b22"> * WeakReferences for keys. However, since reference queues are not
&lt;/span>&lt;span style="color:#228b22"> * used, stale entries are guaranteed to be removed only when
&lt;/span>&lt;span style="color:#228b22"> * the table starts running out of space.
&lt;/span>&lt;span style="color:#228b22"> */&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">class&lt;/span> &lt;span style="color:#008b45;font-weight:bold">ThreadLocalMap&lt;/span> {
&lt;span style="color:#228b22">/**
&lt;/span>&lt;span style="color:#228b22"> * The entries in this hash map extend WeakReference, using
&lt;/span>&lt;span style="color:#228b22"> * its main ref field as the key (which is always a
&lt;/span>&lt;span style="color:#228b22"> * ThreadLocal object). Note that null keys (i.e. entry.get()
&lt;/span>&lt;span style="color:#228b22"> * == null) mean that the key is no longer referenced, so the
&lt;/span>&lt;span style="color:#228b22"> * entry can be expunged from table. Such entries are referred to
&lt;/span>&lt;span style="color:#228b22"> * as &amp;#34;stale entries&amp;#34; in the code that follows.
&lt;/span>&lt;span style="color:#228b22"> */&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">class&lt;/span> &lt;span style="color:#008b45;font-weight:bold">Entry&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">extends&lt;/span> WeakReference&amp;lt;ThreadLocal&amp;lt;?&amp;gt;&amp;gt; {
&lt;span style="color:#228b22">/** The value associated with this ThreadLocal. */&lt;/span>
Object value;
Entry(ThreadLocal&amp;lt;?&amp;gt; k, Object v) {
&lt;span style="color:#8b008b;font-weight:bold">super&lt;/span>(k);
value = v;
}
}
}
}
&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="threadlocal-‰∏∫-thread-ÁöÑ-threadlocalmap-ËøõË°åËµãÂÄº">&lt;code>ThreadLocal&lt;/code> ‰∏∫ &lt;code>Thread&lt;/code> ÁöÑ &lt;code>ThreadLocalMap&lt;/code> ËøõË°åËµãÂÄº&lt;/h4>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java"> &lt;span style="color:#228b22">/**
&lt;/span>&lt;span style="color:#228b22"> * Create the map associated with a ThreadLocal. Overridden in
&lt;/span>&lt;span style="color:#228b22"> * InheritableThreadLocal.
&lt;/span>&lt;span style="color:#228b22"> *
&lt;/span>&lt;span style="color:#228b22"> * @param t the current thread
&lt;/span>&lt;span style="color:#228b22"> * @param firstValue value for the initial entry of the map
&lt;/span>&lt;span style="color:#228b22"> */&lt;/span>
&lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">createMap&lt;/span>(Thread t, T firstValue) {
t.&lt;span style="color:#658b00">threadLocals&lt;/span> = &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> ThreadLocalMap(&lt;span style="color:#8b008b;font-weight:bold">this&lt;/span>, firstValue);
}
&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;em>ThreadLocal&lt;/em> Áõ¥Êé•ÂàõÂª∫‰∏Ä‰∏™ &lt;em>ThreadLocalMap&lt;/em> Âá∫Êù•Ôºå‰ª•ÂΩìÂâç &lt;em>ThreadLocal&lt;/em> ÁöÑÂØπË±°‰∏∫ &lt;em>key&lt;/em> Ôºå‰ª•ÁõÆÊ†áÂÄº‰∏∫ &lt;em>value&lt;/em> Â≠òÂÖ•&lt;/li>
&lt;/ul>
&lt;h5 id="threadlocal-Ê†∏ÂøÉÁöÑÊñπÊ≥ï">&lt;code>ThreadLocal&lt;/code> Ê†∏ÂøÉÁöÑÊñπÊ≥ï&lt;/h5>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java"> &lt;span style="color:#228b22">/**
&lt;/span>&lt;span style="color:#228b22"> * Sets the current thread&amp;#39;s copy of this thread-local variable
&lt;/span>&lt;span style="color:#228b22"> * to the specified value. Most subclasses will have no need to
&lt;/span>&lt;span style="color:#228b22"> * override this method, relying solely on the {@link #initialValue}
&lt;/span>&lt;span style="color:#228b22"> * method to set the values of thread-locals.
&lt;/span>&lt;span style="color:#228b22"> *
&lt;/span>&lt;span style="color:#228b22"> * @param value the value to be stored in the current thread&amp;#39;s copy of
&lt;/span>&lt;span style="color:#228b22"> * this thread-local.
&lt;/span>&lt;span style="color:#228b22"> */&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">set&lt;/span>(T value) {
Thread t = Thread.&lt;span style="color:#658b00">currentThread&lt;/span>();
ThreadLocalMap map = getMap(t);
&lt;span style="color:#8b008b;font-weight:bold">if&lt;/span> (map != &lt;span style="color:#8b008b;font-weight:bold">null&lt;/span>)
map.&lt;span style="color:#658b00">set&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">this&lt;/span>, value);
&lt;span style="color:#8b008b;font-weight:bold">else&lt;/span>
createMap(t, value);
}
&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>set(T)&lt;/code> ËÆæÁΩÆÂΩìÂâçÁ∫øÁ®ãÁöÑÂ±ÄÈÉ®ÂèòÈáèÔºå‰ª•ÂΩìÂâçÁöÑ &lt;code>ThreadLocal&lt;/code> ÂØπË±° ‰∏∫ÈîÆÔºåÁõÆÊ†áÂèòÈáèÂØπË±°‰∏∫ÂÄºÂ≠òÂÖ•ÂΩìÂâçÁ∫øÁ®ãÁöÑ &lt;code>ThreadLocalMap&lt;/code> ÂØπË±°‰∏≠&lt;/li>
&lt;li>Âú®Ëé∑ÂèñÂΩìÂâçÁ∫øÁ®ãÁöÑ &lt;code>ThreadLocalMap&lt;/code> ÁöÑÊó∂ÂÄôÔºå‰∏çÂ≠òÂú®ÁöÑÊó∂ÂÄô‰ºöÂàõÂª∫‰∏Ä‰∏™ &lt;code>ThreadLocalMap&lt;/code> Ôºå‰πüÂ∞±ÊòØËØ¥Ôºå&lt;code>Thread&lt;/code> ÁöÑ&lt;code>ThreadLocal.ThreadLocalMap&lt;/code> ÂØπË±°ÊòØÁî± &lt;code>ThreadLocal&lt;/code> ÂÆû‰æãÂåñÂ§ÑÁêÜÁöÑ&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java"> &lt;span style="color:#228b22">/**
&lt;/span>&lt;span style="color:#228b22"> * Returns the value in the current thread&amp;#39;s copy of this
&lt;/span>&lt;span style="color:#228b22"> * thread-local variable. If the variable has no value for the
&lt;/span>&lt;span style="color:#228b22"> * current thread, it is first initialized to the value returned
&lt;/span>&lt;span style="color:#228b22"> * by an invocation of the {@link #initialValue} method.
&lt;/span>&lt;span style="color:#228b22"> *
&lt;/span>&lt;span style="color:#228b22"> * @return the current thread&amp;#39;s value of this thread-local
&lt;/span>&lt;span style="color:#228b22"> */&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> T &lt;span style="color:#008b45">get&lt;/span>() {
Thread t = Thread.&lt;span style="color:#658b00">currentThread&lt;/span>();
ThreadLocalMap map = getMap(t);
&lt;span style="color:#8b008b;font-weight:bold">if&lt;/span> (map != &lt;span style="color:#8b008b;font-weight:bold">null&lt;/span>) {
ThreadLocalMap.&lt;span style="color:#658b00">Entry&lt;/span> e = map.&lt;span style="color:#658b00">getEntry&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">this&lt;/span>);
&lt;span style="color:#8b008b;font-weight:bold">if&lt;/span> (e != &lt;span style="color:#8b008b;font-weight:bold">null&lt;/span>) {
&lt;span style="color:#707a7c">@SuppressWarnings&lt;/span>(&lt;span style="color:#cd5555">&amp;#34;unchecked&amp;#34;&lt;/span>)
T result = (T)e.&lt;span style="color:#658b00">value&lt;/span>;
&lt;span style="color:#8b008b;font-weight:bold">return&lt;/span> result;
}
}
&lt;span style="color:#8b008b;font-weight:bold">return&lt;/span> setInitialValue();
}
&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>get()&lt;/code> ‰∏∫‰ªé &lt;code>ThreadLocalMap&lt;/code> ‰∏≠Ëé∑ÂèñÂÄºÔºåÂ¶ÇÊûú &lt;code>ThreadLocalMap&lt;/code> ‰∏çÂ≠òÂú®ÔºåÂàôËµ∞ &lt;code>setInitialValue&lt;/code> ÊñπÂºèÔºåÂê¶ÂàôÂèñÂá∫‰πãÂâçËÆæÁΩÆÁöÑÂÄº&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java"> &lt;span style="color:#228b22">/**
&lt;/span>&lt;span style="color:#228b22"> * Get the map associated with a ThreadLocal. Overridden in
&lt;/span>&lt;span style="color:#228b22"> * InheritableThreadLocal.
&lt;/span>&lt;span style="color:#228b22"> *
&lt;/span>&lt;span style="color:#228b22"> * @param t the current thread
&lt;/span>&lt;span style="color:#228b22"> * @return the map
&lt;/span>&lt;span style="color:#228b22"> */&lt;/span>
ThreadLocalMap &lt;span style="color:#008b45">getMap&lt;/span>(Thread t) {
&lt;span style="color:#8b008b;font-weight:bold">return&lt;/span> t.&lt;span style="color:#658b00">threadLocals&lt;/span>;
}
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java"> &lt;span style="color:#228b22">/**
&lt;/span>&lt;span style="color:#228b22"> * Returns the current thread&amp;#39;s &amp;#34;initial value&amp;#34; for this
&lt;/span>&lt;span style="color:#228b22"> * thread-local variable. This method will be invoked the first
&lt;/span>&lt;span style="color:#228b22"> * time a thread accesses the variable with the {@link #get}
&lt;/span>&lt;span style="color:#228b22"> * method, unless the thread previously invoked the {@link #set}
&lt;/span>&lt;span style="color:#228b22"> * method, in which case the {@code initialValue} method will not
&lt;/span>&lt;span style="color:#228b22"> * be invoked for the thread. Normally, this method is invoked at
&lt;/span>&lt;span style="color:#228b22"> * most once per thread, but it may be invoked again in case of
&lt;/span>&lt;span style="color:#228b22"> * subsequent invocations of {@link #remove} followed by {@link #get}.
&lt;/span>&lt;span style="color:#228b22"> *
&lt;/span>&lt;span style="color:#228b22"> * This implementation simply returns {@code null}; if the
&lt;/span>&lt;span style="color:#228b22"> * programmer desires thread-local variables to have an initial
&lt;/span>&lt;span style="color:#228b22"> * value other than {@code null}, {@code ThreadLocal} must be
&lt;/span>&lt;span style="color:#228b22"> * subclassed, and this method overridden. Typically, an
&lt;/span>&lt;span style="color:#228b22"> * anonymous inner class will be used.
&lt;/span>&lt;span style="color:#228b22"> *
&lt;/span>&lt;span style="color:#228b22"> * @return the initial value for this thread-local
&lt;/span>&lt;span style="color:#228b22"> */&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">protected&lt;/span> T &lt;span style="color:#008b45">initialValue&lt;/span>() {
&lt;span style="color:#8b008b;font-weight:bold">return&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">null&lt;/span>;
}
&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>initialValue()&lt;/code> ËøîÂõû‰∫ÜËØ•Á∫øÁ®ãÂèòÈáèÁöÑÂàùÂßãÂÄºÔºåÊòØ‰∏Ä‰∏™‰øùÊä§ÊñπÊ≥ïÔºå‰∏∫‰∫ÜËÆ©Â≠êÁ±ªË¶ÜÁõñÊ≠§ÊñπÊ≥ïÔºå&lt;/li>
&lt;li>Ê≠§ÊñπÊ≥ïÂè™ÊâßË°å‰∏ÄÊ¨°ÔºåÊòØ‰∏Ä‰∏™Âª∂ËøüÊñπÊ≥ïÔºåÂú®Ë∞ÉÁî® &lt;code>set&lt;/code> Êàñ &lt;code>get&lt;/code> ÁöÑÊó∂ÂÄôÂàõÂª∫Âá∫Êù•&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java"> &lt;span style="color:#228b22">/**
&lt;/span>&lt;span style="color:#228b22"> * Creates a thread local variable. The initial value of the variable is
&lt;/span>&lt;span style="color:#228b22"> * determined by invoking the {@code get} method on the {@code Supplier}.
&lt;/span>&lt;span style="color:#228b22"> *
&lt;/span>&lt;span style="color:#228b22"> * @param the type of the thread local&amp;#39;s value
&lt;/span>&lt;span style="color:#228b22"> * @param supplier the supplier to be used to determine the initial value
&lt;/span>&lt;span style="color:#228b22"> * @return a new thread local variable
&lt;/span>&lt;span style="color:#228b22"> * @throws NullPointerException if the specified supplier is null
&lt;/span>&lt;span style="color:#228b22"> * @since 1.8
&lt;/span>&lt;span style="color:#228b22"> */&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">static&lt;/span> &amp;lt;S&amp;gt; ThreadLocal&amp;lt;S&amp;gt; &lt;span style="color:#008b45">withInitial&lt;/span>(Supplier&amp;lt;? &lt;span style="color:#8b008b;font-weight:bold">extends&lt;/span> S&amp;gt; supplier) {
&lt;span style="color:#8b008b;font-weight:bold">return&lt;/span> &lt;span style="color:#8b008b;font-weight:bold">new&lt;/span> SuppliedThreadLocal&amp;lt;&amp;gt;(supplier);
}
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java"> &lt;span style="color:#228b22">/**
&lt;/span>&lt;span style="color:#228b22"> * Variant of set() to establish initialValue. Used instead
&lt;/span>&lt;span style="color:#228b22"> * of set() in case user has overridden the set() method.
&lt;/span>&lt;span style="color:#228b22"> *
&lt;/span>&lt;span style="color:#228b22"> * @return the initial value
&lt;/span>&lt;span style="color:#228b22"> */&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">private&lt;/span> T &lt;span style="color:#008b45">setInitialValue&lt;/span>() {
T value = initialValue();
Thread t = Thread.&lt;span style="color:#658b00">currentThread&lt;/span>();
ThreadLocalMap map = getMap(t);
&lt;span style="color:#8b008b;font-weight:bold">if&lt;/span> (map != &lt;span style="color:#8b008b;font-weight:bold">null&lt;/span>)
map.&lt;span style="color:#658b00">set&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">this&lt;/span>, value);
&lt;span style="color:#8b008b;font-weight:bold">else&lt;/span>
createMap(t, value);
&lt;span style="color:#8b008b;font-weight:bold">return&lt;/span> value;
}
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java"> &lt;span style="color:#228b22">/**
&lt;/span>&lt;span style="color:#228b22"> * Removes the current thread&amp;#39;s value for this thread-local
&lt;/span>&lt;span style="color:#228b22"> * variable. If this thread-local variable is subsequently
&lt;/span>&lt;span style="color:#228b22"> * {@linkplain #get read} by the current thread, its value will be
&lt;/span>&lt;span style="color:#228b22"> * reinitialized by invoking its {@link #initialValue} method,
&lt;/span>&lt;span style="color:#228b22"> * unless its value is {@linkplain #set set} by the current thread
&lt;/span>&lt;span style="color:#228b22"> * in the interim. This may result in multiple invocations of the
&lt;/span>&lt;span style="color:#228b22"> * {@code initialValue} method in the current thread.
&lt;/span>&lt;span style="color:#228b22"> *
&lt;/span>&lt;span style="color:#228b22"> * @since 1.5
&lt;/span>&lt;span style="color:#228b22"> */&lt;/span>
&lt;span style="color:#8b008b;font-weight:bold">public&lt;/span> &lt;span style="color:#00688b;font-weight:bold">void&lt;/span> &lt;span style="color:#008b45">remove&lt;/span>() {
ThreadLocalMap m = getMap(Thread.&lt;span style="color:#658b00">currentThread&lt;/span>());
&lt;span style="color:#8b008b;font-weight:bold">if&lt;/span> (m != &lt;span style="color:#8b008b;font-weight:bold">null&lt;/span>)
m.&lt;span style="color:#658b00">remove&lt;/span>(&lt;span style="color:#8b008b;font-weight:bold">this&lt;/span>);
}
&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>remove()&lt;/code> ÊñπÊ≥ïËé∑ÂèñÂΩìÂâçÁ∫øÁ®ãÁöÑÂâØÊú¨ÂèòÈáèÔºåÊù•ÊåáÂÆöÁßªÈô§ÂØπÂ∫îÁöÑÂÄº;&lt;/li>
&lt;li>Ê≠§ÊñπÊ≥ï‰∏∫ 1.5 ÂºïÂÖ•ÔºåÊó®Âú®ÂçèÂä©&lt;code>jvm&lt;/code>ËøõË°åÊúâÊïàÁöÑÂø´ÈÄü &lt;code>gc&lt;/code>Ôºõ&lt;/li>
&lt;li>ÂÅáÂ¶Ç‰∏çÁßªÈô§ &lt;code>ThreadLocal&lt;/code> ÂâØÊú¨ÂèòÈáè Âè¶Â§ñ &lt;code>ThreadLocalMap&lt;/code> ÁöÑ &lt;code>key&lt;/code> ‰∏∫Âº±ÂºïÁî®&lt;/li>
&lt;/ul>
- https://pinkhello.me/posts/00-threadlocal-%E9%AD%94%E6%B3%95/ - PinkHello, All Rights Reserved</description></item></channel></rss>